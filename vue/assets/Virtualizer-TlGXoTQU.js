import{d as N,r as E,k as f,l as V,m as z,q as S,c as T,i as C}from"./iframe-TIrJeSy6.js";import{c as L,a as w,U as M,b as P,d as j,g as H,s as U,e as k,f as F,L as B,i as D,A as p,h as q}from"./_plugin-vue_export-helper-DySHM6i0.js";function G(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!C(e)}const J={data:{type:Array,required:!0},bufferSize:Number,itemSize:Number,shift:Boolean,horizontal:Boolean,startMargin:{type:Number,default:0},ssrCount:Number,scrollRef:Object,as:{type:String,default:"div"},item:{type:String,default:"div"},itemProps:Function,keepMounted:Array},W=N({props:J,emits:["scroll","scrollEnd"],setup(e,{emit:m,expose:h,slots:I}){let _=!!e.ssrCount;const a=e.horizontal,g=E(),t=L(e.data.length,e.itemSize,e.ssrCount,void 0,!e.itemSize),d=k(t,a),i=w(t,a),l=E(t.$getStateVersion()),v=t.$subscribe(M,()=>{l.value=t.$getStateVersion()}),x=t.$subscribe(P,()=>{m("scroll",t.$getScrollOffset())}),A=t.$subscribe(j,()=>{m("scrollEnd")}),b=f(s=>{l.value;const r=t.$getRange(e.bufferSize);return s&&D(s,r)?s:r}),y=f(()=>l.value&&t.$isScrolling()),O=f(()=>l.value&&t.$getTotalSize());return V(()=>{_=!1;const s=requestAnimationFrame(()=>{const r=c=>{d.$observeRoot(c),i.$observe(c)};e.scrollRef?r(e.scrollRef):r(g.value.parentElement)});z(()=>{cancelAnimationFrame(s)})}),z(()=>{v(),x(),A(),d.$dispose(),i.$dispose()}),S(()=>e.data.length,s=>{t.$update(p,[s,e.shift])}),S(()=>e.startMargin,s=>{t.$update(q,s)},{immediate:!0}),S([l],()=>{i.$fixScrollJump()},{flush:"post"}),h({get scrollOffset(){return t.$getScrollOffset()},get scrollSize(){return H(t)},get viewportSize(){return t.$getViewportSize()},findStartIndex:t.$findStartIndex,findEndIndex:t.$findEndIndex,getItemOffset:t.$getItemOffset,getItemSize:t.$getItemSize,scrollToIndex:i.$scrollToIndex,scrollTo:i.$scrollTo,scrollBy:i.$scrollBy}),()=>{const s=e.as,r=e.item,c=O.value,u=[],$=n=>{const o=I.default({item:e.data[n],index:n})[0];return T(B,{key:F(o,n),_stateVersion:l,_store:t,_resizer:d.$observeItem,_index:n,_children:o,_isHorizontal:a,_isSSR:_,_as:r,_itemProps:e.itemProps?.({item:e.data[n],index:n})},null,8,["_stateVersion","_store","_resizer","_index","_children","_isHorizontal","_isSSR","_as","_itemProps"])};if(e.keepMounted){const n=new Set(e.keepMounted);for(let[o,R]=b.value;o<=R;o++)n.add(o);U([...n]).forEach(o=>{u.push($(o))})}else for(let[n,o]=b.value;n<=o;n++)u.push($(n));return T(s,{ref:g,style:{contain:"size paint style",overflowAnchor:"none",overflow:"clip",flex:"none",position:"relative",width:a?c+"px":"100%",height:a?"100%":c+"px",pointerEvents:y.value?"none":void 0}},G(u)?u:{default:()=>[u],_:2},8,["style"])}}});export{W as V};

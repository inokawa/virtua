import{d as x,r as E,a as f,o as O,b as v,w as m,c as T,i as V}from"./iframe-BZjKZk2W.js";import{c as C,a as L,U as j,b as w,d as M,g as P,s as H,e as U,f as F,L as k,i as B,A as D,h as G}from"./_plugin-vue_export-helper-Bke2mhw7.js";function q(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!V(e)}const K={data:{type:Array,required:!0},bufferSize:Number,itemSize:Number,shift:Boolean,horizontal:Boolean,startMargin:{type:Number,default:0},ssrCount:Number,scrollRef:Object,as:{type:String,default:"div"},item:{type:String,default:"div"},itemProps:Function,keepMounted:Array,cache:Object},Q=x({props:K,emits:["scroll","scrollEnd"],setup(e,{emit:S,expose:I,slots:N}){let g=!!e.ssrCount;const a=e.horizontal,_=E(),t=C(e.data.length,e.itemSize,e.ssrCount,e.cache,!e.itemSize),d=U(t,a),r=L(t,a),l=E(t.$getStateVersion());t.$subscribe(j,()=>{l.value=t.$getStateVersion()}),t.$subscribe(w,()=>{S("scroll",t.$getScrollOffset())}),t.$subscribe(M,()=>{S("scrollEnd")});const $=f(n=>{l.value;const i=t.$getRange(e.bufferSize);return n&&B(n,i)?n:i}),y=f(()=>l.value&&t.$isScrolling()),A=f(()=>l.value&&t.$getTotalSize());return O(()=>{g=!1;const n=requestAnimationFrame(()=>{const i=c=>{d.$observeRoot(c),r.$observe(c)};e.scrollRef?i(e.scrollRef):i(_.value.parentElement)});v(()=>{cancelAnimationFrame(n)})}),v(()=>{t.$dispose(),d.$dispose(),r.$dispose()}),m(()=>e.data.length,n=>{t.$update(D,[n,e.shift])}),m(()=>e.startMargin,n=>{t.$update(G,n)},{immediate:!0}),m([l],()=>{r.$fixScrollJump()},{flush:"post"}),I({get cache(){return t.$getCacheSnapshot()},get scrollOffset(){return t.$getScrollOffset()},get scrollSize(){return P(t)},get viewportSize(){return t.$getViewportSize()},findItemIndex:t.$findItemIndex,getItemOffset:t.$getItemOffset,getItemSize:t.$getItemSize,scrollToIndex:r.$scrollToIndex,scrollTo:r.$scrollTo,scrollBy:r.$scrollBy}),()=>{const n=e.as,i=e.item,c=A.value,h=r.$isNegative(),z=!a&&h?"unshift":"push",u=[],b=s=>{const o=N.default({item:e.data[s],index:s})[0];return T(k,{key:F(o,s),_stateVersion:l,_store:t,_resizer:d.$observeItem,_index:s,_children:o,_isHorizontal:a,_isNegative:h,_isSSR:g,_as:i,_itemProps:e.itemProps?.({item:e.data[s],index:s})},null,8,["_stateVersion","_store","_resizer","_index","_children","_isHorizontal","_isNegative","_isSSR","_as","_itemProps"])};if(e.keepMounted){const s=new Set(e.keepMounted);for(let[o,R]=$.value;o<=R;o++)s.add(o);H([...s]).forEach(o=>{u[z](b(o))})}else for(let[s,o]=$.value;s<=o;s++)u[z](b(s));return T(n,{ref:_,style:{contain:"size style",overflowAnchor:"none",flex:"none",position:"relative",width:a?c+"px":"100%",height:a?"100%":c+"px",pointerEvents:y.value?"none":void 0}},q(u)?u:{default:()=>[u],_:2},8,["style"])}}});export{Q as V};

import{d as y,r as E,k as f,l as R,m as b,q as m,c as T,i as N}from"./iframe-CF5_s6Yh.js";import{c as V,a as O,U as C,b as L,d as w,g as M,s as P,e as j,f as H,L as U,i as k,A as F,h as p}from"./_plugin-vue_export-helper-CY6RBcrJ.js";function B(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!N(e)}const D={data:{type:Array,required:!0},bufferSize:Number,itemSize:Number,shift:Boolean,horizontal:Boolean,startMargin:{type:Number,default:0},ssrCount:Number,scrollRef:Object,as:{type:String,default:"div"},item:{type:String,default:"div"},itemProps:Function,keepMounted:Array},J=y({props:D,emits:["scroll","scrollEnd"],setup(e,{emit:S,expose:h,slots:I}){let _=!!e.ssrCount;const l=e.horizontal,g=E(),t=V(e.data.length,e.itemSize,e.ssrCount,void 0,!e.itemSize),d=j(t,l),i=O(t,l),a=E(t.$getStateVersion());t.$subscribe(C,()=>{a.value=t.$getStateVersion()}),t.$subscribe(L,()=>{S("scroll",t.$getScrollOffset())}),t.$subscribe(w,()=>{S("scrollEnd")});const $=f(s=>{a.value;const r=t.$getRange(e.bufferSize);return s&&k(s,r)?s:r}),v=f(()=>a.value&&t.$isScrolling()),x=f(()=>a.value&&t.$getTotalSize());return R(()=>{_=!1;const s=requestAnimationFrame(()=>{const r=c=>{d.$observeRoot(c),i.$observe(c)};e.scrollRef?r(e.scrollRef):r(g.value.parentElement)});b(()=>{cancelAnimationFrame(s)})}),b(()=>{t.$dispose(),d.$dispose(),i.$dispose()}),m(()=>e.data.length,s=>{t.$update(F,[s,e.shift])}),m(()=>e.startMargin,s=>{t.$update(p,s)},{immediate:!0}),m([a],()=>{i.$fixScrollJump()},{flush:"post"}),h({get scrollOffset(){return t.$getScrollOffset()},get scrollSize(){return M(t)},get viewportSize(){return t.$getViewportSize()},findStartIndex:t.$findStartIndex,findEndIndex:t.$findEndIndex,getItemOffset:t.$getItemOffset,getItemSize:t.$getItemSize,scrollToIndex:i.$scrollToIndex,scrollTo:i.$scrollTo,scrollBy:i.$scrollBy}),()=>{const s=e.as,r=e.item,c=x.value,u=[],z=n=>{const o=I.default({item:e.data[n],index:n})[0];return T(U,{key:H(o,n),_stateVersion:a,_store:t,_resizer:d.$observeItem,_index:n,_children:o,_isHorizontal:l,_isSSR:_,_as:r,_itemProps:e.itemProps?.({item:e.data[n],index:n})},null,8,["_stateVersion","_store","_resizer","_index","_children","_isHorizontal","_isSSR","_as","_itemProps"])};if(e.keepMounted){const n=new Set(e.keepMounted);for(let[o,A]=$.value;o<=A;o++)n.add(o);P([...n]).forEach(o=>{u.push(z(o))})}else for(let[n,o]=$.value;n<=o;n++)u.push(z(n));return T(s,{ref:g,style:{contain:"size paint style",overflowAnchor:"none",overflow:"clip",flex:"none",position:"relative",width:l?c+"px":"100%",height:l?"100%":c+"px",pointerEvents:v.value?"none":void 0}},B(u)?u:{default:()=>[u],_:2},8,["style"])}}});export{J as V};

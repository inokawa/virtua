import{d as O,r as b,c as f,o as y,a as h,w as S,b as E,i as R}from"./iframe-BbMyJ5uH.js";import{c as V,a as N,U as C,b as w,d as L,g as j,s as M,e as P,f as H,L as U,i as F,A as k,h as B}from"./_plugin-vue_export-helper-CLQkaEnZ.js";function D(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Object]"&&!R(t)}const G={data:{type:Array,required:!0},bufferSize:Number,itemSize:Number,shift:Boolean,horizontal:Boolean,startMargin:{type:Number,default:0},ssrCount:Number,scrollRef:Object,as:{type:String,default:"div"},item:{type:String,default:"div"},itemProps:Function,keepMounted:Array,cache:Object},J=O({props:G,emits:["scroll","scrollEnd"],setup(t,{emit:m,expose:I,slots:T}){let g=!!t.ssrCount;const l=t.horizontal,_=b(),e=V(t.data.length,t.itemSize,t.ssrCount,t.cache,!t.itemSize),d=P(e,l),i=N(e,l),a=b(e.$getStateVersion());e.$subscribe(C,()=>{a.value=e.$getStateVersion()}),e.$subscribe(w,()=>{m("scroll",e.$getScrollOffset())}),e.$subscribe(L,()=>{m("scrollEnd")});const $=f(n=>{a.value;const r=e.$getRange(t.bufferSize);return n&&F(n,r)?n:r}),v=f(()=>a.value&&e.$isScrolling()),x=f(()=>a.value&&e.$getTotalSize());return y(()=>{g=!1;const n=requestAnimationFrame(()=>{const r=c=>{d.$observeRoot(c),i.$observe(c)};t.scrollRef?r(t.scrollRef):r(_.value.parentElement)});h(()=>{cancelAnimationFrame(n)})}),h(()=>{e.$dispose(),d.$dispose(),i.$dispose()}),S(()=>t.data.length,n=>{e.$update(k,[n,t.shift])}),S(()=>t.startMargin,n=>{e.$update(B,n)},{immediate:!0}),S([a],()=>{i.$fixScrollJump()},{flush:"post"}),I({get cache(){return e.$getCacheSnapshot()},get scrollOffset(){return e.$getScrollOffset()},get scrollSize(){return j(e)},get viewportSize(){return e.$getViewportSize()},findStartIndex:()=>e.$findItemIndex(e.$getScrollOffset()),findEndIndex:()=>e.$findItemIndex(e.$getScrollOffset()+e.$getViewportSize()),getItemOffset:e.$getItemOffset,getItemSize:e.$getItemSize,scrollToIndex:i.$scrollToIndex,scrollTo:i.$scrollTo,scrollBy:i.$scrollBy}),()=>{const n=t.as,r=t.item,c=x.value,u=[],z=s=>{const o=T.default({item:t.data[s],index:s})[0];return E(U,{key:H(o,s),_stateVersion:a,_store:e,_resizer:d.$observeItem,_index:s,_children:o,_isHorizontal:l,_isSSR:g,_as:r,_itemProps:t.itemProps?.({item:t.data[s],index:s})},null,8,["_stateVersion","_store","_resizer","_index","_children","_isHorizontal","_isSSR","_as","_itemProps"])};if(t.keepMounted){const s=new Set(t.keepMounted);for(let[o,A]=$.value;o<=A;o++)s.add(o);M([...s]).forEach(o=>{u.push(z(o))})}else for(let[s,o]=$.value;s<=o;s++)u.push(z(s));return E(n,{ref:_,style:{contain:"size style",overflowAnchor:"none",flex:"none",position:"relative",width:l?c+"px":"100%",height:l?"100%":c+"px",pointerEvents:v.value?"none":void 0}},D(u)?u:{default:()=>[u],_:2},8,["style"])}}});export{J as V};

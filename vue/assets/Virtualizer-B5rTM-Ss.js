import{d as y,r as E,c as f,o as R,a as b,w as S,b as h,i as N}from"./iframe-Cg7WIFu3.js";import{c as O,a as V,U as C,b as L,d as j,g as w,s as M,e as P,f as H,L as U,i as F,A as k,h as B}from"./_plugin-vue_export-helper-Bvg0gHcD.js";function D(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!N(e)}const G={data:{type:Array,required:!0},bufferSize:Number,itemSize:Number,shift:Boolean,horizontal:Boolean,startMargin:{type:Number,default:0},ssrCount:Number,scrollRef:Object,as:{type:String,default:"div"},item:{type:String,default:"div"},itemProps:Function,keepMounted:Array,cache:Object},J=y({props:G,emits:["scroll","scrollEnd"],setup(e,{emit:m,expose:T,slots:I}){let g=!!e.ssrCount;const l=e.horizontal,_=E(),t=O(e.data.length,e.itemSize,e.ssrCount,e.cache,!e.itemSize),d=P(t,l),a=V(t,l),i=E(t.$getStateVersion());t.$subscribe(C,()=>{i.value=t.$getStateVersion()}),t.$subscribe(L,()=>{m("scroll",t.$getScrollOffset())}),t.$subscribe(j,()=>{m("scrollEnd")});const $=f(s=>{i.value;const r=t.$getRange(e.bufferSize);return s&&F(s,r)?s:r}),v=f(()=>i.value&&t.$isScrolling()),x=f(()=>i.value&&t.$getTotalSize());return R(()=>{g=!1;const s=requestAnimationFrame(()=>{const r=c=>{d.$observeRoot(c),a.$observe(c)};e.scrollRef?r(e.scrollRef):r(_.value.parentElement)});b(()=>{cancelAnimationFrame(s)})}),b(()=>{t.$dispose(),d.$dispose(),a.$dispose()}),S(()=>e.data.length,s=>{t.$update(k,[s,e.shift])}),S(()=>e.startMargin,s=>{t.$update(B,s)},{immediate:!0}),S([i],()=>{a.$fixScrollJump()},{flush:"post"}),T({get cache(){return t.$getCacheSnapshot()},get scrollOffset(){return t.$getScrollOffset()},get scrollSize(){return w(t)},get viewportSize(){return t.$getViewportSize()},findStartIndex:t.$findStartIndex,findEndIndex:t.$findEndIndex,getItemOffset:t.$getItemOffset,getItemSize:t.$getItemSize,scrollToIndex:a.$scrollToIndex,scrollTo:a.$scrollTo,scrollBy:a.$scrollBy}),()=>{const s=e.as,r=e.item,c=x.value,u=[],z=n=>{const o=I.default({item:e.data[n],index:n})[0];return h(U,{key:H(o,n),_stateVersion:i,_store:t,_resizer:d.$observeItem,_index:n,_children:o,_isHorizontal:l,_isSSR:g,_as:r,_itemProps:e.itemProps?.({item:e.data[n],index:n})},null,8,["_stateVersion","_store","_resizer","_index","_children","_isHorizontal","_isSSR","_as","_itemProps"])};if(e.keepMounted){const n=new Set(e.keepMounted);for(let[o,A]=$.value;o<=A;o++)n.add(o);M([...n]).forEach(o=>{u.push(z(o))})}else for(let[n,o]=$.value;n<=o;n++)u.push(z(n));return h(s,{ref:_,style:{contain:"size style",overflowAnchor:"none",flex:"none",position:"relative",width:l?c+"px":"100%",height:l?"100%":c+"px",pointerEvents:v.value?"none":void 0}},D(u)?u:{default:()=>[u],_:2},8,["style"])}}});export{J as V};

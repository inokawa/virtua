import{j as V}from"./jsx-runtime-D_zvdyIk.js";import{r as l}from"./iframe-DyuHUQ_l.js";const A=typeof window<"u"?l.useLayoutEffect:l.useEffect;function P(e){if(e!==void 0)switch(typeof e){case"number":return e;case"string":{if(e.endsWith("px"))return parseFloat(e);break}}}function N({box:e,defaultHeight:t,defaultWidth:i,disabled:n,element:r,mode:s,style:c}){const{styleHeight:o,styleWidth:a}=l.useMemo(()=>({styleHeight:P(c?.height),styleWidth:P(c?.width)}),[c?.height,c?.width]),[u,d]=l.useState({height:t,width:i}),p=n||o!==void 0||s==="only-width"||o!==void 0&&a!==void 0;return A(()=>{if(r===null||p)return;const R=new ResizeObserver(k=>{for(const E of k){const{contentRect:b,target:m}=E;r===m&&d(v=>v.height===b.height&&v.width===b.width?v:{height:b.height,width:b.width})}});return R.observe(r,{box:e}),()=>{R?.unobserve(r)}},[e,p,r,o,a]),l.useMemo(()=>({height:o??u.height,width:a??u.width}),[u,o,a])}function U(e){const t=l.useRef(()=>{throw new Error("Cannot call an event handler while rendering.")});return A(()=>{t.current=e},[e]),l.useCallback(i=>t.current?.(i),[t])}function L({containerElement:e,direction:t,isRtl:i,scrollOffset:n}){return n}function C(e,t="Assertion error"){if(!e)throw console.error(t),Error(t)}function T(e,t){if(e===t)return!0;if(!!e!=!!t||(C(e!==void 0),C(t!==void 0),Object.keys(e).length!==Object.keys(t).length))return!1;for(const i in e)if(!Object.is(t[i],e[i]))return!1;return!0}function q({cachedBounds:e,itemCount:t,itemSize:i}){if(t===0)return 0;if(typeof i=="number")return t*i;{const n=e.get(e.size===0?0:e.size-1);C(n!==void 0,"Unexpected bounds cache miss");const r=(n.scrollOffset+n.size)/e.size;return t*r}}function Y({align:e,cachedBounds:t,index:i,itemCount:n,itemSize:r,containerScrollOffset:s,containerSize:c}){const o=q({cachedBounds:t,itemCount:n,itemSize:r}),a=t.get(i),u=Math.max(0,Math.min(o-c,a.scrollOffset)),d=Math.max(0,a.scrollOffset-c+a.size);switch(e==="smart"&&(s>=d&&s<=u?e="auto":e="center"),e){case"start":return u;case"end":return d;case"center":return a.scrollOffset<=c/2?0:a.scrollOffset+a.size/2>=o-c/2?o-c:a.scrollOffset+a.size/2-c/2;case"auto":default:return s>=d&&s<=u?s:s<d?d:u}}function $({cachedBounds:e,containerScrollOffset:t,containerSize:i,itemCount:n,overscanCount:r}){const s=n-1;let c=0,o=-1,a=0,u=-1,d=0;for(;d<s;){const p=e.get(d);if(p.scrollOffset+p.size>t)break;d++}for(c=d,a=Math.max(0,c-r);d<s;){const p=e.get(d);if(p.scrollOffset+p.size>=t+i)break;d++}return o=Math.min(s,d),u=Math.min(n-1,o+r),c<0&&(c=0,o=-1,a=0,u=-1),{startIndexVisible:c,stopIndexVisible:o,startIndexOverscan:a,stopIndexOverscan:u}}function _({itemCount:e,itemProps:t,itemSize:i}){const n=new Map;return{get(r){for(C(r<e,`Invalid index ${r}`);n.size-1<r;){const c=n.size;let o;switch(typeof i){case"function":{o=i(c,t);break}case"number":{o=i;break}}if(c===0)n.set(c,{size:o,scrollOffset:0});else{const a=n.get(c-1);C(a!==void 0,`Unexpected bounds cache miss for index ${r}`),n.set(c,{scrollOffset:a.scrollOffset+a.size,size:o})}}const s=n.get(r);return C(s!==void 0,`Unexpected bounds cache miss for index ${r}`),s},set(r,s){n.set(r,s)},get size(){return n.size}}}function F({itemCount:e,itemProps:t,itemSize:i}){return l.useMemo(()=>_({itemCount:e,itemProps:t,itemSize:i}),[e,t,i])}function G({containerSize:e,itemSize:t}){let i;switch(typeof t){case"string":{C(t.endsWith("%"),`Invalid item size: "${t}"; string values must be percentages (e.g. "100%")`),C(e!==void 0,"Container size must be defined if a percentage item size is specified"),i=e*parseInt(t)/100;break}default:{i=t;break}}return i}function Z({containerElement:e,containerStyle:t,defaultContainerSize:i=0,direction:n,isRtl:r=!1,itemCount:s,itemProps:c,itemSize:o,onResize:a,overscanCount:u}){const[d,p]=l.useState({startIndexVisible:0,startIndexOverscan:0,stopIndexVisible:-1,stopIndexOverscan:-1}),{startIndexVisible:R,startIndexOverscan:k,stopIndexVisible:E,stopIndexOverscan:b}={startIndexVisible:Math.min(s-1,d.startIndexVisible),startIndexOverscan:Math.min(s-1,d.startIndexOverscan),stopIndexVisible:Math.min(s-1,d.stopIndexVisible),stopIndexOverscan:Math.min(s-1,d.stopIndexOverscan)},{height:m=i,width:v=i}=N({defaultHeight:i,defaultWidth:void 0,element:e,mode:"only-height",style:t}),I=l.useRef({height:0,width:0}),y=m,M=G({containerSize:y,itemSize:o});l.useLayoutEffect(()=>{if(typeof a=="function"){const f=I.current;(f.height!==m||f.width!==v)&&(a({height:m,width:v},{...f}),f.height=m,f.width=v)}},[m,a,v]);const x=F({itemCount:s,itemProps:c,itemSize:M}),j=l.useCallback(f=>x.get(f),[x]),w=l.useCallback(()=>q({cachedBounds:x,itemCount:s,itemSize:M}),[x,s,M]),H=l.useCallback(f=>{const S=L({containerElement:e,direction:n,isRtl:r,scrollOffset:f});return $({cachedBounds:x,containerScrollOffset:S,containerSize:y,itemCount:s,overscanCount:u})},[x,e,y,n,r,s,u]);A(()=>{const f=e?.scrollTop??0;p(H(f))},[e,n,H]),A(()=>{if(!e)return;const f=()=>{p(S=>{const{scrollLeft:B,scrollTop:g}=e,h=L({containerElement:e,direction:n,isRtl:r,scrollOffset:g}),z=$({cachedBounds:x,containerScrollOffset:h,containerSize:y,itemCount:s,overscanCount:u});return T(z,S)?S:z})};return e.addEventListener("scroll",f),()=>{e.removeEventListener("scroll",f)}},[x,e,y,n,s,u]);const O=U(({align:f="auto",containerScrollOffset:S,index:B})=>{let g=Y({align:f,cachedBounds:x,containerScrollOffset:S,containerSize:y,index:B,itemCount:s,itemSize:M});if(e){if(g=L({containerElement:e,direction:n,isRtl:r,scrollOffset:g}),typeof e.scrollTo!="function"){const h=H(g);T(d,h)||p(h)}return g}});return{getCellBounds:j,getEstimatedSize:w,scrollToIndex:O,startIndexOverscan:k,startIndexVisible:R,stopIndexOverscan:b,stopIndexVisible:E}}function D(e){return l.useMemo(()=>e,Object.values(e))}function J(e,t){const{ariaAttributes:i,style:n,...r}=e,{ariaAttributes:s,style:c,...o}=t;return T(i,s)&&T(n,c)&&T(r,o)}function K(e){return e!=null&&typeof e=="object"&&"getAverageRowHeight"in e&&typeof e.getAverageRowHeight=="function"}const Q="data-react-window-index";function X({children:e,className:t,defaultHeight:i=0,listRef:n,onResize:r,onRowsRendered:s,overscanCount:c=3,rowComponent:o,rowCount:a,rowHeight:u,rowProps:d,tagName:p="div",style:R,...k}){const E=D(d),b=l.useMemo(()=>l.memo(o,J),[o]),[m,v]=l.useState(null),I=K(u),y=l.useMemo(()=>I?g=>u.getRowHeight(g)??u.getAverageRowHeight():u,[I,u]),{getCellBounds:M,getEstimatedSize:x,scrollToIndex:j,startIndexOverscan:w,startIndexVisible:H,stopIndexOverscan:O,stopIndexVisible:f}=Z({containerElement:m,containerStyle:R,defaultContainerSize:i,direction:"vertical",itemCount:a,itemProps:E,itemSize:y,onResize:r,overscanCount:c});l.useImperativeHandle(n,()=>({get element(){return m},scrollToRow({align:g="auto",behavior:h="auto",index:z}){const W=j({align:g,containerScrollOffset:m?.scrollTop??0,index:z});typeof m?.scrollTo=="function"&&m.scrollTo({behavior:h,top:W})}}),[m,j]),A(()=>{if(!m)return;const g=Array.from(m.children).filter((h,z)=>{if(h.hasAttribute("aria-hidden"))return!1;const W=`${w+z}`;return h.setAttribute(Q,W),!0});if(I)return u.observeRowElements(g)},[m,I,u,w,O]),l.useEffect(()=>{w>=0&&O>=0&&s&&s({startIndex:H,stopIndex:f},{startIndex:w,stopIndex:O})},[s,w,H,O,f]);const S=l.useMemo(()=>{const g=[];if(a>0)for(let h=w;h<=O;h++){const z=M(h);g.push(l.createElement(b,{...E,ariaAttributes:{"aria-posinset":h+1,"aria-setsize":a,role:"listitem"},key:h,index:h,style:{position:"absolute",left:0,transform:`translateY(${z.scrollOffset}px)`,height:I?void 0:z.size,width:"100%"}}))}return g},[b,M,I,a,E,w,O]),B=V.jsx("div",{"aria-hidden":!0,style:{height:x(),width:"100%",zIndex:-1}});return l.createElement(p,{role:"list",...k,className:t,ref:v,style:{position:"relative",maxHeight:"100%",flexGrow:1,overflowY:"auto",...R}},S,e,B)}const ee=({index:e,setHeight:t,Component:i})=>{const n=l.useRef(null);return l.useEffect(()=>{n.current&&t(e,n.current.getBoundingClientRect().height)},[]),V.jsx(i,{ref:n,index:e})},te=({index:e,style:t,Component:i,setHeight:n})=>V.jsx("div",{style:t,children:V.jsx(ee,{index:e,setHeight:n,Component:i})},e),ne=l.memo(({count:e,Component:t,handle:i})=>{const[n,r]=l.useState(()=>Array.from({length:e}).map(()=>50)),s=l.useRef(null),c=o=>n[o];return l.useImperativeHandle(i,()=>({scrollToIndex:o=>{s.current?.scrollToRow({index:o,align:"start"})}})),V.jsx(X,{listRef:s,rowCount:e,rowHeight:c,rowComponent:te,rowProps:l.useMemo(()=>({Component:t,setHeight:(o,a)=>{r(u=>{const d=[...u];return d[o]=a,d})}}),[t])})});ne.__docgenInfo={description:"",methods:[{name:"scrollToIndex",docblock:null,modifiers:[],params:[{name:"i",optional:!1,type:null}],returns:null}],displayName:"ReactWindowList",props:{count:{required:!0,tsType:{name:"number"},description:""},Component:{required:!0,tsType:{name:"SimpleItem"},description:""},handle:{required:!1,tsType:{name:"Ref",elements:[{name:"signature",type:"object",raw:"{ scrollToIndex: (index: number) => void }",signature:{properties:[{key:"scrollToIndex",value:{name:"signature",type:"function",raw:"(index: number) => void",signature:{arguments:[{type:{name:"number"},name:"index"}],return:{name:"void"}},required:!0}}]}}],raw:"Ref<ListHandle>"},description:""}}};export{ne as R};

import{j as V}from"./jsx-runtime-BjG_zV1W.js";import{r as l}from"./iframe-BX9CWLzQ.js";const A=typeof window<"u"?l.useLayoutEffect:l.useEffect;function P(e){if(e!==void 0)switch(typeof e){case"number":return e;case"string":{if(e.endsWith("px"))return parseFloat(e);break}}}function N({box:e,defaultHeight:t,defaultWidth:i,disabled:n,element:a,mode:s,style:r}){const{styleHeight:c,styleWidth:o}=l.useMemo(()=>({styleHeight:P(r==null?void 0:r.height),styleWidth:P(r==null?void 0:r.width)}),[r==null?void 0:r.height,r==null?void 0:r.width]),[u,d]=l.useState({height:t,width:i}),p=n||c!==void 0||s==="only-width"||c!==void 0&&o!==void 0;return A(()=>{if(a===null||p)return;const b=new ResizeObserver(k=>{for(const E of k){const{contentRect:w,target:f}=E;a===f&&d(v=>v.height===w.height&&v.width===w.width?v:{height:w.height,width:w.width})}});return b.observe(a,{box:e}),()=>{b==null||b.unobserve(a)}},[e,p,a,c,o]),l.useMemo(()=>({height:c??u.height,width:o??u.width}),[u,c,o])}function U(e){const t=l.useRef(()=>{throw new Error("Cannot call an event handler while rendering.")});return A(()=>{t.current=e},[e]),l.useCallback(i=>{var n;return(n=t.current)==null?void 0:n.call(t,i)},[t])}function L({containerElement:e,direction:t,isRtl:i,scrollOffset:n}){return n}function R(e,t="Assertion error"){if(!e)throw console.error(t),Error(t)}function T(e,t){if(e===t)return!0;if(!!e!=!!t||(R(e!==void 0),R(t!==void 0),Object.keys(e).length!==Object.keys(t).length))return!1;for(const i in e)if(!Object.is(t[i],e[i]))return!1;return!0}function q({cachedBounds:e,itemCount:t,itemSize:i}){if(t===0)return 0;if(typeof i=="number")return t*i;{const n=e.get(e.size===0?0:e.size-1);R(n!==void 0,"Unexpected bounds cache miss");const a=(n.scrollOffset+n.size)/e.size;return t*a}}function Y({align:e,cachedBounds:t,index:i,itemCount:n,itemSize:a,containerScrollOffset:s,containerSize:r}){const c=q({cachedBounds:t,itemCount:n,itemSize:a}),o=t.get(i),u=Math.max(0,Math.min(c-r,o.scrollOffset)),d=Math.max(0,o.scrollOffset-r+o.size);switch(e==="smart"&&(s>=d&&s<=u?e="auto":e="center"),e){case"start":return u;case"end":return d;case"center":return o.scrollOffset<=r/2?0:o.scrollOffset+o.size/2>=c-r/2?c-r:o.scrollOffset+o.size/2-r/2;case"auto":default:return s>=d&&s<=u?s:s<d?d:u}}function $({cachedBounds:e,containerScrollOffset:t,containerSize:i,itemCount:n,overscanCount:a}){const s=n-1;let r=0,c=-1,o=0,u=-1,d=0;for(;d<s;){const p=e.get(d);if(p.scrollOffset+p.size>t)break;d++}for(r=d,o=Math.max(0,r-a);d<s;){const p=e.get(d);if(p.scrollOffset+p.size>=t+i)break;d++}return c=Math.min(s,d),u=Math.min(n-1,c+a),r<0&&(r=0,c=-1,o=0,u=-1),{startIndexVisible:r,stopIndexVisible:c,startIndexOverscan:o,stopIndexOverscan:u}}function _({itemCount:e,itemProps:t,itemSize:i}){const n=new Map;return{get(a){for(R(a<e,`Invalid index ${a}`);n.size-1<a;){const r=n.size;let c;switch(typeof i){case"function":{c=i(r,t);break}case"number":{c=i;break}}if(r===0)n.set(r,{size:c,scrollOffset:0});else{const o=n.get(r-1);R(o!==void 0,`Unexpected bounds cache miss for index ${a}`),n.set(r,{scrollOffset:o.scrollOffset+o.size,size:c})}}const s=n.get(a);return R(s!==void 0,`Unexpected bounds cache miss for index ${a}`),s},set(a,s){n.set(a,s)},get size(){return n.size}}}function F({itemCount:e,itemProps:t,itemSize:i}){return l.useMemo(()=>_({itemCount:e,itemProps:t,itemSize:i}),[e,t,i])}function G({containerSize:e,itemSize:t}){let i;switch(typeof t){case"string":{R(t.endsWith("%"),`Invalid item size: "${t}"; string values must be percentages (e.g. "100%")`),R(e!==void 0,"Container size must be defined if a percentage item size is specified"),i=e*parseInt(t)/100;break}default:{i=t;break}}return i}function Z({containerElement:e,containerStyle:t,defaultContainerSize:i=0,direction:n,isRtl:a=!1,itemCount:s,itemProps:r,itemSize:c,onResize:o,overscanCount:u}){const[d,p]=l.useState({startIndexVisible:0,startIndexOverscan:0,stopIndexVisible:-1,stopIndexOverscan:-1}),{startIndexVisible:b,startIndexOverscan:k,stopIndexVisible:E,stopIndexOverscan:w}={startIndexVisible:Math.min(s-1,d.startIndexVisible),startIndexOverscan:Math.min(s-1,d.startIndexOverscan),stopIndexVisible:Math.min(s-1,d.stopIndexVisible),stopIndexOverscan:Math.min(s-1,d.stopIndexOverscan)},{height:f=i,width:v=i}=N({defaultHeight:i,defaultWidth:void 0,element:e,mode:"only-height",style:t}),y=l.useRef({height:0,width:0}),O=f,M=G({containerSize:O,itemSize:c});l.useLayoutEffect(()=>{if(typeof o=="function"){const m=y.current;(m.height!==f||m.width!==v)&&(o({height:f,width:v},{...m}),m.height=f,m.width=v)}},[f,o,v]);const x=F({itemCount:s,itemProps:r,itemSize:M}),j=l.useCallback(m=>x.get(m),[x]),z=l.useCallback(()=>q({cachedBounds:x,itemCount:s,itemSize:M}),[x,s,M]),H=l.useCallback(m=>{const C=L({containerElement:e,direction:n,isRtl:a,scrollOffset:m});return $({cachedBounds:x,containerScrollOffset:C,containerSize:O,itemCount:s,overscanCount:u})},[x,e,O,n,a,s,u]);A(()=>{const m=(e==null?void 0:e.scrollTop)??0;p(H(m))},[e,n,H]),A(()=>{if(!e)return;const m=()=>{p(C=>{const{scrollLeft:B,scrollTop:g}=e,h=L({containerElement:e,direction:n,isRtl:a,scrollOffset:g}),I=$({cachedBounds:x,containerScrollOffset:h,containerSize:O,itemCount:s,overscanCount:u});return T(I,C)?C:I})};return e.addEventListener("scroll",m),()=>{e.removeEventListener("scroll",m)}},[x,e,O,n,s,u]);const S=U(({align:m="auto",containerScrollOffset:C,index:B})=>{let g=Y({align:m,cachedBounds:x,containerScrollOffset:C,containerSize:O,index:B,itemCount:s,itemSize:M});if(e){if(g=L({containerElement:e,direction:n,isRtl:a,scrollOffset:g}),typeof e.scrollTo!="function"){const h=H(g);T(d,h)||p(h)}return g}});return{getCellBounds:j,getEstimatedSize:z,scrollToIndex:S,startIndexOverscan:k,startIndexVisible:b,stopIndexOverscan:w,stopIndexVisible:E}}function D(e){return l.useMemo(()=>e,Object.values(e))}function J(e,t){const{ariaAttributes:i,style:n,...a}=e,{ariaAttributes:s,style:r,...c}=t;return T(i,s)&&T(n,r)&&T(a,c)}function K(e){return e!=null&&typeof e=="object"&&"getAverageRowHeight"in e&&typeof e.getAverageRowHeight=="function"}const Q="data-react-window-index";function X({children:e,className:t,defaultHeight:i=0,listRef:n,onResize:a,onRowsRendered:s,overscanCount:r=3,rowComponent:c,rowCount:o,rowHeight:u,rowProps:d,tagName:p="div",style:b,...k}){const E=D(d),w=l.useMemo(()=>l.memo(c,J),[c]),[f,v]=l.useState(null),y=K(u),O=l.useMemo(()=>y?g=>u.getRowHeight(g)??u.getAverageRowHeight():u,[y,u]),{getCellBounds:M,getEstimatedSize:x,scrollToIndex:j,startIndexOverscan:z,startIndexVisible:H,stopIndexOverscan:S,stopIndexVisible:m}=Z({containerElement:f,containerStyle:b,defaultContainerSize:i,direction:"vertical",itemCount:o,itemProps:E,itemSize:O,onResize:a,overscanCount:r});l.useImperativeHandle(n,()=>({get element(){return f},scrollToRow({align:g="auto",behavior:h="auto",index:I}){const W=j({align:g,containerScrollOffset:(f==null?void 0:f.scrollTop)??0,index:I});typeof(f==null?void 0:f.scrollTo)=="function"&&f.scrollTo({behavior:h,top:W})}}),[f,j]),A(()=>{if(!f)return;const g=Array.from(f.children).filter((h,I)=>{if(h.hasAttribute("aria-hidden"))return!1;const W=`${z+I}`;return h.setAttribute(Q,W),!0});if(y)return u.observeRowElements(g)},[f,y,u,z,S]),l.useEffect(()=>{z>=0&&S>=0&&s&&s({startIndex:H,stopIndex:m},{startIndex:z,stopIndex:S})},[s,z,H,S,m]);const C=l.useMemo(()=>{const g=[];if(o>0)for(let h=z;h<=S;h++){const I=M(h);g.push(l.createElement(w,{...E,ariaAttributes:{"aria-posinset":h+1,"aria-setsize":o,role:"listitem"},key:h,index:h,style:{position:"absolute",left:0,transform:`translateY(${I.scrollOffset}px)`,height:y?void 0:I.size,width:"100%"}}))}return g},[w,M,y,o,E,z,S]),B=V.jsx("div",{"aria-hidden":!0,style:{height:x(),width:"100%",zIndex:-1}});return l.createElement(p,{role:"list",...k,className:t,ref:v,style:{position:"relative",maxHeight:"100%",flexGrow:1,overflowY:"auto",...b}},C,e,B)}const ee=({index:e,setHeight:t,Component:i})=>{const n=l.useRef(null);return l.useEffect(()=>{n.current&&t(e,n.current.getBoundingClientRect().height)},[]),V.jsx(i,{ref:n,index:e})},te=({index:e,style:t,Component:i,setHeight:n})=>V.jsx("div",{style:t,children:V.jsx(ee,{index:e,setHeight:n,Component:i})},e),ne=l.memo(({count:e,Component:t,handle:i})=>{const[n,a]=l.useState(()=>Array.from({length:e}).map(()=>50)),s=l.useRef(null),r=c=>n[c];return l.useImperativeHandle(i,()=>({scrollToIndex:c=>{var o;(o=s.current)==null||o.scrollToRow({index:c,align:"start"})}})),V.jsx(X,{listRef:s,rowCount:e,rowHeight:r,rowComponent:te,rowProps:l.useMemo(()=>({Component:t,setHeight:(c,o)=>{a(u=>{const d=[...u];return d[c]=o,d})}}),[t])})});ne.__docgenInfo={description:"",methods:[{name:"scrollToIndex",docblock:null,modifiers:[],params:[{name:"i",optional:!1,type:null}],returns:null}],displayName:"ReactWindowList",props:{count:{required:!0,tsType:{name:"number"},description:""},Component:{required:!0,tsType:{name:"SimpleItem"},description:""},handle:{required:!1,tsType:{name:"Ref",elements:[{name:"signature",type:"object",raw:"{ scrollToIndex: (index: number) => void }",signature:{properties:[{key:"scrollToIndex",value:{name:"signature",type:"function",raw:"(index: number) => void",signature:{arguments:[{type:{name:"number"},name:"index"}],return:{name:"void"}},required:!0}}]}}],raw:"Ref<ListHandle>"},description:""}}};export{ne as R};

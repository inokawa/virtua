import{j as P}from"./jsx-runtime-DR9Q75dM.js";import{r as k}from"./index-DRjF_FHU.js";import{r as ge}from"./index-uWwxbAOW.js";const F=null,{min:q,max:z,abs:oe,floor:xe}=Math,le=(e,t,r)=>q(r,z(t,e)),ce=e=>[...e].sort((t,r)=>t-r),ue=typeof queueMicrotask=="function"?queueMicrotask:e=>{Promise.resolve().then(e)},te=e=>{let t,r;return()=>(t||(t=!0,r=e()),r)},D=-1,K=(e,t,r)=>{const o=r?"unshift":"push";for(let s=0;s<t;s++)e[o](D);return e},U=(e,t)=>{const r=e.t[t];return r===D?e.o:r},we=(e,t,r)=>{const o=e.t[t]===D;return e.t[t]=r,e.i=q(t,e.i),o},$=(e,t)=>{if(!e.l)return 0;if(e.i>=t)return e.u[t];e.i<0&&(e.u[0]=0,e.i=0);let r=e.i,o=e.u[r];for(;r<t;)o+=U(e,r),e.u[++r]=o;return e.i=t,o},B=(e,t,r=0,o=e.l-1)=>{for(;r<=o;){const s=xe((r+o)/2),l=$(e,s);if(l<=t){if(l+U(e,s)>t)return s;r=s+1}else o=s-1}return le(r,0,e.l-1)},se=(e,t,r)=>{const o=t-e.l;return e.i=r?-1:q(t-1,e.i),e.l=t,o>0?(K(e.u,o),K(e.t,o,r),e.o*o):(e.u.splice(o),(r?e.t.splice(0,-o):e.t.splice(o)).reduce((s,l)=>s-(l===D?e.o:l),0))},ae=typeof window<"u",de=()=>document.documentElement,be=e=>e.ownerDocument,Ee=e=>e.defaultView,fe=te(()=>!!ae&&getComputedStyle(de()).direction==="rtl"),he=te(()=>/iP(hone|od|ad)/.test(navigator.userAgent)),Le=te(()=>"scrollBehavior"in de().style),Re=e=>z(e.h(),e.p()),ke=e=>!!e.p(),Te=(e,t=40,r=4,o=0,s,l=!1)=>{let u=!!o,y=[],n=0,d=0,v=0,g=0,m=0,x=0,I=0,T=0,S=0,f=u?[0,z(o-1,0)]:F,R=[0,0],H=0;const L=((i,p,b)=>({o:b?b[1]:p,t:b&&b[0]?K(b[0].slice(0,q(i,b[0].length)),z(0,i-b[0].length)):K([],i),l:i,i:-1,u:K([],i)}))(e,t,s),W=new Set,h=()=>v-d,_=()=>h()+x+m,A=i=>((p,b,C,E)=>{if(E=q(E,p.l-1),$(p,E)<=b){const c=B(p,b+C,E);return[B(p,b,E,c),c]}{const c=B(p,b,void 0,E);return[c,B(p,b+C,c)]}})(L,i,n,R[0]),V=()=>(i=>i.l?$(i,i.l-1)+U(i,i.l-1):0)(L),J=i=>$(L,i)-x,Y=i=>U(L,i),X=i=>{i&&(he()&&T!==0?x+=i:(m+=i,g++))};return{v:()=>y,_:()=>(i=>[i.t.slice(),i.o])(L),m:()=>{if(I)return R;let[i,p]=A(z(0,_()));return f&&(i=q(i,f[0]),p=z(p,f[1])),T!==1&&(i-=z(0,r)),T!==2&&(p+=z(0,r)),R=[z(i,0),q(p,L.l-1)]},$:()=>B(L,_()),S:()=>B(L,_()+n),I:i=>L.t[i]===D,k:()=>!!f&&L.t.slice(z(0,f[0]-1),q(L.l-1,f[1]+1)+1).includes(D),T:J,R:Y,M:()=>L.l,C:()=>v,H:()=>T!==0,p:()=>n,W:()=>d,h:V,J:()=>g,B:()=>(I=m,m=0,[I,S===2||h()+n>=V()]),O:(i,p)=>{const b=[i,p];return W.add(b),()=>{W.delete(b)}},L:(i,p)=>{let b,C,E=0;switch(i){case 1:{const c=I;I=0;const a=p-v,w=oe(a);c&&w<oe(c)+1||S!==0||(T=a<0?2:1),u&&(f=F,u=!1),v=p,E=4;const M=h();M>=-n&&M<=V()&&(E+=1,C=w>n);break}case 2:E=8,T!==0&&(b=!0,E+=1),T=0,S=0,f=F;break;case 3:{const c=p.filter(([a,w])=>L.t[a]!==w);if(!c.length)break;X(c.reduce((a,[w,M])=>((S===2||(f?!u&&w<f[0]:J(w)+(T===0&&S===0?Y(w):0)<h()))&&(a+=M-Y(w)),a),0));for(const[a,w]of c){const M=Y(a),O=we(L,a,w);l&&(H+=O?w:w-M)}l&&n&&H>n&&(X(((a,w)=>{let M=0;const O=[];a.t.forEach((ne,ye)=>{ne!==D&&(O.push(ne),ye<w&&M++)}),a.i=-1;const N=ce(O),re=N.length,Q=re/2|0,me=re%2==0?(N[Q-1]+N[Q])/2:N[Q],ve=a.o;return((a.o=me)-ve)*z(w-M,0)})(L,B(L,_()))),l=!1),E=3,C=!0;break}case 4:n!==p&&(n=p,E=3);break;case 5:p[1]?(X(se(L,p[0],!0)),S=2,E=1):(se(L,p[0]),E=1);break;case 6:d=p;break;case 7:S=1;break;case 8:f=A(p),E=1}E&&(y=[],b&&x&&(m+=x,x=0,g++),W.forEach(([c,a])=>{E&c&&a(C)}))}}},ee=setTimeout,G=(e,t)=>t&&fe()?-e:e,Se=(e,t,r,o,s,l)=>{const u=Date.now;let y=0,n=!1,d=!1,v=!1,g=!1;const m=(()=>{let f;const R=()=>{f!=F&&clearTimeout(f)},H=()=>{R(),f=ee(()=>{f=F,(()=>{if(n||d)return n=!1,void m();v=!1,e.L(2)})()},150)};return H.P=R,H})(),x=()=>{y=u(),v&&(g=!0),e.L(1,o()),m()},I=f=>{if(n||!e.H()||f.ctrlKey)return;const R=u()-y;150>R&&50<R&&(r?f.deltaX:f.deltaY)&&(n=!0)},T=()=>{d=!0,v=g=!1},S=()=>{d=!1,he()&&(v=!0)};return t.addEventListener("scroll",x),t.addEventListener("wheel",I,{passive:!0}),t.addEventListener("touchstart",T,{passive:!0}),t.addEventListener("touchend",S,{passive:!0}),{A:()=>{t.removeEventListener("scroll",x),t.removeEventListener("wheel",I),t.removeEventListener("touchstart",T),t.removeEventListener("touchend",S),m.P()},V:()=>{const[f,R]=e.B();f&&(s(G(f,r),R,g),g=!1,R&&e.p()>e.h()&&e.L(1,o()))}}},Ie=(e,t)=>{let r,o,s;const l=t?"scrollLeft":"scrollTop",u=t?"overflowX":"overflowY",y=async(n,d)=>{if(!r)return void ue(()=>y(n,d));s&&s();const v=()=>{let g;return[new Promise((m,x)=>{g=m,s=x,ke(e)&&ee(x,150)}),e.O(2,()=>{g&&g()})]};if(d&&Le()){for(;e.L(8,n()),e.k();){const[g,m]=v();try{await g}catch{return}finally{m()}}r.scrollTo({[t?"left":"top"]:G(n(),t),behavior:"smooth"})}else for(;;){const[g,m]=v();try{r[l]=G(n(),t),e.L(7),await g}catch{return}finally{m()}}};return{X(n){r=n,o=Se(e,n,t,()=>G(n[l],t),(d,v,g)=>{if(g){const m=n.style,x=m[u];m[u]="hidden",ee(()=>{m[u]=x})}v?(n[l]=e.C()+d,s&&s()):n[l]+=d})},Y(){o&&o.A()},j(n){y(()=>n)},q(n){n+=e.C(),y(()=>n)},D(n,{align:d,smooth:v,offset:g=0}={}){if(n=le(n,0,e.M()-1),d==="nearest"){const m=e.T(n),x=e.C();if(m<x)d="start";else{if(!(m+e.R(n)>x+e.p()))return;d="end"}}y(()=>g+e.W()+e.T(n)+(d==="end"?e.R(n)-e.p():d==="center"?(e.R(n)-e.p())/2:0),v)},U:()=>{o&&o.V()}}},Me=e=>{let t;return{F(r){(t||(t=new(Ee(be(r))).ResizeObserver(e))).observe(r)},G(r){t.unobserve(r)},A(){t&&t.disconnect()}}},je=(e,t)=>{let r;const o=t?"width":"height",s=new WeakMap,l=Me(u=>{const y=[];for(const{target:n,contentRect:d}of u)if(n.offsetParent)if(n===r)e.L(4,d[o]);else{const v=s.get(n);v!=F&&y.push([v,d[o]])}y.length&&e.L(3,y)});return{K(u){l.F(r=u)},N:(u,y)=>(s.set(u,y),l.F(u),()=>{s.delete(u),l.G(u)}),Y:l.A}},Z=ae?k.useLayoutEffect:k.useEffect,j="current",pe=(e,t)=>{if(Array.isArray(e))for(const r of e)pe(r,t);else e==null||typeof e=="boolean"||t.push(e)},Ce=(e,t)=>{const r=e.key;return r??"_"+t},ze=e=>{const t=k.useRef();return t[j]||(t[j]=e())},ie=e=>{const t=k.useRef(e);return Z(()=>{t[j]=e},[e]),t},Ae=k.memo(({Z:e,ee:t,te:r,ne:o,oe:s,re:l,ie:u,se:y})=>{const n=k.useRef(null);Z(()=>t(n[j],r),[r]);const d=k.useMemo(()=>{const v={position:s&&y?void 0:"absolute",[u?"height":"width"]:"100%",[u?"top":"left"]:0,[u?fe()?"right":"left":"top"]:o,visibility:!s||y?"visible":"hidden"};return u&&(v.display="flex"),v},[o,s,y,u]);return P.jsx(l,typeof l=="string"?{ref:n,style:d,children:e}:{ref:n,style:d,index:r,children:e})}),Oe=e=>k.useReducer(e.v,void 0,e.v)[1],He=(e,t)=>k.useMemo(()=>{if(typeof e=="function")return[e,t||0];const r=(o=>{const s=[];return pe(o,s),s})(e);return[o=>r[o],r.length]},[e,t]),_e=k.forwardRef(({children:e,count:t,overscan:r,itemSize:o,shift:s,horizontal:l,keepMounted:u,cache:y,startMargin:n=0,ssrCount:d,as:v="div",item:g="div",scrollRef:m,onScroll:x,onScrollEnd:I},T)=>{const[S,f]=He(e,t),R=k.useRef(null),H=k.useRef(!!d),L=ie(x),W=ie(I),[h,_,A,V]=ze(()=>{const c=!!l,a=Te(f,o,r,d,y,!o);return[a,je(a,c),Ie(a,c),c]});f!==h.M()&&h.L(5,[f,s]),n!==h.W()&&h.L(6,n);const J=Oe(h),[Y,X]=h.m(),i=h.H(),p=h.J(),b=h.h(),C=[],E=c=>{const a=S(c);return P.jsx(Ae,{ee:_.N,te:c,ne:h.T(c),oe:h.I(c),re:g,Z:a,ie:V,se:H[j]},Ce(a,c))};Z(()=>{H[j]=!1;const c=h.O(1,O=>{O?ge.flushSync(J):J()}),a=h.O(4,()=>{L[j]&&L[j](h.C())}),w=h.O(8,()=>{W[j]&&W[j]()}),M=O=>{_.K(O),A.X(O)};return m?ue(()=>M(m[j])):M(R[j].parentElement),()=>{c(),a(),w(),_.Y(),A.Y()}},[]),Z(()=>{A.U()},[p]),k.useImperativeHandle(T,()=>({get cache(){return h._()},get scrollOffset(){return h.C()},get scrollSize(){return Re(h)},get viewportSize(){return h.p()},findStartIndex:h.$,findEndIndex:h.S,getItemOffset:h.T,getItemSize:h.R,scrollToIndex:A.D,scrollTo:A.j,scrollBy:A.q}),[]);for(let c=Y,a=X;c<=a;c++)C.push(E(c));if(u){const c=[],a=[];ce(u).forEach(w=>{w<Y&&c.push(E(w)),w>X&&a.push(E(w))}),C.unshift(...c),C.push(...a)}return P.jsx(v,{ref:R,style:{overflowAnchor:"none",flex:"none",position:"relative",visibility:"hidden",width:V?b:"100%",height:V?"100%":b,pointerEvents:i?"none":void 0},children:C})}),qe=k.forwardRef(({children:e,count:t,overscan:r,itemSize:o,shift:s,horizontal:l,keepMounted:u,reverse:y,cache:n,ssrCount:d,item:v,onScroll:g,onScrollEnd:m,style:x,...I},T)=>{const S=k.useRef(null),f=y&&!l;let R=P.jsx(_e,{ref:T,scrollRef:f?S:void 0,count:t,overscan:r,itemSize:o,shift:s,horizontal:l,keepMounted:u,cache:n,ssrCount:d,item:v,onScroll:g,onScrollEnd:m,children:e});return f&&(R=P.jsx("div",{style:{visibility:"hidden",display:"flex",flexDirection:"column",justifyContent:"flex-end",minHeight:"100%"},children:R})),P.jsx("div",{ref:S,...I,style:{display:l?"inline-block":"block",[l?"overflowX":"overflowY"]:"auto",contain:"strict",width:"100%",height:"100%",...x},children:R})}),Pe=k.memo(({count:e,Component:t,handle:r})=>{const o=k.useRef(null);return k.useImperativeHandle(r,()=>({scrollToIndex:s=>{var l;(l=o.current)==null||l.scrollToIndex(s)}})),P.jsx(qe,{ref:o,children:Array.from({length:e}).map((s,l)=>P.jsx(t,{index:l},l))})});Pe.__docgenInfo={description:"",methods:[{name:"scrollToIndex",docblock:null,modifiers:[],params:[{name:"i",optional:!1,type:null}],returns:null}],displayName:"VirtuaList",props:{count:{required:!0,tsType:{name:"number"},description:""},Component:{required:!0,tsType:{name:"SimpleItem"},description:""},handle:{required:!1,tsType:{name:"Ref",elements:[{name:"signature",type:"object",raw:"{ scrollToIndex: (index: number) => void }",signature:{properties:[{key:"scrollToIndex",value:{name:"signature",type:"function",raw:"(index: number) => void",signature:{arguments:[{type:{name:"number"},name:"index"}],return:{name:"void"}},required:!0}}]}}],raw:"Ref<ListHandle>"},description:""}}};export{Pe as V};

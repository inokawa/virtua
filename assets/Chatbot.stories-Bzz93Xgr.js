import{j as t}from"./jsx-runtime-D_zvdyIk.js";import{r}from"./iframe-BoI5bJ6Z.js";import{f as v}from"./chunk-4X5ZEQ5K-DKZdp5Hc.js";import{V as b}from"./VList-TuqWwrss.js";import"./Virtualizer-BZXmzB2E.js";import"./useLatestRef-CzhV_rsI.js";import"./useChildren-GZDHuoaX.js";import"./index-M_VcXNYe.js";import"./index-exaFy-fc.js";const F={component:b},y={border:"solid 1px #ccc",background:"#fff",padding:10,borderRadius:8,whiteSpace:"pre-wrap"},K=({children:i,blankSize:n})=>t.jsx("div",{style:{padding:10,boxSizing:"border-box",minHeight:n},children:i?t.jsx("div",{style:{...y,marginRight:160},children:i}):null}),L=({children:i,onMeasure:n})=>{const s=r.useRef(null);return r.useEffect(()=>{s.current&&n&&n(s.current.getBoundingClientRect().height)},[]),t.jsx("div",{ref:s,style:{padding:10,boxSizing:"border-box"},children:t.jsx("div",{style:{...y,background:"lightyellow",marginLeft:160},children:i})})},O={name:"Chatbot",render:()=>{const i=r.useRef(0),n=({value:e=v.lorem.paragraphs(1),role:o})=>({id:i.current++,value:e,role:o}),[s,d]=r.useState([]),m=r.useRef(null),[S,f]=r.useState(!1),[j,w]=r.useState(0),[I,z]=r.useState(0),[l,p]=r.useState("Hello world!"),x=!l.length||S,h=()=>{if(x)return;p("");const e=m.current;if(!e)return;const o=s.length-1,g=n({value:"",role:"assistant"}),{id:D}=g;d(c=>[...c,n({role:"user",value:l}),g]),f(!0),z(e.viewportSize),requestAnimationFrame(()=>{e.scrollToIndex(o+1,{smooth:!0,align:"start"})}),setTimeout(()=>{let c=0;const R=Math.floor(Math.random()*5)+1,k=setInterval(()=>{c++>20&&(f(!1),clearInterval(k)),d(C=>{const a=[...C],u=a.findIndex(E=>E.id===D);return a[u]={...a[u],value:a[u].value+v.lorem.paragraph(R)},a})},100)},1e3)};return t.jsxs("div",{style:{width:"100vw",height:"100vh",display:"flex",flexDirection:"column"},children:[t.jsx(b,{ref:m,children:s.map((e,o)=>e.role==="assistant"?t.jsx(K,{blankSize:o===s.length-1?I-j:void 0,children:e.value},e.id):t.jsx(L,{onMeasure:o===s.length-2?w:void 0,children:e.value},e.id))}),t.jsxs("form",{style:{display:"flex",flexDirection:"column",margin:10},onSubmit:e=>{e.preventDefault(),e.stopPropagation(),h()},children:[t.jsx("textarea",{style:{flex:1},rows:6,value:l,onChange:e=>{p(e.target.value)},onKeyDown:e=>{e.code==="Enter"&&(e.ctrlKey||e.metaKey)&&(h(),e.preventDefault())}}),t.jsx("div",{style:{display:"flex",flexDirection:"row",gap:8,justifyContent:"flex-end"},children:t.jsx("button",{type:"submit",disabled:x,children:"ask ai"})})]})]})}},P=["Default"];export{O as Default,P as __namedExportsOrder,F as default};

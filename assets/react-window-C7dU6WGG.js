import{j as V}from"./jsx-runtime-u17CrQMm.js";import{r as l}from"./iframe-BF_aPKkf.js";const A=typeof window<"u"?l.useLayoutEffect:l.useEffect;function L(e){if(e!==void 0)switch(typeof e){case"number":return e;case"string":{if(e.endsWith("px"))return parseFloat(e);break}}}function N({box:e,defaultHeight:t,defaultWidth:n,disabled:i,element:r,mode:s,style:c}){const{styleHeight:o,styleWidth:a}=l.useMemo(()=>({styleHeight:L(c?.height),styleWidth:L(c?.width)}),[c?.height,c?.width]),[u,d]=l.useState({height:t,width:n}),p=i||o!==void 0||s==="only-width"||o!==void 0&&a!==void 0;return A(()=>{if(r===null||p)return;const C=new ResizeObserver(H=>{for(const E of H){const{contentRect:b,target:m}=E;r===m&&d(v=>v.height===b.height&&v.width===b.width?v:{height:b.height,width:b.width})}});return C.observe(r,{box:e}),()=>{C?.unobserve(r)}},[e,p,r,o,a]),l.useMemo(()=>({height:o??u.height,width:a??u.width}),[u,o,a])}function U(e){const t=l.useRef(()=>{throw new Error("Cannot call during render.")});return A(()=>{t.current=e},[e]),l.useCallback(n=>t.current?.(n),[t])}function $({containerElement:e,direction:t,isRtl:n,scrollOffset:i}){return i}function R(e,t="Assertion error"){if(!e)throw console.error(t),Error(t)}function T(e,t){if(e===t)return!0;if(!!e!=!!t||(R(e!==void 0),R(t!==void 0),Object.keys(e).length!==Object.keys(t).length))return!1;for(const n in e)if(!Object.is(t[n],e[n]))return!1;return!0}function q({cachedBounds:e,itemCount:t,itemSize:n}){if(t===0)return 0;if(typeof n=="number")return t*n;{const i=e.get(e.size===0?0:e.size-1);R(i!==void 0,"Unexpected bounds cache miss");const r=(i.scrollOffset+i.size)/e.size;return t*r}}function Y({align:e,cachedBounds:t,index:n,itemCount:i,itemSize:r,containerScrollOffset:s,containerSize:c}){if(n<0||n>=i)throw RangeError(`Invalid index specified: ${n}`,{cause:`Index ${n} is not within the range of 0 - ${i-1}`});const o=q({cachedBounds:t,itemCount:i,itemSize:r}),a=t.get(n),u=Math.max(0,Math.min(o-c,a.scrollOffset)),d=Math.max(0,a.scrollOffset-c+a.size);switch(e==="smart"&&(s>=d&&s<=u?e="auto":e="center"),e){case"start":return u;case"end":return d;case"center":return a.scrollOffset<=c/2?0:a.scrollOffset+a.size/2>=o-c/2?o-c:a.scrollOffset+a.size/2-c/2;default:return s>=d&&s<=u?s:s<d?d:u}}function P({cachedBounds:e,containerScrollOffset:t,containerSize:n,itemCount:i,overscanCount:r}){const s=i-1;let c=0,o=-1,a=0,u=-1,d=0;for(;d<s;){const p=e.get(d);if(p.scrollOffset+p.size>t)break;d++}for(c=d,a=Math.max(0,c-r);d<s;){const p=e.get(d);if(p.scrollOffset+p.size>=t+n)break;d++}return o=Math.min(s,d),u=Math.min(i-1,o+r),c<0&&(c=0,o=-1,a=0,u=-1),{startIndexVisible:c,stopIndexVisible:o,startIndexOverscan:a,stopIndexOverscan:u}}function _({itemCount:e,itemProps:t,itemSize:n}){const i=new Map;return{get(r){for(R(r<e,`Invalid index ${r}`);i.size-1<r;){const c=i.size;let o;switch(typeof n){case"function":{o=n(c,t);break}case"number":{o=n;break}}if(c===0)i.set(c,{size:o,scrollOffset:0});else{const a=i.get(c-1);R(a!==void 0,`Unexpected bounds cache miss for index ${r}`),i.set(c,{scrollOffset:a.scrollOffset+a.size,size:o})}}const s=i.get(r);return R(s!==void 0,`Unexpected bounds cache miss for index ${r}`),s},set(r,s){i.set(r,s)},get size(){return i.size}}}function F({itemCount:e,itemProps:t,itemSize:n}){return l.useMemo(()=>_({itemCount:e,itemProps:t,itemSize:n}),[e,t,n])}function G({containerSize:e,itemSize:t}){let n;return typeof t==="string"?(R(t.endsWith("%"),`Invalid item size: "${t}"; string values must be percentages (e.g. "100%")`),R(e!==void 0,"Container size must be defined if a percentage item size is specified"),n=e*parseInt(t)/100):n=t,n}function Z({containerElement:e,containerStyle:t,defaultContainerSize:n=0,direction:i,isRtl:r=!1,itemCount:s,itemProps:c,itemSize:o,onResize:a,overscanCount:u}){const[d,p]=l.useState({startIndexVisible:0,startIndexOverscan:0,stopIndexVisible:-1,stopIndexOverscan:-1}),{startIndexVisible:C,startIndexOverscan:H,stopIndexVisible:E,stopIndexOverscan:b}={startIndexVisible:Math.min(s-1,d.startIndexVisible),startIndexOverscan:Math.min(s-1,d.startIndexOverscan),stopIndexVisible:Math.min(s-1,d.stopIndexVisible),stopIndexOverscan:Math.min(s-1,d.stopIndexOverscan)},{height:m=n,width:v=n}=N({defaultHeight:n,defaultWidth:void 0,element:e,mode:"only-height",style:t}),I=l.useRef({height:0,width:0}),y=m,M=G({containerSize:y,itemSize:o});l.useLayoutEffect(()=>{if(typeof a=="function"){const f=I.current;(f.height!==m||f.width!==v)&&(a({height:m,width:v},{...f}),f.height=m,f.width=v)}},[m,a,v]);const x=F({itemCount:s,itemProps:c,itemSize:M}),j=l.useCallback(f=>x.get(f),[x]),w=l.useCallback(()=>q({cachedBounds:x,itemCount:s,itemSize:M}),[x,s,M]),k=l.useCallback(f=>{const S=$({containerElement:e,direction:i,isRtl:r,scrollOffset:f});return P({cachedBounds:x,containerScrollOffset:S,containerSize:y,itemCount:s,overscanCount:u})},[x,e,y,i,r,s,u]);A(()=>{const f=e?.scrollTop??0;p(k(f))},[e,i,k]),A(()=>{if(!e)return;const f=()=>{p(S=>{const{scrollLeft:B,scrollTop:g}=e,h=$({containerElement:e,direction:i,isRtl:r,scrollOffset:g}),z=P({cachedBounds:x,containerScrollOffset:h,containerSize:y,itemCount:s,overscanCount:u});return T(z,S)?S:z})};return e.addEventListener("scroll",f),()=>{e.removeEventListener("scroll",f)}},[x,e,y,i,s,u]);const O=U(({align:f="auto",containerScrollOffset:S,index:B})=>{let g=Y({align:f,cachedBounds:x,containerScrollOffset:S,containerSize:y,index:B,itemCount:s,itemSize:M});if(e){if(g=$({containerElement:e,direction:i,isRtl:r,scrollOffset:g}),typeof e.scrollTo!="function"){const h=k(g);T(d,h)||p(h)}return g}});return{getCellBounds:j,getEstimatedSize:w,scrollToIndex:O,startIndexOverscan:H,startIndexVisible:C,stopIndexOverscan:b,stopIndexVisible:E}}function D(e){return l.useMemo(()=>e,Object.values(e))}function J(e,t){const{ariaAttributes:n,style:i,...r}=e,{ariaAttributes:s,style:c,...o}=t;return T(n,s)&&T(i,c)&&T(r,o)}function K(e){return e!=null&&typeof e=="object"&&"getAverageRowHeight"in e&&typeof e.getAverageRowHeight=="function"}const Q="data-react-window-index";function X({children:e,className:t,defaultHeight:n=0,listRef:i,onResize:r,onRowsRendered:s,overscanCount:c=3,rowComponent:o,rowCount:a,rowHeight:u,rowProps:d,tagName:p="div",style:C,...H}){const E=D(d),b=l.useMemo(()=>l.memo(o,J),[o]),[m,v]=l.useState(null),I=K(u),y=l.useMemo(()=>I?g=>u.getRowHeight(g)??u.getAverageRowHeight():u,[I,u]),{getCellBounds:M,getEstimatedSize:x,scrollToIndex:j,startIndexOverscan:w,startIndexVisible:k,stopIndexOverscan:O,stopIndexVisible:f}=Z({containerElement:m,containerStyle:C,defaultContainerSize:n,direction:"vertical",itemCount:a,itemProps:E,itemSize:y,onResize:r,overscanCount:c});l.useImperativeHandle(i,()=>({get element(){return m},scrollToRow({align:g="auto",behavior:h="auto",index:z}){const W=j({align:g,containerScrollOffset:m?.scrollTop??0,index:z});typeof m?.scrollTo=="function"&&m.scrollTo({behavior:h,top:W})}}),[m,j]),A(()=>{if(!m)return;const g=Array.from(m.children).filter((h,z)=>{if(h.hasAttribute("aria-hidden"))return!1;const W=`${w+z}`;return h.setAttribute(Q,W),!0});if(I)return u.observeRowElements(g)},[m,I,u,w,O]),l.useEffect(()=>{w>=0&&O>=0&&s&&s({startIndex:k,stopIndex:f},{startIndex:w,stopIndex:O})},[s,w,k,O,f]);const S=l.useMemo(()=>{const g=[];if(a>0)for(let h=w;h<=O;h++){const z=M(h);g.push(l.createElement(b,{...E,ariaAttributes:{"aria-posinset":h+1,"aria-setsize":a,role:"listitem"},key:h,index:h,style:{position:"absolute",left:0,transform:`translateY(${z.scrollOffset}px)`,height:I?void 0:z.size,width:"100%"}}))}return g},[b,M,I,a,E,w,O]),B=V.jsx("div",{"aria-hidden":!0,style:{height:x(),width:"100%",zIndex:-1}});return l.createElement(p,{role:"list",...H,className:t,ref:v,style:{position:"relative",maxHeight:"100%",flexGrow:1,overflowY:"auto",...C}},S,e,B)}const ee=({index:e,setHeight:t,Component:n})=>{const i=l.useRef(null);return l.useEffect(()=>{i.current&&t(e,i.current.getBoundingClientRect().height)},[]),V.jsx(n,{ref:i,index:e})},te=({index:e,style:t,Component:n,setHeight:i})=>V.jsx("div",{style:t,children:V.jsx(ee,{index:e,setHeight:i,Component:n})},e),ne=l.memo(({count:e,Component:t,handle:n})=>{const[i,r]=l.useState(()=>Array.from({length:e}).map(()=>50)),s=l.useRef(null),c=o=>i[o];return l.useImperativeHandle(n,()=>({scrollToIndex:o=>{s.current?.scrollToRow({index:o,align:"start"})}})),V.jsx(X,{listRef:s,rowCount:e,rowHeight:c,rowComponent:te,rowProps:l.useMemo(()=>({Component:t,setHeight:(o,a)=>{r(u=>{const d=[...u];return d[o]=a,d})}}),[t])})});ne.__docgenInfo={description:"",methods:[{name:"scrollToIndex",docblock:null,modifiers:[],params:[{name:"i",optional:!1,type:null}],returns:null}],displayName:"ReactWindowList",props:{count:{required:!0,tsType:{name:"number"},description:""},Component:{required:!0,tsType:{name:"SimpleItem"},description:""},handle:{required:!1,tsType:{name:"Ref",elements:[{name:"signature",type:"object",raw:"{ scrollToIndex: (index: number) => void }",signature:{properties:[{key:"scrollToIndex",value:{name:"signature",type:"function",raw:"(index: number) => void",signature:{arguments:[{type:{name:"number"},name:"index"}],return:{name:"void"}},required:!0}}]}}],raw:"Ref<ListHandle>"},description:""}}};export{ne as R};

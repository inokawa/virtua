import{j as T}from"./jsx-runtime-BjG_zV1W.js";import{r as l}from"./iframe-BqqiOlV0.js";const j=typeof window<"u"?l.useLayoutEffect:l.useEffect;function P(e){if(e!==void 0)switch(typeof e){case"number":return e;case"string":{if(e.endsWith("px"))return parseFloat(e);break}}}function $({box:e,defaultHeight:t,defaultWidth:i,disabled:n,element:c,mode:s,style:r}){const{styleHeight:a,styleWidth:o}=l.useMemo(()=>({styleHeight:P(r==null?void 0:r.height),styleWidth:P(r==null?void 0:r.width)}),[r==null?void 0:r.height,r==null?void 0:r.width]),[d,u]=l.useState({height:t,width:i}),p=n||a!==void 0||s==="only-width"||a!==void 0&&o!==void 0;return j(()=>{if(c===null||p)return;const z=new ResizeObserver(M=>{for(const y of M){const{contentRect:w,target:f}=y;c===f&&u(b=>b.height===w.height&&b.width===w.width?b:{height:w.height,width:w.width})}});return z.observe(c,{box:e}),()=>{z==null||z.unobserve(c)}},[e,p,c,a,o]),l.useMemo(()=>({height:a??d.height,width:o??d.width}),[d,a,o])}function N(e){const t=l.useRef(()=>{throw new Error("Cannot call an event handler while rendering.")});return j(()=>{t.current=e},[e]),l.useCallback(i=>{var n;return(n=t.current)==null?void 0:n.call(t,i)},[t])}function L({containerElement:e,direction:t,isRtl:i,scrollOffset:n}){return n}function O(e,t="Assertion error"){if(!e)throw console.error(t),Error(t)}function k(e,t){if(e===t)return!0;if(!!e!=!!t||(O(e!==void 0),O(t!==void 0),Object.keys(e).length!==Object.keys(t).length))return!1;for(const i in e)if(!Object.is(t[i],e[i]))return!1;return!0}function A({cachedBounds:e,itemCount:t,itemSize:i}){if(t===0)return 0;if(typeof i=="number")return t*i;{const n=e.get(e.size===0?0:e.size-1);O(n!==void 0,"Unexpected bounds cache miss");const c=(n.scrollOffset+n.size)/e.size;return t*c}}function U({align:e,cachedBounds:t,index:i,itemCount:n,itemSize:c,containerScrollOffset:s,containerSize:r}){const a=A({cachedBounds:t,itemCount:n,itemSize:c}),o=t.get(i),d=Math.max(0,Math.min(a-r,o.scrollOffset)),u=Math.max(0,o.scrollOffset-r+o.size);switch(e==="smart"&&(s>=u&&s<=d?e="auto":e="center"),e){case"start":return d;case"end":return u;case"center":return o.scrollOffset<=r/2?0:o.scrollOffset+o.size/2>=a-r/2?a-r:o.scrollOffset+o.size/2-r/2;case"auto":default:return s>=u&&s<=d?s:s<u?u:d}}function q({cachedBounds:e,containerScrollOffset:t,containerSize:i,itemCount:n,overscanCount:c}){const s=n-1;let r=0,a=-1,o=0,d=-1,u=0;for(;u<s;){const p=e.get(u);if(p.scrollOffset+p.size>t)break;u++}for(r=u,o=Math.max(0,r-c);u<s;){const p=e.get(u);if(p.scrollOffset+p.size>=t+i)break;u++}return a=Math.min(s,u),d=Math.min(n-1,a+c),r<0&&(r=0,a=-1,o=0,d=-1),{startIndexVisible:r,stopIndexVisible:a,startIndexOverscan:o,stopIndexOverscan:d}}function Y({itemCount:e,itemProps:t,itemSize:i}){const n=new Map;return{get(c){for(O(c<e,`Invalid index ${c}`);n.size-1<c;){const r=n.size;let a;switch(typeof i){case"function":{a=i(r,t);break}case"number":{a=i;break}}if(r===0)n.set(r,{size:a,scrollOffset:0});else{const o=n.get(r-1);O(o!==void 0,`Unexpected bounds cache miss for index ${c}`),n.set(r,{scrollOffset:o.scrollOffset+o.size,size:a})}}const s=n.get(c);return O(s!==void 0,`Unexpected bounds cache miss for index ${c}`),s},set(c,s){n.set(c,s)},get size(){return n.size}}}function _({itemCount:e,itemProps:t,itemSize:i}){return l.useMemo(()=>Y({itemCount:e,itemProps:t,itemSize:i}),[e,t,i])}function F({containerSize:e,itemSize:t}){let i;switch(typeof t){case"string":{O(t.endsWith("%"),`Invalid item size: "${t}"; string values must be percentages (e.g. "100%")`),O(e!==void 0,"Container size must be defined if a percentage item size is specified"),i=e*parseInt(t)/100;break}default:{i=t;break}}return i}function G({containerElement:e,containerStyle:t,defaultContainerSize:i=0,direction:n,isRtl:c=!1,itemCount:s,itemProps:r,itemSize:a,onResize:o,overscanCount:d}){const[u,p]=l.useState({startIndexVisible:0,startIndexOverscan:0,stopIndexVisible:-1,stopIndexOverscan:-1}),{startIndexVisible:z,startIndexOverscan:M,stopIndexVisible:y,stopIndexOverscan:w}={startIndexVisible:Math.min(s-1,u.startIndexVisible),startIndexOverscan:Math.min(s-1,u.startIndexOverscan),stopIndexVisible:Math.min(s-1,u.stopIndexVisible),stopIndexOverscan:Math.min(s-1,u.stopIndexOverscan)},{height:f=i,width:b=i}=$({defaultHeight:i,defaultWidth:void 0,element:e,mode:"only-height",style:t}),V=l.useRef({height:0,width:0}),I=f,S=F({containerSize:I,itemSize:a});l.useLayoutEffect(()=>{if(typeof o=="function"){const m=V.current;(m.height!==f||m.width!==b)&&(o({height:f,width:b},{...m}),m.height=f,m.width=b)}},[f,o,b]);const h=_({itemCount:s,itemProps:r,itemSize:S}),H=l.useCallback(m=>h.get(m),[h]),C=l.useCallback(()=>A({cachedBounds:h,itemCount:s,itemSize:S}),[h,s,S]),R=l.useCallback(m=>{const x=L({containerElement:e,direction:n,isRtl:c,scrollOffset:m});return q({cachedBounds:h,containerScrollOffset:x,containerSize:I,itemCount:s,overscanCount:d})},[h,e,I,n,c,s,d]);j(()=>{const m=(e==null?void 0:e.scrollTop)??0;p(R(m))},[e,n,R]),j(()=>{if(!e)return;const m=()=>{p(x=>{const{scrollLeft:g,scrollTop:v}=e,E=L({containerElement:e,direction:n,isRtl:c,scrollOffset:v}),W=q({cachedBounds:h,containerScrollOffset:E,containerSize:I,itemCount:s,overscanCount:d});return k(W,x)?x:W})};return e.addEventListener("scroll",m),()=>{e.removeEventListener("scroll",m)}},[h,e,I,n,s,d]);const B=N(({align:m="auto",containerScrollOffset:x,index:g})=>{let v=U({align:m,cachedBounds:h,containerScrollOffset:x,containerSize:I,index:g,itemCount:s,itemSize:S});if(e){if(v=L({containerElement:e,direction:n,isRtl:c,scrollOffset:v}),typeof e.scrollTo!="function"){const E=R(v);k(u,E)||p(E)}return v}});return{getCellBounds:H,getEstimatedSize:C,scrollToIndex:B,startIndexOverscan:M,startIndexVisible:z,stopIndexOverscan:w,stopIndexVisible:y}}function J(e){return l.useMemo(()=>e,Object.values(e))}function X(e,t){const{ariaAttributes:i,style:n,...c}=e,{ariaAttributes:s,style:r,...a}=t;return k(i,s)&&k(n,r)&&k(c,a)}function D({children:e,className:t,defaultHeight:i=0,listRef:n,onResize:c,onRowsRendered:s,overscanCount:r=3,rowComponent:a,rowCount:o,rowHeight:d,rowProps:u,tagName:p="div",style:z,...M}){const y=J(u),w=l.useMemo(()=>l.memo(a,X),[a]),[f,b]=l.useState(null),{getCellBounds:V,getEstimatedSize:I,scrollToIndex:S,startIndexOverscan:h,startIndexVisible:H,stopIndexOverscan:C,stopIndexVisible:R}=G({containerElement:f,defaultContainerSize:i,direction:"vertical",itemCount:o,itemProps:y,itemSize:d,onResize:c,overscanCount:r});l.useImperativeHandle(n,()=>({get element(){return f},scrollToRow({align:x="auto",behavior:g="auto",index:v}){const E=S({align:x,containerScrollOffset:(f==null?void 0:f.scrollTop)??0,index:v});typeof(f==null?void 0:f.scrollTo)=="function"&&f.scrollTo({behavior:g,top:E})}}),[f,S]),l.useEffect(()=>{h>=0&&C>=0&&s&&s({startIndex:H,stopIndex:R},{startIndex:h,stopIndex:C})},[s,h,H,C,R]);const B=l.useMemo(()=>{const x=[];if(o>0)for(let g=h;g<=C;g++){const v=V(g);x.push(l.createElement(w,{...y,ariaAttributes:{"aria-posinset":g+1,"aria-setsize":o,role:"listitem"},key:g,index:g,style:{position:"absolute",left:0,transform:`translateY(${v.scrollOffset}px)`,height:v.size,width:"100%"}}))}return x},[w,V,o,y,h,C]),m=T.jsx("div",{"aria-hidden":!0,style:{height:I(),width:"100%",zIndex:-1}});return l.createElement(p,{role:"list",...M,className:t,ref:b,style:{position:"relative",maxHeight:"100%",flexGrow:1,overflowY:"auto",...z}},B,e,m)}const K=({index:e,setHeight:t,Component:i})=>{const n=l.useRef(null);return l.useEffect(()=>{n.current&&t(e,n.current.getBoundingClientRect().height)},[]),T.jsx(i,{ref:n,index:e})},Q=({index:e,style:t,Component:i,setHeight:n})=>T.jsx("div",{style:t,children:T.jsx(K,{index:e,setHeight:n,Component:i})},e),Z=l.memo(({count:e,Component:t,handle:i})=>{const[n,c]=l.useState(()=>Array.from({length:e}).map(()=>50)),s=l.useRef(null),r=a=>n[a];return l.useImperativeHandle(i,()=>({scrollToIndex:a=>{var o;(o=s.current)==null||o.scrollToRow({index:a,align:"start"})}})),T.jsx(D,{listRef:s,rowCount:e,rowHeight:r,rowComponent:Q,rowProps:l.useMemo(()=>({Component:t,setHeight:(a,o)=>{c(d=>{const u=[...d];return u[a]=o,u})}}),[t])})});Z.__docgenInfo={description:"",methods:[{name:"scrollToIndex",docblock:null,modifiers:[],params:[{name:"i",optional:!1,type:null}],returns:null}],displayName:"ReactWindowList",props:{count:{required:!0,tsType:{name:"number"},description:""},Component:{required:!0,tsType:{name:"SimpleItem"},description:""},handle:{required:!1,tsType:{name:"Ref",elements:[{name:"signature",type:"object",raw:"{ scrollToIndex: (index: number) => void }",signature:{properties:[{key:"scrollToIndex",value:{name:"signature",type:"function",raw:"(index: number) => void",signature:{arguments:[{type:{name:"number"},name:"index"}],return:{name:"void"}},required:!0}}]}}],raw:"Ref<ListHandle>"},description:""}}};export{Z as R};

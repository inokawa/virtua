import{j as q}from"./jsx-runtime-DCrfGL6_.js";import{r as E}from"./index-98wxwTcn.js";import{r as me}from"./index-SCI4cgSJ.js";const A=null,P=Math.min,z=Math.max,re=Math.abs,pe=Array.isArray,Q=setTimeout,ie=(e,t,r)=>P(r,z(t,e)),le=e=>[...e].sort((t,r)=>t-r),ce=typeof queueMicrotask=="function"?queueMicrotask:e=>{Promise.resolve().then(e)},te=e=>{let t,r;return(...n)=>(t||(t=!0,r=e(...n)),r)},W=-1,K=(e,t,r)=>{const n=r?"unshift":"push";for(let s=0;s<t;s++)e[n](W);return e},U=(e,t)=>{const r=e.t[t];return r===W?e.o:r},ve=(e,t,r)=>{const n=e.t[t]===W;return e.t[t]=r,e.i=P(t,e.i),n},ee=(e,t)=>{if(!e.l)return 0;if(e.i>=t)return e.u[t];e.i<0&&(e.u[0]=0,e.i=0);let r=e.i,n=e.u[r];for(;r<t;)n+=U(e,r),e.u[++r]=n;return e.i=t,n},ne=(e,t,r)=>{for(;r>=0&&r<e.l;){const n=ee(e,r);if(n<=t){if(n+U(e,r)>t)break;r++}else r--}return ie(r,0,e.l-1)},oe=(e,t,r)=>{const n=t-e.l;return e.i=r?-1:P(t-1,e.i),e.l=t,n>0?(K(e.u,n),K(e.t,n,r),e.o*n):(e.u.splice(n),(r?e.t.splice(0,-n):e.t.splice(n)).reduce((s,a)=>s-(a===W?e.o:a),0))},ue=typeof window<"u",ae=()=>document.documentElement,ye=e=>e.ownerDocument,ge=e=>e.defaultView,fe=te(()=>!!ue&&getComputedStyle(ae()).direction==="rtl"),de=te(()=>/iP(hone|od|ad)/.test(navigator.userAgent)),we=te(()=>"scrollBehavior"in ae().style),be=e=>z(e.h(),e._()),xe=(e,t,r,n,s)=>(n!==1&&(e-=z(0,r)),n!==2&&(t+=z(0,r)),[z(e,0),P(t,s-1)]),Re=(e,t=40,r=0,n,s=!1)=>{let a=!!r,c=[],l=0,o=0,u=0,h=0,d=0,f=0,y=0,D=0,M=0,k=a?[0,z(r-1,0)]:A,m=[0,0],b=0;const p=((i,g,x)=>({o:x?x[1]:g,t:x&&x[0]?K(x[0].slice(0,P(i,x[0].length)),z(0,i-x[0].length)):K([],i),l:i,i:-1,u:K([],i)}))(e,t,n),X=new Set,V=()=>u-o,J=i=>((g,x,O,S)=>{const C=ne(g,x,P(O,g.l-1));return[C,ne(g,x+S,C)]})(p,i,m[0],l),v=()=>(i=>i.l?ee(i,i.l-1)+U(i,i.l-1):0)(p),F=i=>ee(p,i)-f,$=i=>U(p,i),Y=i=>{i&&(de()&&D!==0?f+=i:(d+=i,h++))};return{p:()=>c,v:()=>(i=>[[...i.t],i.o])(p),m:()=>y?m:(m=J(z(0,V()+f+d)),k?[P(m[0],k[0]),z(m[1],k[1])]:m),S:i=>p.t[i]===W,I:()=>!!l,k:()=>!!k&&p.t.slice(z(0,k[0]-1),P(p.l-1,k[1]+1)+1).includes(W),R:F,C:$,M:()=>p.l,T:()=>u,H:()=>D,_:()=>l,W:()=>o,h:v,J:()=>h,B:()=>(y=d,d=0,[y,M===2||V()+l>=v()]),O(i,g){const x=[i,g];return X.add(x),()=>{X.delete(x)}},D(i,g){let x,O,S=0;switch(i){case 1:{const C=y;y=0;const w=g-u,T=re(w);C&&T<re(C)+1||M!==0||(D=w<0?2:1),a&&(k=A,a=!1),u=g,S=4;const I=V();I>=-l&&I<=v()&&(S+=1,O=T>l);break}case 2:S=8,D!==0&&(x=!0,S+=1),D=0,M=0,k=A;break;case 3:{const C=g.filter(([w,T])=>p.t[w]!==T);if(!C.length)break;Y(C.reduce((w,[T,I])=>((M===2||(k?T<k[0]:F(T)+(D===0&&M===0?$(T):0)<V()))&&(w+=I-$(T)),w),0));for(const[w,T]of C){const I=$(w),B=ve(p,w,T);s&&(b+=T,B||(b-=I))}s&&l&&b>l&&(Y(((w,T)=>{let I=0;const B=w.t.filter((L,j)=>{const H=L!==W;return H&&j<T&&I++,H}),R=w.o;return w.i=-1,((w.o=(L=>{const j=le(L),H=L.length/2|0;return j.length%2==0?(j[H-1]+j[H])/2:j[H]})(B))-R)*z(T-I,0)})(p,m[0])),s=!1),S=3,O=!0;break}case 4:l!==g&&(l=g,S=3);break;case 5:g[1]?(Y(oe(p,g[0],!0)),M=2,S=1):oe(p,g[0]);break;case 6:o=g;break;case 7:M=1;break;case 8:k=J(g),S=1}S&&(c=[],x&&f&&(d+=f,f=0,h++),X.forEach(([C,w])=>{S&C&&w(O)}))}}},Z=ue?E.useLayoutEffect:E.useEffect,G=(e,t)=>t&&fe()?-e:e,Ee=(e,t,r,n,s,a)=>{const c=Date.now;let l=0,o=!1,u=!1,h=!1,d=!1;const f=(()=>{let m;const b=()=>{m!=A&&clearTimeout(m)},p=()=>{b(),m=Q(()=>{m=A,(()=>{if(o||u)return o=!1,void f();h=!1,e.D(2)})()},150)};return p.L=b,p})(),y=()=>{l=c(),h&&(d=!0),e.D(1,n()),f()},D=m=>{if(o||e.H()===0||m.ctrlKey)return;const b=c()-l;150>b&&50<b&&(r?m.deltaX:m.deltaY)&&(o=!0)},M=()=>{u=!0,h=d=!1},k=()=>{u=!1,de()&&(h=!0)};return t.addEventListener("scroll",y),t.addEventListener("wheel",D,{passive:!0}),t.addEventListener("touchstart",M,{passive:!0}),t.addEventListener("touchend",k,{passive:!0}),{$:()=>{t.removeEventListener("scroll",y),t.removeEventListener("wheel",D),t.removeEventListener("touchstart",M),t.removeEventListener("touchend",k),f.L()},A:()=>{const[m,b]=e.B();m&&(s(G(m,r),b,d),d=!1,b&&e._()>e.h()&&e.D(1,n()))}}},ke=(e,t)=>{let r,n,s;const a=t?"scrollLeft":"scrollTop",c=t?"overflowX":"overflowY",l=async(o,u)=>{if(!r)return void ce(()=>l(o,u));s&&s();const h=()=>{let d;return[new Promise((f,y)=>{d=f,s=y,e.I()&&Q(y,150)}),e.O(2,()=>{d&&d()})]};if(u&&we()){for(;e.D(8,o()),e.k();){const[d,f]=h();try{await d}catch{return}finally{f()}}r.scrollTo({[t?"left":"top"]:G(o(),t),behavior:"smooth"})}else for(;;){const[d,f]=h();try{r[a]=G(o(),t),e.D(7),await d}catch{return}finally{f()}}};return{P(o){r=o,n=Ee(e,o,t,()=>G(o[a],t),(u,h,d)=>{if(d){const f=o.style,y=f[c];f[c]="hidden",Q(()=>{f[c]=y})}h?(o[a]=e.T()+u,s&&s()):o[a]+=u})},$(){n&&n.$()},V(o){l(()=>o)},X(o){o+=e.T(),l(()=>o)},Y(o,{align:u,smooth:h,offset:d=0}={}){if(o=ie(o,0,e.M()-1),u==="nearest"){const f=e.R(o),y=e.T();if(f<y)u="start";else{if(!(f+e.C(o)>y+e._()))return;u="end"}}l(()=>d+e.W()+e.R(o)+(u==="end"?e.C(o)-e._():u==="center"?(e.C(o)-e._())/2:0),h)},A:()=>{n&&n.A()}}},_="current",he=(e,t)=>{if(pe(e))for(const r of e)he(r,t);else e==A||typeof e=="boolean"||t.push(e)},Te=(e,t)=>{const r=e.key;return r!=A?r:"_"+t},Le=e=>{const t=E.useRef();return t[_]||(t[_]=e())},se=e=>{const t=E.useRef(e);return Z(()=>{t[_]=e},[e]),t},Me=e=>{let t;return{P(r){(t||(t=new(ge(ye(r))).ResizeObserver(e))).observe(r)},j(r){t.unobserve(r)},$(){t&&t.disconnect()}}},Se=(e,t)=>{let r;const n=t?"width":"height",s=new WeakMap,a=Me(c=>{const l=[];for(const{target:o,contentRect:u}of c)if(o.offsetParent)if(o===r)e.D(4,u[n]);else{const h=s.get(o);h!=A&&l.push([h,u[n]])}l.length&&e.D(3,l)});return{q(c){a.P(r=c)},U:(c,l)=>(s.set(c,l),a.P(c),()=>{s.delete(c),a.j(c)}),$:a.$}},Ce=E.memo(({F:e,G:t,K:r,N:n,Z:s,ee:a,te:c,ne:l})=>{const o=E.useRef(A);Z(()=>t(o[_],r),[r]);const u=E.useMemo(()=>{const h={margin:0,padding:0,position:s&&l?void 0:"absolute",[c?"height":"width"]:"100%",[c?"top":"left"]:0,[c?fe()?"right":"left":"top"]:n,visibility:!s||l?"visible":"hidden"};return c&&(h.display="flex"),h},[n,s,l,c]);return q.jsx(a,typeof a=="string"?{ref:o,style:u,children:e}:{ref:o,style:u,index:r,children:e})}),De=e=>E.useReducer(e.p,void 0,e.p)[1],je=(e,t)=>E.useMemo(()=>{if(typeof e=="function")return[e,t||0];const r=(n=>{const s=[];return he(n,s),s})(e);return[n=>r[n],r.length]},[e,t]),Ie=E.forwardRef(({children:e,count:t,overscan:r=4,keepMounted:n,itemSize:s,shift:a,horizontal:c,cache:l,startMargin:o=0,ssrCount:u,as:h="div",item:d="div",scrollRef:f,onScroll:y,onScrollEnd:D,onRangeChange:M},k)=>{const[m,b]=je(e,t),p=E.useRef(A),X=E.useRef(!!u),V=se(y),J=se(D),[v,F,$,Y]=Le(()=>{const R=!!c,L=Re(b,s,u,l,!s);return[L,Se(L,R),ke(L,R),R]});b!==v.M()&&v.D(5,[b,a]),o!==v.W()&&v.D(6,o);const i=De(v),[g,x]=v.m(),O=v.H(),S=v.J(),C=v.h(),w=[],[T,I]=xe(g,x,r,O,b),B=R=>{const L=m(R);return q.jsx(Ce,{G:F.U,K:R,N:v.R(R),Z:v.S(R),ee:d,F:L,te:Y,ne:X[_]},Te(L,R))};Z(()=>{X[_]=!1;const R=v.O(1,N=>{N?me.flushSync(i):i()}),L=v.O(4,()=>{V[_]&&V[_](v.T())}),j=v.O(8,()=>{J[_]&&J[_]()}),H=N=>{F.q(N),$.P(N)};return f?ce(()=>H(f[_])):H(p[_].parentElement),()=>{R(),L(),j(),F.$(),$.$()}},[]),Z(()=>{$.A()},[S]),E.useEffect(()=>{M&&M(g,x)},[g,x]),E.useImperativeHandle(k,()=>({get cache(){return v.v()},get scrollOffset(){return v.T()},get scrollSize(){return be(v)},get viewportSize(){return v._()},getItemOffset:v.R,scrollToIndex:$.Y,scrollTo:$.V,scrollBy:$.X}),[]);for(let R=T,L=I;R<=L;R++)w.push(B(R));if(n){const R=[],L=[];le(n).forEach(j=>{j<T&&R.push(B(j)),j>I&&L.push(B(j))}),w.unshift(...R),w.push(...L)}return q.jsx(h,{ref:p,style:{overflowAnchor:"none",flex:"none",position:"relative",visibility:"hidden",width:Y?C:"100%",height:Y?"100%":C,pointerEvents:O!==0?"none":"auto"},children:w})}),_e=E.forwardRef(({children:e,count:t,overscan:r,keepMounted:n,itemSize:s,shift:a,horizontal:c,reverse:l,cache:o,ssrCount:u,item:h,onScroll:d,onScrollEnd:f,onRangeChange:y,style:D,...M},k)=>{const m=E.useRef(A),b=l&&!c;let p=q.jsx(Ie,{ref:k,scrollRef:b?m:void 0,count:t,overscan:r,keepMounted:n,itemSize:s,shift:a,horizontal:c,cache:o,ssrCount:u,item:h,onScroll:d,onScrollEnd:f,onRangeChange:y,children:e});return b&&(p=q.jsx("div",{style:{visibility:"hidden",display:"flex",flexDirection:"column",justifyContent:"flex-end",minHeight:"100%"},children:p})),q.jsx("div",{ref:m,...M,style:{display:c?"inline-block":"block",[c?"overflowX":"overflowY"]:"auto",contain:"strict",width:"100%",height:"100%",...D},children:p})}),$e=E.memo(({count:e,Component:t,handle:r})=>{const n=E.useRef(null);return E.useImperativeHandle(r,()=>({scrollToIndex:s=>{var a;(a=n.current)==null||a.scrollToIndex(s)}})),q.jsx(_e,{ref:n,children:Array.from({length:e}).map((s,a)=>q.jsx(t,{index:a},a))})});$e.__docgenInfo={description:"",methods:[{name:"scrollToIndex",docblock:null,modifiers:[],params:[{name:"i",optional:!1,type:null}],returns:null}],displayName:"VirtuaList",props:{count:{required:!0,tsType:{name:"number"},description:""},Component:{required:!0,tsType:{name:"SimpleItem"},description:""},handle:{required:!1,tsType:{name:"Ref",elements:[{name:"signature",type:"object",raw:"{ scrollToIndex: (index: number) => void }",signature:{properties:[{key:"scrollToIndex",value:{name:"signature",type:"function",raw:"(index: number) => void",signature:{arguments:[{type:{name:"number"},name:"index"}],return:{name:"void"}},required:!0}}]}}],raw:"Ref<ListHandle>"},description:""}}};export{$e as V};

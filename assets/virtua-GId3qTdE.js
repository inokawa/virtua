import{j as D}from"./jsx-runtime-BjG_zV1W.js";import{r as M}from"./iframe-rSo0l5md.js";import{r as ye}from"./index-fa07GDGl.js";const K=null,{min:B,max:z,abs:ne,floor:ge}=Math,ie=(e,t,r)=>B(r,z(t,e)),ce=e=>[...e].sort((t,r)=>t-r),xe=typeof queueMicrotask=="function"?queueMicrotask:e=>{Promise.resolve().then(e)},oe=()=>{let e,t;return[new Promise((r,n)=>{e=r,t=n}),e,t]},ee=e=>{let t;return()=>(e&&(t=e(),e=void 0),t)},q=-1,F=(e,t,r)=>{const n=r?"unshift":"push";for(let s=0;s<t;s++)e[n](q);return e},$=(e,t)=>{const r=e.t[t];return r===q?e.o:r},we=(e,t,r)=>{const n=e.t[t]===q;return e.t[t]=r,e.i=B(t,e.i),n},G=(e,t)=>{if(!e.l)return 0;if(e.i>=t)return e.u[t];e.i<0&&(e.u[0]=0,e.i=0);let r=e.i,n=e.u[r];for(;r<t;)n+=$(e,r),e.u[++r]=n;return e.i=t,n},_=(e,t,r=0,n=e.l-1)=>{for(;r<=n;){const s=ge((r+n)/2),c=G(e,s);if(c<=t){if(c+$(e,s)>t)return s;r=s+1}else n=s-1}return ie(r,0,e.l-1)},se=(e,t,r)=>{const n=t-e.l;return e.i=r?-1:B(t-1,e.i),e.l=t,n>0?(F(e.u,n),F(e.t,n,r),e.o*n):(e.u.splice(n),(r?e.t.splice(0,-n):e.t.splice(n)).reduce((s,c)=>s-(c===q?e.o:c),0))},ue=typeof window<"u",ae=()=>document.documentElement,be=e=>e.ownerDocument,Ee=e=>e.defaultView,fe=ee(()=>!!ue&&getComputedStyle(ae()).direction==="rtl"),de=ee(()=>/iP(hone|od|ad)/.test(navigator.userAgent)),Re=ee(()=>"scrollBehavior"in ae().style),ke=e=>z(e.h(),e.p()),Se=e=>!!e.p(),Te=(e,t=40,r=4,n=0,s,c=!1)=>{let d=!!n,b=1,u=0,E=0,x=0,l=0,m=0,S=0,y=0,v=0,h=d?[0,z(n-1,0)]:K,R=[0,0],T=0;const g=((o,a,k)=>({o:k?k[1]:a,t:k&&k[0]?F(k[0].slice(0,B(o,k[0].length)),z(0,o-k[0].length)):F([],o),l:o,i:-1,u:F([],o)}))(e,t,s),O=new Set,H=()=>x-E,p=()=>H()+m+l,P=o=>((a,k,J,w)=>{if(w=B(w,a.l-1),G(a,w)<=k){const L=_(a,k+J,w);return[_(a,k,w,L),L]}{const L=_(a,k,void 0,w);return[L,_(a,k+J,L)]}})(g,o,u,R[0]),C=()=>(o=>o.l?G(o,o.l-1)+$(o,o.l-1):0)(g),W=o=>G(g,o)-m,X=o=>$(g,o),Y=o=>{o&&(de()&&y!==0?m+=o:l+=o)};return{v:()=>b,m:()=>(o=>[o.t.slice(),o.o])(g),_:()=>{let o,a;return S?[o,a]=R:([o,a]=R=P(z(0,p())),h&&(o=B(o,h[0]),a=z(a,h[1]))),y!==1&&(o-=z(0,r)),y!==2&&(a+=z(0,r)),[z(o,0),B(a,g.l-1)]},S:()=>_(g,p()),$:()=>_(g,p()+u),I:o=>g.t[o]===q,k:()=>!!h&&g.t.slice(z(0,h[0]-1),B(g.l-1,h[1]+1)+1).includes(q),R:W,T:X,C:()=>g.l,M:()=>x,H:()=>y!==0,p:()=>u,W:()=>E,h:C,O:()=>(S=l,l=0,[S,v===2||H()+u>=C()]),B:(o,a)=>{const k=[o,a];return O.add(k),()=>{O.delete(k)}},J:(o,a)=>{let k,J,w=0;switch(o){case 1:{const L=S;S=0;const i=a-x,f=ne(i);L&&f<ne(L)+1||v!==0||(y=i<0?2:1),d&&(h=K,d=!1),x=a,w=4;const I=H();I>=-u&&I<=C()&&(w+=1,J=f>u);break}case 2:w=8,y!==0&&(k=!0,w+=1),y=0,v=0,h=K;break;case 3:{const L=a.filter(([i,f])=>g.t[i]!==f);if(!L.length)break;Y(L.reduce((i,[f,I])=>((v===2||(h?!d&&f<h[0]:W(f)+(y===0&&v===0?X(f):0)<H()))&&(i+=I-X(f)),i),0));for(const[i,f]of L){const I=X(i),V=we(g,i,f);c&&(T+=V?f:f-I)}c&&u&&T>u&&(Y(((i,f)=>{let I=0;const V=[];i.t.forEach((re,ve)=>{re!==q&&(V.push(re),ve<f&&I++)}),i.i=-1;const A=ce(V),te=A.length,Q=te/2|0,pe=te%2==0?(A[Q-1]+A[Q])/2:A[Q],me=i.o;return((i.o=pe)-me)*z(f-I,0)})(g,_(g,p()))),c=!1),w=3,J=!0;break}case 4:u!==a&&(u=a,w=3);break;case 5:a[1]?(Y(se(g,a[0],!0)),v=2,w=1):(se(g,a[0]),w=1);break;case 6:E=a;break;case 7:v=1;break;case 8:h=P(a),w=1}w&&(b=1+(2147483647&b),k&&m&&(l+=m,m=0),O.forEach(([L,i])=>{w&L&&i(J)}))}}},Z=setTimeout,U=(e,t)=>t&&fe()?-e:e,Le=(e,t,r,n,s,c)=>{const d=Date.now;let b=0,u=!1,E=!1,x=!1,l=!1;const m=(()=>{let R;const T=()=>{R!=K&&clearTimeout(R)},g=()=>{T(),R=Z(()=>{R=K,(()=>{if(u||E)return u=!1,void m();x=!1,e.J(2)})()},150)};return g.A=T,g})(),S=()=>{b=d(),x&&(l=!0),e.J(1,n()),m()},y=R=>{if(u||!e.H()||R.ctrlKey)return;const T=d()-b;150>T&&50<T&&(r?R.deltaX:R.deltaY)&&(u=!0)},v=()=>{E=!0,x=l=!1},h=()=>{E=!1,de()&&(x=!0)};return t.addEventListener("scroll",S),t.addEventListener("wheel",y,{passive:!0}),t.addEventListener("touchstart",v,{passive:!0}),t.addEventListener("touchend",h,{passive:!0}),{L:()=>{t.removeEventListener("scroll",S),t.removeEventListener("wheel",y),t.removeEventListener("touchstart",v),t.removeEventListener("touchend",h),m.A()},D:()=>{const[R,T]=e.O();R&&(s(U(R,r),T,l),l=!1,T&&e.p()>e.h()&&e.J(1,n()))}}},Me=(e,t)=>{let r,n,s;const[c,d,b]=oe(),u=t?"scrollLeft":"scrollTop",E=t?"overflowX":"overflowY",x=async(l,m)=>{await c,s&&s();const S=()=>{const[y,v,h]=oe();return s=h,Se(e)&&Z(h,150),[y,e.B(2,()=>{v()})]};if(m&&Re()){for(;e.J(8,l()),e.k();){const[y,v]=S();try{await y}catch{return}finally{v()}}r.scrollTo({[t?"left":"top"]:U(l(),t),behavior:"smooth"})}else for(;;){const[y,v]=S();try{r[u]=U(l(),t),e.J(7),await y}catch{return}finally{v()}}};return{P(l){r=l,n=Le(e,l,t,()=>U(l[u],t),(m,S,y)=>{if(y){const v=l.style,h=v[E];v[E]="hidden",Z(()=>{v[E]=h})}S?(l[u]=e.M()+m,s&&s()):l[u]+=m}),d()},V(){n&&n.L(),b()},X(l){x(()=>l)},Y(l){l+=e.M(),x(()=>l)},j(l,{align:m,smooth:S,offset:y=0}={}){if(l=ie(l,0,e.C()-1),m==="nearest"){const v=e.R(l),h=e.M();if(v<h)m="start";else{if(!(v+e.T(l)>h+e.p()))return;m="end"}}x(()=>y+e.W()+e.R(l)+(m==="end"?e.T(l)-e.p():m==="center"?(e.T(l)-e.p())/2:0),S)},q:()=>{n&&n.D()}}},Ie=e=>{let t;return{U(r){(t||(t=new(Ee(be(r))).ResizeObserver(e))).observe(r)},F(r){t.unobserve(r)},L(){t&&t.disconnect()}}},je=(e,t)=>{let r;const n=t?"width":"height",s=new WeakMap,c=Ie(d=>{const b=[];for(const{target:u,contentRect:E}of d)if(u.offsetParent)if(u===r)e.J(4,E[n]);else{const x=s.get(u);x!=K&&b.push([x,E[n]])}b.length&&e.J(3,b)});return{G(d){c.U(r=d)},K:(d,b)=>(s.set(d,b),c.U(d),()=>{s.delete(d),c.F(d)}),V:c.L}},N=ue?M.useLayoutEffect:M.useEffect,j="current",he=(e,t)=>{if(Array.isArray(e))for(const r of e)he(r,t);else e==null||typeof e=="boolean"||t.push(e)},ze=(e,t)=>{const r=e.key;return r??"_"+t},Ce=e=>{const t=M.useRef(null);return t[j]||(t[j]=e())},le=e=>{const t=M.useRef(e);return N(()=>{t[j]=e},[e]),t},Je=M.memo(({ee:e,te:t,oe:r,ne:n,re:s,ie:c,se:d,le:b})=>{const u=M.useRef(null);N(()=>t(u[j],r),[r]);const E=M.useMemo(()=>{const x={contain:"layout style",position:s&&b?void 0:"absolute",[d?"height":"width"]:"100%",[d?"top":"left"]:0,[d?fe()?"right":"left":"top"]:n,visibility:!s||b?"visible":"hidden"};return d&&(x.display="inline-flex"),x},[n,s,b,d]);return D.jsx(c,typeof c=="string"?{ref:u,style:E,children:e}:{ref:u,style:E,index:r,children:e})}),Ae=(e,t)=>M.useMemo(()=>{if(typeof e=="function")return[e,t||0];const r=(n=>{const s=[];return he(n,s),s})(e);return[n=>r[n],r.length]},[e,t]),Be=M.forwardRef(({children:e,count:t,overscan:r,itemSize:n,shift:s,horizontal:c,keepMounted:d,cache:b,startMargin:u=0,ssrCount:E,as:x="div",item:l="div",scrollRef:m,onScroll:S,onScrollEnd:y},v)=>{const[h,R]=Ae(e,t),T=M.useRef(null),g=M.useRef(!!E),O=le(S),H=le(y),[p,P,C,W]=Ce(()=>{const i=!!c,f=Te(R,n,r,E,b,!n);return[f,je(f,i),Me(f,i),i]});R!==p.C()&&p.J(5,[R,s]),u!==p.W()&&p.J(6,u);const[X,Y]=M.useReducer(p.v,void 0,p.v),[o,a]=p._(),k=p.H(),J=p.h(),w=[],L=i=>{const f=h(i);return D.jsx(Je,{te:P.K,oe:i,ne:p.R(i),re:p.I(i),ie:l,ee:f,se:W,le:g[j]},ze(f,i))};N(()=>{g[j]=!1;const i=p.B(1,A=>{A?ye.flushSync(Y):Y()}),f=p.B(4,()=>{O[j]&&O[j](p.M())}),I=p.B(8,()=>{H[j]&&H[j]()}),V=A=>{P.G(A),C.P(A)};return m?xe(()=>{m[j]&&V(m[j])}):V(T[j].parentElement),()=>{i(),f(),I(),P.V(),C.V()}},[]),N(()=>{C.q()},[X]),M.useImperativeHandle(v,()=>({get cache(){return p.m()},get scrollOffset(){return p.M()},get scrollSize(){return ke(p)},get viewportSize(){return p.p()},findStartIndex:p.S,findEndIndex:p.$,getItemOffset:p.R,getItemSize:p.T,scrollToIndex:C.j,scrollTo:C.X,scrollBy:C.Y}),[]);for(let i=o,f=a;i<=f;i++)w.push(L(i));if(d){const i=[],f=[];ce(d).forEach(I=>{I<o&&i.push(L(I)),I>a&&f.push(L(I))}),w.unshift(...i),w.push(...f)}return D.jsx(x,{ref:T,style:{contain:"strict",overflowAnchor:"none",overflow:"clip",flex:"none",position:"relative",width:W?J:"100%",height:W?"100%":J,pointerEvents:k?"none":void 0},children:w})}),De=M.forwardRef(({children:e,count:t,overscan:r,itemSize:n,shift:s,horizontal:c,keepMounted:d,reverse:b,cache:u,ssrCount:E,item:x,onScroll:l,onScrollEnd:m,style:S,...y},v)=>{const h=M.useRef(null),R=b&&!c;let T=D.jsx(Be,{ref:v,scrollRef:R?h:void 0,count:t,overscan:r,itemSize:n,shift:s,horizontal:c,keepMounted:d,cache:u,ssrCount:E,item:x,onScroll:l,onScrollEnd:m,children:e});return R&&(T=D.jsx("div",{style:{display:"flex",flexDirection:"column",justifyContent:"flex-end",minHeight:"100%"},children:T})),D.jsx("div",{ref:h,...y,style:{display:c?"inline-block":"block",[c?"overflowX":"overflowY"]:"auto",contain:"strict",width:"100%",height:"100%",...S},children:T})}),He=M.memo(({count:e,Component:t,handle:r})=>{const n=M.useRef(null);return M.useImperativeHandle(r,()=>({scrollToIndex:s=>{var c;(c=n.current)==null||c.scrollToIndex(s)}})),D.jsx(De,{ref:n,children:Array.from({length:e}).map((s,c)=>D.jsx(t,{index:c},c))})});He.__docgenInfo={description:"",methods:[{name:"scrollToIndex",docblock:null,modifiers:[],params:[{name:"i",optional:!1,type:null}],returns:null}],displayName:"VirtuaList",props:{count:{required:!0,tsType:{name:"number"},description:""},Component:{required:!0,tsType:{name:"SimpleItem"},description:""},handle:{required:!1,tsType:{name:"Ref",elements:[{name:"signature",type:"object",raw:"{ scrollToIndex: (index: number) => void }",signature:{properties:[{key:"scrollToIndex",value:{name:"signature",type:"function",raw:"(index: number) => void",signature:{arguments:[{type:{name:"number"},name:"index"}],return:{name:"void"}},required:!0}}]}}],raw:"Ref<ListHandle>"},description:""}}};export{He as V};

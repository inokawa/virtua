import{j as B}from"./jsx-runtime-DR9Q75dM.js";import{r as T}from"./index-DRjF_FHU.js";import{r as me}from"./index-uWwxbAOW.js";const z=null,{min:q,max:D,abs:ne,floor:pe}=Math,ve=Array.isArray,te=setTimeout,ie=(e,t,r)=>q(r,D(t,e)),le=e=>[...e].sort((t,r)=>t-r),ce=typeof queueMicrotask=="function"?queueMicrotask:e=>{Promise.resolve().then(e)},re=e=>{let t,r;return(...n)=>(t||(t=!0,r=e(...n)),r)},X=-1,K=(e,t,r)=>{const n=r?"unshift":"push";for(let s=0;s<t;s++)e[n](X);return e},Q=(e,t)=>{const r=e.t[t];return r===X?e.o:r},ye=(e,t,r)=>{const n=e.t[t]===X;return e.t[t]=r,e.i=q(t,e.i),n},U=(e,t)=>{if(!e.l)return 0;if(e.i>=t)return e.u[t];e.i<0&&(e.u[0]=0,e.i=0);let r=e.i,n=e.u[r];for(;r<t;)n+=Q(e,r),e.u[++r]=n;return e.i=t,n},F=(e,t,r=0,n=e.l-1)=>{for(;r<=n;){const s=pe((r+n)/2),i=U(e,s);if(i<=t){if(i+Q(e,s)>t)return s;r=s+1}else n=s-1}return ie(r,0,e.l-1)},oe=(e,t,r)=>{const n=t-e.l;return e.i=r?-1:q(t-1,e.i),e.l=t,n>0?(K(e.u,n),K(e.t,n,r),e.o*n):(e.u.splice(n),(r?e.t.splice(0,-n):e.t.splice(n)).reduce((s,i)=>s-(i===X?e.o:i),0))},ue=typeof window<"u",ae=()=>document.documentElement,ge=e=>e.ownerDocument,we=e=>e.defaultView,fe=re(()=>!!ue&&getComputedStyle(ae()).direction==="rtl"),de=re(()=>/iP(hone|od|ad)/.test(navigator.userAgent)),xe=re(()=>"scrollBehavior"in ae().style),be=e=>D(e.h(),e._()),ke=(e,t,r,n,s)=>(n!==1&&(e-=D(0,r)),n!==2&&(t+=D(0,r)),[D(e,0),q(t,s-1)]),Re=(e,t=40,r=0,n,s=!1)=>{let i=!!r,c=[],u=0,o=0,a=0,h=0,d=0,f=0,w=0,M=0,C=0,S=i?[0,D(r-1,0)]:z,p=[0,0],k=0;const v=((l,m,g)=>({o:g?g[1]:m,t:g&&g[0]?K(g[0].slice(0,q(l,g[0].length)),D(0,l-g[0].length)):K([],l),l,i:-1,u:K([],l)}))(e,t,n),Y=new Set,P=()=>a-o,G=l=>((m,g,H,R)=>{if(R=q(R,m.l-1),U(m,R)<=g){const j=F(m,g+H,R);return[F(m,g,R,j),j]}{const j=F(m,g,void 0,R);return[j,F(m,g+H,j)]}})(v,l,u,p[0]),y=()=>(l=>l.l?U(l,l.l-1)+Q(l,l.l-1):0)(v),J=l=>U(v,l)-f,A=l=>Q(v,l),V=l=>{l&&(de()&&M!==0?f+=l:(d+=l,h++))};return{p:()=>c,v:()=>(l=>[l.t.slice(),l.o])(v),m:()=>w?p:(p=G(D(0,P()+f+d)),S?[q(p[0],S[0]),D(p[1],S[1])]:p),S:l=>v.t[l]===X,I:()=>!!S&&v.t.slice(D(0,S[0]-1),q(v.l-1,S[1]+1)+1).includes(X),k:J,R:A,C:()=>v.l,T:()=>a,M:()=>M,_:()=>u,H:()=>o,h:y,W:()=>h,J:()=>(w=d,d=0,[w,C===2||P()+u>=y()]),B(l,m){const g=[l,m];return Y.add(g),()=>{Y.delete(g)}},O(l,m){let g,H,R=0;switch(l){case 1:{const j=w;w=0;const x=m-a,E=ne(x);j&&E<ne(j)+1||C!==0||(M=x<0?2:1),i&&(S=z,i=!1),a=m,R=4;const O=P();O>=-u&&O<=y()&&(R+=1,H=E>u);break}case 2:R=8,M!==0&&(g=!0,R+=1),M=0,C=0,S=z;break;case 3:{const j=m.filter(([x,E])=>v.t[x]!==E);if(!j.length)break;V(j.reduce((x,[E,O])=>((C===2||(S?E<S[0]:J(E)+(M===0&&C===0?A(E):0)<P()))&&(x+=O-A(E)),x),0));for(const[x,E]of j){const O=A(x),W=ye(v,x,E);s&&(k+=W?E:E-O)}s&&u&&k>u&&(V(((x,E)=>{let O=0;const W=x.t.filter((L,I)=>{const $=L!==X;return $&&I<E&&O++,$}),b=x.o;return x.i=-1,((x.o=(L=>{const I=le(L),$=L.length/2|0;return I.length%2==0?(I[$-1]+I[$])/2:I[$]})(W))-b)*D(E-O,0)})(v,p[0])),s=!1),R=3,H=!0;break}case 4:u!==m&&(u=m,R=3);break;case 5:m[1]?(V(oe(v,m[0],!0)),C=2,R=1):oe(v,m[0]);break;case 6:o=m;break;case 7:C=1;break;case 8:S=G(m),R=1}R&&(c=[],g&&f&&(d+=f,f=0,h++),Y.forEach(([j,x])=>{R&j&&x(H)}))}}},ee=ue?T.useLayoutEffect:T.useEffect,Z=(e,t)=>t&&fe()?-e:e,Ee=(e,t,r,n,s,i)=>{const c=Date.now;let u=0,o=!1,a=!1,h=!1,d=!1;const f=(()=>{let p;const k=()=>{p!=z&&clearTimeout(p)},v=()=>{k(),p=te(()=>{p=z,(()=>{if(o||a)return o=!1,void f();h=!1,e.O(2)})()},150)};return v.L=k,v})(),w=()=>{u=c(),h&&(d=!0),e.O(1,n()),f()},M=p=>{if(o||e.M()===0||p.ctrlKey)return;const k=c()-u;150>k&&50<k&&(r?p.deltaX:p.deltaY)&&(o=!0)},C=()=>{a=!0,h=d=!1},S=()=>{a=!1,de()&&(h=!0)};return t.addEventListener("scroll",w),t.addEventListener("wheel",M,{passive:!0}),t.addEventListener("touchstart",C,{passive:!0}),t.addEventListener("touchend",S,{passive:!0}),{$:()=>{t.removeEventListener("scroll",w),t.removeEventListener("wheel",M),t.removeEventListener("touchstart",C),t.removeEventListener("touchend",S),f.L()},A:()=>{const[p,k]=e.J();p&&(s(Z(p,r),k,d),d=!1,k&&e._()>e.h()&&e.O(1,n()))}}},Te=(e,t)=>{let r,n,s;const i=t?"scrollLeft":"scrollTop",c=t?"overflowX":"overflowY",u=async(o,a)=>{if(!r)return void ce(()=>u(o,a));s&&s();const h=()=>{let d;return[new Promise((f,w)=>{d=f,s=w,(M=>!!M._())(e)&&te(w,150)}),e.B(2,()=>{d&&d()})]};if(a&&xe()){for(;e.O(8,o()),e.I();){const[d,f]=h();try{await d}catch{return}finally{f()}}r.scrollTo({[t?"left":"top"]:Z(o(),t),behavior:"smooth"})}else for(;;){const[d,f]=h();try{r[i]=Z(o(),t),e.O(7),await d}catch{return}finally{f()}}};return{D(o){r=o,n=Ee(e,o,t,()=>Z(o[i],t),(a,h,d)=>{if(d){const f=o.style,w=f[c];f[c]="hidden",te(()=>{f[c]=w})}h?(o[i]=e.T()+a,s&&s()):o[i]+=a})},$(){n&&n.$()},P(o){u(()=>o)},V(o){o+=e.T(),u(()=>o)},X(o,{align:a,smooth:h,offset:d=0}={}){if(o=ie(o,0,e.C()-1),a==="nearest"){const f=e.k(o),w=e.T();if(f<w)a="start";else{if(!(f+e.R(o)>w+e._()))return;a="end"}}u(()=>d+e.H()+e.k(o)+(a==="end"?e.R(o)-e._():a==="center"?(e.R(o)-e._())/2:0),h)},A:()=>{n&&n.A()}}},_="current",he=(e,t)=>{if(ve(e))for(const r of e)he(r,t);else e==z||typeof e=="boolean"||t.push(e)},Se=(e,t)=>{const r=e.key;return r!=z?r:"_"+t},Le=e=>{const t=T.useRef();return t[_]||(t[_]=e())},se=e=>{const t=T.useRef(e);return ee(()=>{t[_]=e},[e]),t},je=e=>{let t;return{D(r){(t||(t=new(we(ge(r))).ResizeObserver(e))).observe(r)},Y(r){t.unobserve(r)},$(){t&&t.disconnect()}}},Me=(e,t)=>{let r;const n=t?"width":"height",s=new WeakMap,i=je(c=>{const u=[];for(const{target:o,contentRect:a}of c)if(o.offsetParent)if(o===r)e.O(4,a[n]);else{const h=s.get(o);h!=z&&u.push([h,a[n]])}u.length&&e.O(3,u)});return{j(c){i.D(r=c)},q:(c,u)=>(s.set(c,u),i.D(c),()=>{s.delete(c),i.Y(c)}),$:i.$}},Ce=T.memo(({U:e,F:t,G:r,K:n,N:s,Z:i,ee:c,te:u})=>{const o=T.useRef(z);ee(()=>t(o[_],r),[r]);const a=T.useMemo(()=>{const h={position:s&&u?void 0:"absolute",[c?"height":"width"]:"100%",[c?"top":"left"]:0,[c?fe()?"right":"left":"top"]:n,visibility:!s||u?"visible":"hidden"};return c&&(h.display="flex"),h},[n,s,u,c]);return B.jsx(i,typeof i=="string"?{ref:o,style:a,children:e}:{ref:o,style:a,index:r,children:e})}),Ie=e=>T.useReducer(e.p,void 0,e.p)[1],Oe=(e,t)=>T.useMemo(()=>{if(typeof e=="function")return[e,t||0];const r=(n=>{const s=[];return he(n,s),s})(e);return[n=>r[n],r.length]},[e,t]),_e=T.forwardRef(({children:e,count:t,overscan:r=4,keepMounted:n,itemSize:s,shift:i,horizontal:c,cache:u,startMargin:o=0,ssrCount:a,as:h="div",item:d="div",scrollRef:f,onScroll:w,onScrollEnd:M,onRangeChange:C},S)=>{const[p,k]=Oe(e,t),v=T.useRef(z),Y=T.useRef(!!a),P=se(w),G=se(M),[y,J,A,V]=Le(()=>{const b=!!c,L=Re(k,s,a,u,!s);return[L,Me(L,b),Te(L,b),b]});k!==y.C()&&y.O(5,[k,i]),o!==y.H()&&y.O(6,o);const l=Ie(y),[m,g]=y.m(),H=y.M(),R=y.W(),j=y.h(),x=[],[E,O]=ke(m,g,r,H,k),W=b=>{const L=p(b);return B.jsx(Ce,{F:J.q,G:b,K:y.k(b),N:y.S(b),Z:d,U:L,ee:V,te:Y[_]},Se(L,b))};ee(()=>{Y[_]=!1;const b=y.B(1,N=>{N?me.flushSync(l):l()}),L=y.B(4,()=>{P[_]&&P[_](y.T())}),I=y.B(8,()=>{G[_]&&G[_]()}),$=N=>{J.j(N),A.D(N)};return f?ce(()=>$(f[_])):$(v[_].parentElement),()=>{b(),L(),I(),J.$(),A.$()}},[]),ee(()=>{A.A()},[R]),T.useEffect(()=>{C&&C(m,g)},[m,g]),T.useImperativeHandle(S,()=>({get cache(){return y.v()},get scrollOffset(){return y.T()},get scrollSize(){return be(y)},get viewportSize(){return y._()},getItemOffset:y.k,scrollToIndex:A.X,scrollTo:A.P,scrollBy:A.V}),[]);for(let b=E,L=O;b<=L;b++)x.push(W(b));if(n){const b=[],L=[];le(n).forEach(I=>{I<E&&b.push(W(I)),I>O&&L.push(W(I))}),x.unshift(...b),x.push(...L)}return B.jsx(h,{ref:v,style:{overflowAnchor:"none",flex:"none",position:"relative",visibility:"hidden",width:V?j:"100%",height:V?"100%":j,pointerEvents:H!==0?"none":void 0},children:x})}),Ae=T.forwardRef(({children:e,count:t,overscan:r,keepMounted:n,itemSize:s,shift:i,horizontal:c,reverse:u,cache:o,ssrCount:a,item:h,onScroll:d,onScrollEnd:f,onRangeChange:w,style:M,...C},S)=>{const p=T.useRef(z),k=u&&!c;let v=B.jsx(_e,{ref:S,scrollRef:k?p:void 0,count:t,overscan:r,keepMounted:n,itemSize:s,shift:i,horizontal:c,cache:o,ssrCount:a,item:h,onScroll:d,onScrollEnd:f,onRangeChange:w,children:e});return k&&(v=B.jsx("div",{style:{visibility:"hidden",display:"flex",flexDirection:"column",justifyContent:"flex-end",minHeight:"100%"},children:v})),B.jsx("div",{ref:p,...C,style:{display:c?"inline-block":"block",[c?"overflowX":"overflowY"]:"auto",contain:"strict",width:"100%",height:"100%",...M},children:v})}),De=T.memo(({count:e,Component:t,handle:r})=>{const n=T.useRef(null);return T.useImperativeHandle(r,()=>({scrollToIndex:s=>{var i;(i=n.current)==null||i.scrollToIndex(s)}})),B.jsx(Ae,{ref:n,children:Array.from({length:e}).map((s,i)=>B.jsx(t,{index:i},i))})});De.__docgenInfo={description:"",methods:[{name:"scrollToIndex",docblock:null,modifiers:[],params:[{name:"i",optional:!1,type:null}],returns:null}],displayName:"VirtuaList",props:{count:{required:!0,tsType:{name:"number"},description:""},Component:{required:!0,tsType:{name:"SimpleItem"},description:""},handle:{required:!1,tsType:{name:"Ref",elements:[{name:"signature",type:"object",raw:"{ scrollToIndex: (index: number) => void }",signature:{properties:[{key:"scrollToIndex",value:{name:"signature",type:"function",raw:"(index: number) => void",signature:{arguments:[{type:{name:"number"},name:"index"}],return:{name:"void"}},required:!0}}]}}],raw:"Ref<ListHandle>"},description:""}}};export{De as V};

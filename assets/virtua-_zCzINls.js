import{j as A}from"./jsx-runtime-BjG_zV1W.js";import{r as S}from"./iframe-DYoAIzAP.js";import{r as ye}from"./index-CDtA4WY6.js";const K=null,{min:H,max:C,abs:ne,floor:ge}=Math,ie=(e,t,r)=>H(r,C(t,e)),le=e=>[...e].sort((t,r)=>t-r),ce=typeof queueMicrotask=="function"?queueMicrotask:e=>{Promise.resolve().then(e)},ee=e=>{let t;return()=>(e&&(t=e(),e=void 0),t)},q=-1,N=(e,t,r)=>{const o=r?"unshift":"push";for(let i=0;i<t;i++)e[o](q);return e},G=(e,t)=>{const r=e.t[t];return r===q?e.o:r},xe=(e,t,r)=>{const o=e.t[t]===q;return e.t[t]=r,e.i=H(t,e.i),o},U=(e,t)=>{if(!e.l)return 0;if(e.i>=t)return e.u[t];e.i<0&&(e.u[0]=0,e.i=0);let r=e.i,o=e.u[r];for(;r<t;)o+=G(e,r),e.u[++r]=o;return e.i=t,o},_=(e,t,r=0,o=e.l-1)=>{for(;r<=o;){const i=ge((r+o)/2),l=U(e,i);if(l<=t){if(l+G(e,i)>t)return i;r=i+1}else o=i-1}return ie(r,0,e.l-1)},oe=(e,t,r)=>{const o=t-e.l;return e.i=r?-1:H(t-1,e.i),e.l=t,o>0?(N(e.u,o),N(e.t,o,r),e.o*o):(e.u.splice(o),(r?e.t.splice(0,-o):e.t.splice(o)).reduce((i,l)=>i-(l===q?e.o:l),0))},ue=typeof window<"u",ae=()=>document.documentElement,we=e=>e.ownerDocument,be=e=>e.defaultView,de=ee(()=>!!ue&&getComputedStyle(ae()).direction==="rtl"),fe=ee(()=>/iP(hone|od|ad)/.test(navigator.userAgent)),Ee=ee(()=>"scrollBehavior"in ae().style),Re=e=>C(e.h(),e.v()),ke=e=>!!e.v(),Te=(e,t=40,r=4,o=0,i,l=!1)=>{let u=!!o,y=1,n=0,d=0,p=0,v=0,h=0,w=0,L=0,M=0,R=u?[0,C(o-1,0)]:K,b=[0,0],k=0;const g=((s,a,E)=>({o:E?E[1]:a,t:E&&E[0]?N(E[0].slice(0,H(s,E[0].length)),C(0,s-E[0].length)):N([],s),l:s,i:-1,u:N([],s)}))(e,t,i),O=new Set,B=()=>p-d,m=()=>B()+h+v,D=s=>((a,E,z,x)=>{if(x=H(x,a.l-1),U(a,x)<=E){const T=_(a,E+z,x);return[_(a,E,x,T),T]}{const T=_(a,E,void 0,x);return[T,_(a,E+z,T)]}})(g,s,n,b[0]),J=()=>(s=>s.l?U(s,s.l-1)+G(s,s.l-1):0)(g),X=s=>U(g,s)-h,W=s=>G(g,s),Y=s=>{s&&(fe()&&L!==0?h+=s:v+=s)};return{p:()=>y,m:()=>(s=>[s.t.slice(),s.o])(g),_:()=>{let s,a;return w?[s,a]=b:([s,a]=b=D(C(0,m())),R&&(s=H(s,R[0]),a=C(a,R[1]))),L!==1&&(s-=C(0,r)),L!==2&&(a+=C(0,r)),[C(s,0),H(a,g.l-1)]},S:()=>_(g,m()),$:()=>_(g,m()+n),I:s=>g.t[s]===q,k:()=>!!R&&g.t.slice(C(0,R[0]-1),H(g.l-1,R[1]+1)+1).includes(q),R:X,T:W,M:()=>g.l,C:()=>p,H:()=>L!==0,v:()=>n,W:()=>d,h:J,O:()=>(w=v,v=0,[w,M===2||B()+n>=J()]),B:(s,a)=>{const E=[s,a];return O.add(E),()=>{O.delete(E)}},J:(s,a)=>{let E,z,x=0;switch(s){case 1:{const T=w;w=0;const c=a-p,f=ne(c);T&&f<ne(T)+1||M!==0||(L=c<0?2:1),u&&(R=K,u=!1),p=a,x=4;const I=B();I>=-n&&I<=J()&&(x+=1,z=f>n);break}case 2:x=8,L!==0&&(E=!0,x+=1),L=0,M=0,R=K;break;case 3:{const T=a.filter(([c,f])=>g.t[c]!==f);if(!T.length)break;Y(T.reduce((c,[f,I])=>((M===2||(R?!u&&f<R[0]:X(f)+(L===0&&M===0?W(f):0)<B()))&&(c+=I-W(f)),c),0));for(const[c,f]of T){const I=W(c),V=xe(g,c,f);l&&(k+=V?f:f-I)}l&&n&&k>n&&(Y(((c,f)=>{let I=0;const V=[];c.t.forEach((re,ve)=>{re!==q&&(V.push(re),ve<f&&I++)}),c.i=-1;const P=le(V),te=P.length,$=te/2|0,me=te%2==0?(P[$-1]+P[$])/2:P[$],pe=c.o;return((c.o=me)-pe)*C(f-I,0)})(g,_(g,m()))),l=!1),x=3,z=!0;break}case 4:n!==a&&(n=a,x=3);break;case 5:a[1]?(Y(oe(g,a[0],!0)),M=2,x=1):(oe(g,a[0]),x=1);break;case 6:d=a;break;case 7:M=1;break;case 8:R=D(a),x=1}x&&(y=1+(2147483647&y),E&&h&&(v+=h,h=0),O.forEach(([T,c])=>{x&T&&c(z)}))}}},Q=setTimeout,F=(e,t)=>t&&de()?-e:e,Se=(e,t,r,o,i,l)=>{const u=Date.now;let y=0,n=!1,d=!1,p=!1,v=!1;const h=(()=>{let b;const k=()=>{b!=K&&clearTimeout(b)},g=()=>{k(),b=Q(()=>{b=K,(()=>{if(n||d)return n=!1,void h();p=!1,e.J(2)})()},150)};return g.L=k,g})(),w=()=>{y=u(),p&&(v=!0),e.J(1,o()),h()},L=b=>{if(n||!e.H()||b.ctrlKey)return;const k=u()-y;150>k&&50<k&&(r?b.deltaX:b.deltaY)&&(n=!0)},M=()=>{d=!0,p=v=!1},R=()=>{d=!1,fe()&&(p=!0)};return t.addEventListener("scroll",w),t.addEventListener("wheel",L,{passive:!0}),t.addEventListener("touchstart",M,{passive:!0}),t.addEventListener("touchend",R,{passive:!0}),{P:()=>{t.removeEventListener("scroll",w),t.removeEventListener("wheel",L),t.removeEventListener("touchstart",M),t.removeEventListener("touchend",R),h.L()},A:()=>{const[b,k]=e.O();b&&(i(F(b,r),k,v),v=!1,k&&e.v()>e.h()&&e.J(1,o()))}}},Ie=(e,t)=>{let r,o,i;const l=t?"scrollLeft":"scrollTop",u=t?"overflowX":"overflowY",y=async(n,d)=>{if(!r)return void ce(()=>y(n,d));i&&i();const p=()=>{let v;return[new Promise((h,w)=>{v=h,i=w,ke(e)&&Q(w,150)}),e.B(2,()=>{v&&v()})]};if(d&&Ee()){for(;e.J(8,n()),e.k();){const[v,h]=p();try{await v}catch{return}finally{h()}}r.scrollTo({[t?"left":"top"]:F(n(),t),behavior:"smooth"})}else for(;;){const[v,h]=p();try{r[l]=F(n(),t),e.J(7),await v}catch{return}finally{h()}}};return{D(n){r=n,o=Se(e,n,t,()=>F(n[l],t),(d,p,v)=>{if(v){const h=n.style,w=h[u];h[u]="hidden",Q(()=>{h[u]=w})}p?(n[l]=e.C()+d,i&&i()):n[l]+=d})},V(){o&&o.P()},X(n){y(()=>n)},Y(n){n+=e.C(),y(()=>n)},j(n,{align:d,smooth:p,offset:v=0}={}){if(n=ie(n,0,e.M()-1),d==="nearest"){const h=e.R(n),w=e.C();if(h<w)d="start";else{if(!(h+e.T(n)>w+e.v()))return;d="end"}}y(()=>v+e.W()+e.R(n)+(d==="end"?e.T(n)-e.v():d==="center"?(e.T(n)-e.v())/2:0),p)},q:()=>{o&&o.A()}}},Le=e=>{let t;return{U(r){(t||(t=new(be(we(r))).ResizeObserver(e))).observe(r)},F(r){t.unobserve(r)},P(){t&&t.disconnect()}}},Me=(e,t)=>{let r;const o=t?"width":"height",i=new WeakMap,l=Le(u=>{const y=[];for(const{target:n,contentRect:d}of u)if(n.offsetParent)if(n===r)e.J(4,d[o]);else{const p=i.get(n);p!=K&&y.push([p,d[o]])}y.length&&e.J(3,y)});return{G(u){l.U(r=u)},K:(u,y)=>(i.set(u,y),l.U(u),()=>{i.delete(u),l.F(u)}),V:l.P}},Z=ue?S.useLayoutEffect:S.useEffect,j="current",he=(e,t)=>{if(Array.isArray(e))for(const r of e)he(r,t);else e==null||typeof e=="boolean"||t.push(e)},je=(e,t)=>{const r=e.key;return r??"_"+t},Ce=e=>{const t=S.useRef(null);return t[j]||(t[j]=e())},se=e=>{const t=S.useRef(e);return Z(()=>{t[j]=e},[e]),t},Je=S.memo(({N:e,Z:t,ee:r,te:o,ne:i,oe:l,re:u,ie:y})=>{const n=S.useRef(null);Z(()=>t(n[j],r),[r]);const d=S.useMemo(()=>{const p={position:i&&y?void 0:"absolute",[u?"height":"width"]:"100%",[u?"top":"left"]:0,[u?de()?"right":"left":"top"]:o,visibility:!i||y?"visible":"hidden"};return u&&(p.display="flex"),p},[o,i,y,u]);return A.jsx(l,typeof l=="string"?{ref:n,style:d,children:e}:{ref:n,style:d,index:r,children:e})}),ze=(e,t)=>S.useMemo(()=>{if(typeof e=="function")return[e,t||0];const r=(o=>{const i=[];return he(o,i),i})(e);return[o=>r[o],r.length]},[e,t]),Pe=S.forwardRef(({children:e,count:t,overscan:r,itemSize:o,shift:i,horizontal:l,keepMounted:u,cache:y,startMargin:n=0,ssrCount:d,as:p="div",item:v="div",scrollRef:h,onScroll:w,onScrollEnd:L},M)=>{const[R,b]=ze(e,t),k=S.useRef(null),g=S.useRef(!!d),O=se(w),B=se(L),[m,D,J,X]=Ce(()=>{const c=!!l,f=Te(b,o,r,d,y,!o);return[f,Me(f,c),Ie(f,c),c]});b!==m.M()&&m.J(5,[b,i]),n!==m.W()&&m.J(6,n);const[W,Y]=S.useReducer(m.p,void 0,m.p),[s,a]=m._(),E=m.H(),z=m.h(),x=[],T=c=>{const f=R(c);return A.jsx(Je,{Z:D.K,ee:c,te:m.R(c),ne:m.I(c),oe:v,N:f,re:X,ie:g[j]},je(f,c))};Z(()=>{g[j]=!1;const c=m.B(1,P=>{P?ye.flushSync(Y):Y()}),f=m.B(4,()=>{O[j]&&O[j](m.C())}),I=m.B(8,()=>{B[j]&&B[j]()}),V=P=>{D.G(P),J.D(P)};return h?ce(()=>V(h[j])):V(k[j].parentElement),()=>{c(),f(),I(),D.V(),J.V()}},[]),Z(()=>{J.q()},[W]),S.useImperativeHandle(M,()=>({get cache(){return m.m()},get scrollOffset(){return m.C()},get scrollSize(){return Re(m)},get viewportSize(){return m.v()},findStartIndex:m.S,findEndIndex:m.$,getItemOffset:m.R,getItemSize:m.T,scrollToIndex:J.j,scrollTo:J.X,scrollBy:J.Y}),[]);for(let c=s,f=a;c<=f;c++)x.push(T(c));if(u){const c=[],f=[];le(u).forEach(I=>{I<s&&c.push(T(I)),I>a&&f.push(T(I))}),x.unshift(...c),x.push(...f)}return A.jsx(p,{ref:k,style:{overflowAnchor:"none",flex:"none",position:"relative",visibility:"hidden",overflow:"hidden",width:X?z:"100%",height:X?"100%":z,pointerEvents:E?"none":void 0},children:x})}),He=S.forwardRef(({children:e,count:t,overscan:r,itemSize:o,shift:i,horizontal:l,keepMounted:u,reverse:y,cache:n,ssrCount:d,item:p,onScroll:v,onScrollEnd:h,style:w,...L},M)=>{const R=S.useRef(null),b=y&&!l;let k=A.jsx(Pe,{ref:M,scrollRef:b?R:void 0,count:t,overscan:r,itemSize:o,shift:i,horizontal:l,keepMounted:u,cache:n,ssrCount:d,item:p,onScroll:v,onScrollEnd:h,children:e});return b&&(k=A.jsx("div",{style:{visibility:"hidden",display:"flex",flexDirection:"column",justifyContent:"flex-end",minHeight:"100%"},children:k})),A.jsx("div",{ref:R,...L,style:{display:l?"inline-block":"block",[l?"overflowX":"overflowY"]:"auto",contain:"strict",width:"100%",height:"100%",...w},children:k})}),Ae=S.memo(({count:e,Component:t,handle:r})=>{const o=S.useRef(null);return S.useImperativeHandle(r,()=>({scrollToIndex:i=>{var l;(l=o.current)==null||l.scrollToIndex(i)}})),A.jsx(He,{ref:o,children:Array.from({length:e}).map((i,l)=>A.jsx(t,{index:l},l))})});Ae.__docgenInfo={description:"",methods:[{name:"scrollToIndex",docblock:null,modifiers:[],params:[{name:"i",optional:!1,type:null}],returns:null}],displayName:"VirtuaList",props:{count:{required:!0,tsType:{name:"number"},description:""},Component:{required:!0,tsType:{name:"SimpleItem"},description:""},handle:{required:!1,tsType:{name:"Ref",elements:[{name:"signature",type:"object",raw:"{ scrollToIndex: (index: number) => void }",signature:{properties:[{key:"scrollToIndex",value:{name:"signature",type:"function",raw:"(index: number) => void",signature:{arguments:[{type:{name:"number"},name:"index"}],return:{name:"void"}},required:!0}}]}}],raw:"Ref<ListHandle>"},description:""}}};export{Ae as V};

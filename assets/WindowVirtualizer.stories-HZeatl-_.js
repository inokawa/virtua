import{j as e}from"./jsx-runtime-D_zvdyIk.js";import{r as s}from"./iframe-BoI5bJ6Z.js";import{S as q,d as P}from"./common-BqtzafjA.js";import{a as A,u as W,A as D,b as V,r as v,U as J,c as U,d as M,l as B,e as G,n as X,o as Y}from"./useLatestRef-CzhV_rsI.js";import{u as F,L as K}from"./useChildren-GZDHuoaX.js";import{r as Q}from"./index-M_VcXNYe.js";import"./index-exaFy-fc.js";const f=s.forwardRef(({children:a,data:i,bufferSize:r,itemSize:o,shift:n,horizontal:d,cache:u,ssrCount:m,as:c="div",item:p="div",onScroll:g,onScrollEnd:x},y)=>{c=c;const[j,t]=F(a,i),I=s.useRef(null),T=A(g),w=A(x),R=s.useRef(!!m),[l,k,S,z]=W(()=>{const h=!!d,b=G(t,o,m,u,!o);return[b,X(b,h),Y(b,h),h]});t!==l.$getItemsLength()&&l.$update(D,[t,n]);const[N,E]=s.useReducer(l.$getStateVersion,void 0,l.$getStateVersion),O=l.$isScrolling(),L=l.$getTotalSize(),H=S.$isNegative(),_=[];V(()=>{R[v]=!1,l.$subscribe(J,b=>{b?Q.flushSync(E):E()}),l.$subscribe(U,()=>{T[v]&&T[v]()}),l.$subscribe(M,()=>{w[v]&&w[v]()});const h=I[v];return k.$observeRoot(h),S.$observe(h),()=>{l.$dispose(),k.$dispose(),S.$dispose()}},[]),V(()=>{S.$fixScrollJump()},[N]),s.useImperativeHandle(y,()=>({get cache(){return l.$getCacheSnapshot()},get scrollOffset(){return l.$getScrollOffset()},get viewportSize(){return l.$getViewportSize()},findItemIndex:l.$findItemIndex,getItemOffset:l.$getItemOffset,getItemSize:l.$getItemSize,scrollToIndex:S.$scrollToIndex}),[]);for(let[h,b]=l.$getRange(r);h<=b;h++){const $=j(h);_.push(e.jsx(K,{_resizer:k.$observeItem,_index:h,_offset:l.$getItemOffset(h,H),_hide:l.$isUnmeasuredItem(h),_as:p,_children:$,_isHorizontal:z,_isSSR:R[v]},B($,h)))}return e.jsx(c,{ref:I,style:{contain:"size style",overflowAnchor:"none",flex:"none",position:"relative",width:z?L:"100%",height:z?"100%":L,pointerEvents:O?"none":void 0},children:_})});f.__docgenInfo={description:"{@link Virtualizer} controlled by the window scrolling. See {@link WindowVirtualizerProps} and {@link WindowVirtualizerHandle}.",methods:[{name:"cache",docblock:null,modifiers:["get"],params:[],returns:null},{name:"scrollOffset",docblock:null,modifiers:["get"],params:[],returns:null},{name:"viewportSize",docblock:null,modifiers:["get"],params:[],returns:null}],displayName:"WindowVirtualizer",props:{children:{required:!0,tsType:{name:"union",raw:"ReactNode | ((data: T, index: number) => ReactElement)",elements:[{name:"ReactNode"},{name:"unknown"}]},description:`Elements rendered by this component.

You can also pass a function and set {@link WindowVirtualizerProps.data} to create elements lazily.`},data:{required:!1,tsType:{name:"ArrayLike",elements:[{name:"T"}],raw:"ArrayLike<T>"},description:"The data items rendered by this component. If you set a function to {@link WindowVirtualizerProps.children}, you have to set this prop."},bufferSize:{required:!1,tsType:{name:"number"},description:`Extra item space in pixels to render before/after the viewport. The minimum value is 0. Lower value will give better performance but you can increase to avoid showing blank items in fast scrolling.
@defaultValue 200`},itemSize:{required:!1,tsType:{name:"number"},description:`Item size hint for unmeasured items in pixels. It will help to reduce scroll jump when items are measured if used properly.

- If not set, initial item sizes will be automatically estimated from measured sizes. This is recommended for most cases.
- If set, you can opt out estimation and use the value as initial item size.`},shift:{required:!1,tsType:{name:"boolean"},description:"While true is set, scroll position will be maintained from the end not usual start when items are added to/removed from start. It's recommended to set false if you add to/remove from mid/end of the list because it can cause unexpected behavior. This prop is useful for reverse infinite scrolling."},horizontal:{required:!1,tsType:{name:"boolean"},description:"If true, rendered as a horizontally scrollable list. Otherwise rendered as a vertically scrollable list."},cache:{required:!1,tsType:{name:"CacheSnapshot"},description:`You can restore cache by passing a {@link CacheSnapshot} on mount. This is useful when you want to restore scroll position after navigation. The snapshot can be obtained from {@link WindowVirtualizerHandle.cache}.

**The length of items should be the same as when you take the snapshot, otherwise restoration may not work as expected.**`},ssrCount:{required:!1,tsType:{name:"number"},description:"A prop for SSR. If set, the specified amount of items will be mounted in the initial rendering regardless of the container size until hydrated. The minimum value is 0."},as:{required:!1,tsType:{name:"union",raw:"keyof JSX.IntrinsicElements | CustomContainerComponent",elements:[{name:"JSX.IntrinsicElements"},{name:"ComponentType",elements:[{name:"CustomContainerComponentProps"}],raw:"ComponentType<CustomContainerComponentProps>"}]},description:`Component or element type for container element.
@defaultValue "div"`,defaultValue:{value:'"div"',computed:!1}},item:{required:!1,tsType:{name:"union",raw:"keyof JSX.IntrinsicElements | CustomItemComponent",elements:[{name:"JSX.IntrinsicElements"},{name:"ComponentType",elements:[{name:"CustomItemComponentProps"}],raw:"ComponentType<CustomItemComponentProps>"}]},description:`Component or element type for item element. This component will get {@link CustomItemComponentProps} as props.
@defaultValue "div"`,defaultValue:{value:'"div"',computed:!1}},onScroll:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Callback invoked whenever scroll offset changes."},onScrollEnd:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Callback invoked when scrolling stops."}}};const C=a=>{const i=[20,40,80,77];return Array.from({length:a}).map((r,o)=>e.jsx("div",{style:{height:i[o%4],borderBottom:"solid 1px #ccc",background:"#fff"},children:o},o))},Z=a=>Array.from({length:a}).map((i,r)=>e.jsxs("div",{style:{width:r%3===0?100:60,borderRight:"solid 1px #ccc",background:"#fff"},children:["Column ",r]},r)),ae={component:f},ce={render:()=>e.jsx("div",{style:{padding:"200px 100px"},children:e.jsx("div",{style:{border:"solid 1px gray"},children:e.jsx(f,{children:C(1e3)})})})},de={render:()=>e.jsx("div",{style:{padding:"100px 200px"},children:e.jsx("div",{style:{display:"inline-block",border:"solid 1px gray",height:400},children:e.jsx(f,{horizontal:!0,children:Z(1e3)})})})},ue={render:()=>e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("div",{style:{background:"white",height:60,marginBottom:40},children:"header"}),e.jsxs("div",{style:{display:"flex",flexDirection:"row"},children:[e.jsx("div",{style:{flex:1,display:"flex",paddingTop:600,margin:10},children:e.jsx(f,{children:C(1e3)})}),e.jsx("div",{style:{flex:3,margin:10},children:e.jsx(f,{children:Array.from({length:1e3}).map((a,i)=>e.jsx("div",{style:{height:200,borderRadius:8,margin:16,background:"#fff"},children:i},i))})}),e.jsx("div",{style:{flex:2,padding:20,paddingTop:300},children:e.jsx("div",{style:{top:0,height:400,position:"sticky",background:"white"}})})]}),e.jsx("div",{style:{background:"white",height:60,marginTop:40},children:"footer"})]})},me={render:()=>{const a=(g,x=0)=>{const y=[20,40,80,77];return Array.from({length:g}).map((j,t)=>(t+=x,e.jsx("div",{style:{height:y[t%4],borderBottom:"solid 1px #ccc",background:"#fff"},children:t},t)))},[i,r]=s.useState(!1),o=async()=>{r(!0),await P(1e3),r(!1)},n=100,[d,u]=s.useState(()=>a(n)),m=s.useRef(-1),c=d.length,p=s.useRef(null);return e.jsx("div",{style:{padding:"200px 100px 0px 100px"},children:e.jsxs(f,{ref:p,onScroll:async()=>{p.current&&m.current<c&&p.current.findItemIndex(p.current.scrollOffset+p.current.viewportSize)+50>c&&(m.current=c,await o(),u(g=>[...g,...a(n,g.length)]))},children:[d,i&&e.jsx(q,{})]})})}},ee=({id:a})=>{const i="window-list-cache-"+a,r=s.useRef(null),[o,n]=s.useMemo(()=>{const d=sessionStorage.getItem(i);if(!d)return[];try{return JSON.parse(d)}catch{return[]}},[]);return s.useLayoutEffect(()=>{if(!r.current)return;const d=r.current;window.scrollTo(0,o??0);let u=0;const m=()=>{u=window.scrollY};return window.addEventListener("scroll",m),m(),()=>{window.removeEventListener("scroll",m),sessionStorage.setItem(i,JSON.stringify([u,d.cache]))}},[]),e.jsx(f,{ref:r,cache:n,children:C(1e3)})},he={render:()=>{const[a,i]=s.useState(!0),[r,o]=s.useState("1");return e.jsxs("div",{style:{position:"relative"},children:[e.jsxs("div",{style:{position:"fixed",top:0,left:0,zIndex:10},children:[e.jsx("button",{onClick:()=>{i(n=>!n)},children:a?"hide":"show"}),["1","2","3"].map(n=>e.jsxs("label",{children:[e.jsx("input",{type:"radio",checked:r===n,onChange:()=>{o(n)}}),n]},n))]}),a&&e.jsx(ee,{id:r},r)]})}},pe={render:()=>{const a=s.useRef(0),i=(t,I)=>Array.from({length:t}).map((T,w)=>(w+=I,{id:a.current++,index:w})),[r,o]=s.useState(!1),[n,d]=s.useState(4),[u,m]=s.useState(!1),[c,p]=s.useState(!0),[g,x]=s.useState(()=>i(n,0)),y=()=>{x(c?t=>u?[...i(n,(t[0]?.index??0)-n),...t]:[...t,...i(n,(t[t.length-1]?.index??0)+1)]:u?t=>t.slice(n):t=>t.slice(0,-n))};s.useEffect(()=>{if(!r)return;const t=setInterval(y,500);return()=>{clearInterval(t)}},[y,r]);const j=[20,40,80,77];return e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsxs("div",{style:{position:"fixed",width:"100%",top:0,zIndex:1,backdropFilter:"blur(1px)"},children:[e.jsxs("div",{children:[e.jsxs("label",{style:{marginRight:4},children:[e.jsx("input",{type:"checkbox",style:{marginLeft:4},checked:u,onChange:()=>{m(t=>!t)}}),"prepend"]}),e.jsxs("label",{style:{marginRight:4},children:[e.jsx("input",{type:"radio",style:{marginLeft:4},checked:c,onChange:()=>{p(!0)}}),"increase"]}),e.jsxs("label",{style:{marginRight:4},children:[e.jsx("input",{type:"radio",style:{marginLeft:4},checked:!c,onChange:()=>{p(!1)}}),"decrease"]}),e.jsx("input",{style:{marginLeft:4},value:n,type:"number",min:1,max:1e4,step:1,onChange:t=>{d(Number(t.target.value))}})]}),e.jsxs("div",{children:[e.jsxs("label",{style:{marginRight:16},children:[e.jsx("input",{type:"checkbox",style:{marginLeft:4},checked:r,onChange:()=>{o(t=>!t)}}),"auto"]}),e.jsx("button",{onClick:()=>{y()},children:"update"})]})]}),e.jsx("div",{style:{flex:1},children:e.jsx(f,{shift:u,children:g.map(t=>e.jsx("div",{style:{height:j[Math.abs(t.index)%4],borderBottom:"solid 1px #ccc",background:"#fff"},children:t.index},t.id))})})]})}},fe={render:()=>{const[i,r]=s.useState(567),[o,n]=s.useState("start"),[d,u]=s.useState(!1),m=s.useRef(null);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{position:"fixed",top:30,left:150,zIndex:1,padding:10,border:"1px solid #ccc",backgroundColor:"white"},children:[e.jsx("input",{type:"number",value:i,onChange:c=>{r(Number(c.target.value))}}),e.jsx("button",{onClick:()=>{m.current?.scrollToIndex(i,{align:o,smooth:d})},children:"scroll to index"}),e.jsx("button",{onClick:()=>{r(Math.round(1e3*Math.random()))},children:"randomize"}),e.jsxs("label",{style:{marginLeft:4},children:[e.jsx("input",{type:"radio",style:{marginLeft:4},checked:o==="start",onChange:()=>{n("start")}}),"start"]}),e.jsxs("label",{style:{marginLeft:4},children:[e.jsx("input",{type:"radio",style:{marginLeft:4},checked:o==="center",onChange:()=>{n("center")}}),"center"]}),e.jsxs("label",{style:{marginLeft:4},children:[e.jsx("input",{type:"radio",style:{marginLeft:4},checked:o==="end",onChange:()=>{n("end")}}),"end"]}),e.jsxs("label",{style:{marginLeft:4},children:[e.jsx("input",{type:"checkbox",style:{marginLeft:4},checked:d,onChange:()=>{u(c=>!c)}}),"smooth"]})]}),e.jsx("div",{style:{padding:"100px"},children:e.jsx("div",{style:{border:"1px solid darkgrey"},children:e.jsx(f,{ref:m,children:C(1e3)})})})]})}},ge=["Default","Horizontal","Complex","InfiniteScrolling","ScrollRestoration","IncreasingItems","ScrollTo"];export{ue as Complex,ce as Default,de as Horizontal,pe as IncreasingItems,me as InfiniteScrolling,he as ScrollRestoration,fe as ScrollTo,ge as __namedExportsOrder,ae as default};

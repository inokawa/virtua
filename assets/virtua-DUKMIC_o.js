import{j as q}from"./jsx-runtime-u17CrQMm.js";import{r as T}from"./iframe-BF_aPKkf.js";import{r as pe}from"./index-CFeHGsZ9.js";const J=null,{min:W,max:z,abs:re,floor:ve}=Math,se=(e,t,r)=>W(r,z(t,e)),le=e=>[...e].sort(((t,r)=>t-r)),ie=typeof queueMicrotask=="function"?queueMicrotask:e=>{Promise.resolve().then(e)},F=()=>{let e;return[new Promise((t=>{e=t})),e]},ae=e=>{let t;return()=>(e&&(t=e(),e=void 0),t)},Y=(e,t,r)=>{const n=r?"unshift":"push";for(let l=0;l<t;l++)e[n](-1);return e},ue=(e,t)=>{const r=e.t[t];return r===-1?e.o:r},ye=(e,t,r)=>{const n=e.t[t]===-1;return e.t[t]=r,e.i=W(t,e.i),n},U=(e,t)=>{if(!e.l)return 0;if(e.i>=t)return e.u[t];e.i<0&&(e.u[0]=0,e.i=0);let r=e.i,n=e.u[r];for(;r<t;)n+=ue(e,r),e.u[++r]=n;return e.i=t,n},D=(e,t,r=0,n=e.l-1)=>{let l=r;for(;r<=n;){const i=ve((r+n)/2);U(e,i)<=t?(l=i,r=i+1):n=i-1}return se(l,0,e.l-1)},ne=(e,t,r)=>{const n=t-e.l;return e.i=r?-1:W(t-1,e.i),e.l=t,n>0?(Y(e.u,n),Y(e.t,n,r),e.o*n):(e.u.splice(n),(r?e.t.splice(0,-n):e.t.splice(n)).reduce(((l,i)=>l-(i===-1?e.o:i)),0))},ge=typeof window<"u",be=e=>e.documentElement,we=e=>e.ownerDocument,ke=e=>e.defaultView,ce=ae((()=>!!/iP(hone|od|ad)/.test(navigator.userAgent)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>0)),xe=ae((()=>"scrollBehavior"in be(document).style)),Se=e=>z(e.h(),e.p()),Ee=(e,t=40,r=0,n,l=!1)=>{let i=!!r,f=1,a=0,d=0,y=0,o=0,p=0,k=0,x=0,g=0,S=J,C=[0,i?z(r-1,0):-1],E=0,L=!1;const b=((u,m,h)=>({o:m,t:h?Y(h.slice(0,W(u,h.length)),z(0,u-h.length)):Y([],u),l:u,i:-1,u:Y([],u+1)}))(e,n?n[1]:t,n&&n[0]),A=new Set,P=()=>y-d,v=()=>P()+p+o,V=(u,m)=>((h,I,w,c)=>{if(c=W(c,h.l-1),U(h,c)<=I){const s=D(h,w,c);return[D(h,I,c,s),s]}{const s=D(h,I,void 0,c);return[s,D(h,w,s)]}})(b,u,m,C[0]),M=()=>U(b,b.l),O=(u,m)=>{const h=U(b,u)-p;return m?M()-h-_(u):h},_=u=>ue(b,u),H=(u,m=-1)=>b.t[u]===m,X=u=>{u&&(ce()&&x!==0||S&&g===1?p+=u:o+=u)};return{v:()=>{A.clear()},m:()=>f,_:()=>(u=>[u.t.slice(),u.o])(b),S:(u=200)=>{if(!L||i)return C;let m,h;if(k)[m,h]=C;else{let I=z(0,v()),w=I+a;l||(u=z(0,u),x!==1&&(I-=u),x!==2&&(w+=u)),[m,h]=C=V(z(0,I),z(0,w)),S&&(m=W(m,S[0]),h=z(h,S[1]))}return[z(m,0),W(h,b.l-1)]},$:u=>D(b,u-d),I:H,k:O,R:_,T:()=>b.l,C:()=>y,M:()=>x!==0,p:()=>a,O:()=>d,h:M,H:()=>(k=o,o=0,[k,g===2]),W:(u,m)=>{const h=[u,m];return A.add(h),()=>{A.delete(h)}},B:(u,m)=>{let h,I,w=0;switch(u){case 1:{if(m===y&&g===0)break;const c=k;k=0;const s=m-y,R=re(s);c&&R<re(c)+1||g!==0||(x=s<0?2:1),i&&(i=!1),y=m,w=4;const j=P();j>=-a&&j<=M()&&(w+=1,I=R>a);break}case 2:w=8,x!==0&&(h=!0,w+=1),x=0,g=0,S=J;break;case 3:{const c=m.filter((([s,R])=>!H(s,R)));if(!c.length)break;X(c.reduce(((s,[R,j])=>((g===2||(S&&g===1?R<S[0]:O(R+(x===0&&g===0?1:0))<P()))&&(s+=j-_(R)),s)),0));for(const[s,R]of c){const j=_(s),N=ye(b,s,R);l&&(E+=N?R:R-j)}l&&a&&E>a&&(X(((s,R)=>{let j=0;const N=[];s.t.forEach(((te,he)=>{te!==-1&&(N.push(te),he<R&&j++)})),s.i=-1;const G=le(N),ee=G.length,$=ee/2|0,de=ee%2==0?(G[$-1]+G[$])/2:G[$],me=s.o;return((s.o=de)-me)*z(R-j,0)})(b,D(b,v()))),l=!1),w=3,I=!0;break}case 4:a!==m&&(a||(L=I=!0),a=m,w=3);break;case 5:m[1]?(X(ne(b,m[0],!0)),g=2,w=1):(ne(b,m[0]),w=1);break;case 6:d=m;break;case 7:g=1;break;case 8:S=V(m,m+a),w=1}w&&(f=1+(2147483647&f),h&&p&&(o+=p,p=0),A.forEach((([c,s])=>{w&c&&s(I)})))}}},Q=setTimeout,K=(e,t)=>t?-e:e,Re=(e,t,r,n,l,i)=>{const f=Date.now;let a=0,d=!1,y=!1,o=!1,p=!1;const k=(()=>{let E;const L=()=>{E!=J&&clearTimeout(E)},b=()=>{L(),E=Q((()=>{E=J,(()=>{if(d||y)return d=!1,void k();o=!1,e.B(2)})()}),150)};return b.J=L,b})(),x=()=>{a=f(),o&&(p=!0),e.B(1,n()),k()},g=E=>{if(d||!e.M()||E.ctrlKey)return;const L=f()-a;150>L&&50<L&&(r?E.deltaX:E.deltaY)&&(d=!0)},S=()=>{y=!0,o=p=!1},C=()=>{y=!1,ce()&&(o=!0)};return t.addEventListener("scroll",x),t.addEventListener("wheel",g,{passive:!0}),t.addEventListener("touchstart",S,{passive:!0}),t.addEventListener("touchend",C,{passive:!0}),{A:()=>{t.removeEventListener("scroll",x),t.removeEventListener("wheel",g),t.removeEventListener("touchstart",S),t.removeEventListener("touchend",C),k.J()},L:()=>{const[E,L]=e.H();E&&(l(E,L,p),p=!1,L&&e.p()>e.h()&&e.B(1,n()))}}},Te=(e,t,r)=>{let n;return[async(l,i)=>{if(!await t())return;n&&n();const f=()=>{const[a,d]=F();return n=()=>{d(!1)},e.p()&&Q(n,150),[a,e.W(2,(()=>{d(!0)}))]};if(i&&xe())e.B(8,l()),ie((async()=>{for(;;){let a=!0;for(let[o,p]=e.S();o<=p;o++)if(e.I(o)){a=!1;break}if(a)break;const[d,y]=f();try{if(!await d)return}finally{y()}}e.B(7),r(l(),i)}));else for(;;){const[a,d]=f();try{if(e.B(7),r(l()),!await a)return}finally{d()}}},()=>{n&&n()}]},Ie=(e,t)=>{let r,n,l=F(),i=!1;const f=t?"scrollLeft":"scrollTop",a=t?"overflowX":"overflowY",[d,y]=Te(e,(()=>l[0]),((o,p)=>{o=K(o,i),p?r.scrollTo({[t?"left":"top"]:o,behavior:"smooth"}):r[f]=o}));return{N(o){r=o,t&&(i=getComputedStyle(o).direction==="rtl"),n=Re(e,o,t,(()=>K(o[f],i)),((p,k,x)=>{if(x){const g=o.style,S=g[a];g[a]="hidden",Q((()=>{g[a]=S}))}o[f]=K(e.C()+p,i),k&&y()})),l[1](!0)},v(){n&&n.A(),l[1](!1),l=F()},P:()=>i,V(o){d((()=>o))},X(o){o+=e.C(),d((()=>o))},Y(o,{align:p,smooth:k,offset:x=0}={}){if(o=se(o,0,e.T()-1),p==="nearest"){const g=e.k(o),S=e.C();if(g<S)p="start";else{if(!(g+e.R(o)>S+e.p()))return;p="end"}}d((()=>x+e.O()+e.k(o)+(p==="end"?e.R(o)-e.p():p==="center"?(e.R(o)-e.p())/2:0)),k)},q:()=>{n&&n.L()}}},Le=e=>{let t;return{D(r){(t||(t=new(ke(we(r))).ResizeObserver(e))).observe(r)},j(r){t.unobserve(r)},A(){t&&t.disconnect()}}},Be=(e,t)=>{let r;const n=t?"width":"height",l=new WeakMap,i=Le((f=>{const a=[];for(const{target:d,contentRect:y}of f)if(d.offsetParent)if(d===r)e.B(4,y[n]);else{const o=l.get(d);o!=J&&a.push([o,y[n]])}a.length&&e.B(3,a)}));return{G(f){i.D(r=f)},U:(f,a)=>(l.set(f,a),i.D(f),()=>{l.delete(f),i.j(f)}),v:i.A}},Z=ge?T.useLayoutEffect:T.useEffect,B="current",fe=(e,t)=>{if(Array.isArray(e))for(const r of e)fe(r,t);else e==null||typeof e=="boolean"||t.push(e)},Me=(e,t)=>{const r=e.key;return r??"_"+t},ze=e=>{const t=T.useRef(null);return t[B]||(t[B]=e())},oe=e=>{const t=T.useRef(e);return Z((()=>{t[B]=e}),[e]),t},Ce=T.memo((({Z:e,ee:t,te:r,oe:n,ne:l,re:i,se:f,ie:a})=>{const d=T.useRef(null);Z((()=>t(d[B],r)),[r]);const y=T.useMemo((()=>{const o={contain:"layout style",position:l&&a?void 0:"absolute",[f?"height":"width"]:"100%",[f?"top":"left"]:0,[f?"left":"top"]:n,visibility:!l||a?void 0:"hidden"};return f&&(o.display="inline-flex"),o}),[n,l,a,f]);return q.jsx(i,typeof i=="string"?{ref:d,style:y,children:e}:{ref:d,style:y,index:r,children:e})})),je=(e,t)=>T.useMemo((()=>{if(typeof e=="function")return[n=>e(t[n],n),t.length];const r=(n=>{const l=[];return fe(n,l),l})(e);return[n=>r[n],r.length]}),[e,t]),Ae=T.forwardRef((({children:e,data:t,bufferSize:r,itemSize:n,shift:l,horizontal:i,keepMounted:f,cache:a,startMargin:d=0,ssrCount:y,as:o="div",item:p="div",scrollRef:k,onScroll:x,onScrollEnd:g},S)=>{const[C,E]=je(e,t),L=T.useRef(null),b=T.useRef(!!y),A=oe(x),P=oe(g),[v,V,M,O]=ze((()=>{const c=!!i,s=Ee(E,n,y,a,!n);return[s,Be(s,c),Ie(s,c),c]}));E!==v.T()&&v.B(5,[E,l]),d!==v.O()&&v.B(6,d);const[_,H]=T.useReducer(v.m,void 0,v.m),X=v.M(),u=v.h(),m=M.P(),h=!O&&m?"unshift":"push",I=[],w=c=>{const s=C(c);return q.jsx(Ce,{ee:V.U,te:c,oe:v.k(c,m),ne:v.I(c),re:p,Z:s,se:O,ie:b[B]},Me(s,c))};if(Z((()=>{b[B]=!1,v.W(1,(s=>{s?pe.flushSync(H):H()})),v.W(4,(()=>{A[B]&&A[B](v.C())})),v.W(8,(()=>{P[B]&&P[B]()}));const c=s=>{V.G(s),M.N(s)};return k?ie((()=>{k[B]&&c(k[B])})):c(L[B].parentElement),()=>{v.v(),V.v(),M.v()}}),[]),Z((()=>{M.q()}),[_]),T.useImperativeHandle(S,(()=>({get cache(){return v._()},get scrollOffset(){return v.C()},get scrollSize(){return Se(v)},get viewportSize(){return v.p()},findItemIndex:v.$,getItemOffset:v.k,getItemSize:v.R,scrollToIndex:M.Y,scrollTo:M.V,scrollBy:M.X})),[]),f){const c=new Set(f);for(let[s,R]=v.S(r);s<=R;s++)c.add(s);le([...c]).forEach((s=>{I[h](w(s))}))}else for(let[c,s]=v.S(r);c<=s;c++)I[h](w(c));return q.jsx(o,{ref:L,style:{contain:"size style",overflowAnchor:"none",flex:"none",position:"relative",width:O?u:"100%",height:O?"100%":u,pointerEvents:X?"none":void 0},children:I})})),Oe=T.forwardRef((({children:e,data:t,bufferSize:r,itemSize:n,shift:l,horizontal:i,keepMounted:f,cache:a,ssrCount:d,item:y,onScroll:o,onScrollEnd:p,style:k,...x},g)=>q.jsx("div",{...x,style:{display:i?"inline-block":"block",[i?"overflowX":"overflowY"]:"auto",contain:"strict",width:"100%",height:"100%",...k},children:q.jsx(Ae,{ref:g,data:t,bufferSize:r,itemSize:n,shift:l,horizontal:i,keepMounted:f,cache:a,ssrCount:d,item:y,onScroll:o,onScrollEnd:p,children:e})}))),We=T.memo(({count:e,Component:t,handle:r})=>{const n=T.useRef(null);return T.useImperativeHandle(r,()=>({scrollToIndex:l=>{n.current?.scrollToIndex(l)}})),q.jsx(Oe,{ref:n,children:Array.from({length:e}).map((l,i)=>q.jsx(t,{index:i},i))})});We.__docgenInfo={description:"",methods:[{name:"scrollToIndex",docblock:null,modifiers:[],params:[{name:"i",optional:!1,type:null}],returns:null}],displayName:"VirtuaList",props:{count:{required:!0,tsType:{name:"number"},description:""},Component:{required:!0,tsType:{name:"SimpleItem"},description:""},handle:{required:!1,tsType:{name:"Ref",elements:[{name:"signature",type:"object",raw:"{ scrollToIndex: (index: number) => void }",signature:{properties:[{key:"scrollToIndex",value:{name:"signature",type:"function",raw:"(index: number) => void",signature:{arguments:[{type:{name:"number"},name:"index"}],return:{name:"void"}},required:!0}}]}}],raw:"Ref<ListHandle>"},description:""}}};export{We as V};

import{j as q}from"./jsx-runtime-DR9Q75dM.js";import{r as T}from"./index-DRjF_FHU.js";import{r as me}from"./index-uWwxbAOW.js";const z=null,{min:P,max:$,abs:ne,floor:pe}=Math,ve=Array.isArray,te=setTimeout,ie=(e,t,r)=>P(r,$(t,e)),le=e=>[...e].sort((t,r)=>t-r),ce=typeof queueMicrotask=="function"?queueMicrotask:e=>{Promise.resolve().then(e)},re=e=>{let t,r;return(...n)=>(t||(t=!0,r=e(...n)),r)},X=-1,K=(e,t,r)=>{const n=r?"unshift":"push";for(let s=0;s<t;s++)e[n](X);return e},Q=(e,t)=>{const r=e.t[t];return r===X?e.o:r},ye=(e,t,r)=>{const n=e.t[t]===X;return e.t[t]=r,e.i=P(t,e.i),n},U=(e,t)=>{if(!e.l)return 0;if(e.i>=t)return e.u[t];e.i<0&&(e.u[0]=0,e.i=0);let r=e.i,n=e.u[r];for(;r<t;)n+=Q(e,r),e.u[++r]=n;return e.i=t,n},F=(e,t,r=0,n=e.l-1)=>{for(;r<=n;){const s=pe((r+n)/2),i=U(e,s);if(i<=t){if(i+Q(e,s)>t)return s;r=s+1}else n=s-1}return ie(r,0,e.l-1)},oe=(e,t,r)=>{const n=t-e.l;return e.i=r?-1:P(t-1,e.i),e.l=t,n>0?(K(e.u,n),K(e.t,n,r),e.o*n):(e.u.splice(n),(r?e.t.splice(0,-n):e.t.splice(n)).reduce((s,i)=>s-(i===X?e.o:i),0))},ue=typeof window<"u",ae=()=>document.documentElement,ge=e=>e.ownerDocument,we=e=>e.defaultView,fe=re(()=>!!ue&&getComputedStyle(ae()).direction==="rtl"),de=re(()=>/iP(hone|od|ad)/.test(navigator.userAgent)),xe=re(()=>"scrollBehavior"in ae().style),be=e=>$(e.h(),e._()),Re=(e,t,r,n,s)=>(n!==1&&(e-=$(0,r)),n!==2&&(t+=$(0,r)),[$(e,0),P(t,s-1)]),Ee=(e,t=40,r=0,n,s=!1)=>{let i=!!r,u=[],c=0,o=0,a=0,h=0,d=0,f=0,w=0,C=0,j=0,M=i?[0,$(r-1,0)]:z,p=[0,0],R=0;const v=((l,m,g)=>({o:g?g[1]:m,t:g&&g[0]?K(g[0].slice(0,P(l,g[0].length)),$(0,l-g[0].length)):K([],l),l,i:-1,u:K([],l)}))(e,t,n),Y=new Set,V=()=>a-o,G=l=>((m,g,H,E)=>{if(E=P(E,m.l-1),U(m,E)<=g){const L=F(m,g+H,E);return[F(m,g,E,L),L]}{const L=F(m,g,void 0,E);return[L,F(m,g+H,L)]}})(v,l,c,p[0]),y=()=>(l=>l.l?U(l,l.l-1)+Q(l,l.l-1):0)(v),J=l=>U(v,l)-f,A=l=>Q(v,l),W=l=>{l&&(de()&&C!==0?f+=l:(d+=l,h++))};return{p:()=>u,v:()=>(l=>[l.t.slice(),l.o])(v),m:()=>w?p:(p=G($(0,V()+f+d)),M?[P(p[0],M[0]),$(p[1],M[1])]:p),S:l=>v.t[l]===X,I:()=>!!c,k:()=>!!M&&v.t.slice($(0,M[0]-1),P(v.l-1,M[1]+1)+1).includes(X),R:J,C:A,T:()=>v.l,M:()=>a,H:()=>C,_:()=>c,W:()=>o,h:y,J:()=>h,B:()=>(w=d,d=0,[w,j===2||V()+c>=y()]),O(l,m){const g=[l,m];return Y.add(g),()=>{Y.delete(g)}},D(l,m){let g,H,E=0;switch(l){case 1:{const L=w;w=0;const x=m-a,k=ne(x);L&&k<ne(L)+1||j!==0||(C=x<0?2:1),i&&(M=z,i=!1),a=m,E=4;const I=V();I>=-c&&I<=y()&&(E+=1,H=k>c);break}case 2:E=8,C!==0&&(g=!0,E+=1),C=0,j=0,M=z;break;case 3:{const L=m.filter(([x,k])=>v.t[x]!==k);if(!L.length)break;W(L.reduce((x,[k,I])=>((j===2||(M?k<M[0]:J(k)+(C===0&&j===0?A(k):0)<V()))&&(x+=I-A(k)),x),0));for(const[x,k]of L){const I=A(x),B=ye(v,x,k);s&&(R+=B?k:k-I)}s&&c&&R>c&&(W(((x,k)=>{let I=0;const B=x.t.filter((S,D)=>{const O=S!==X;return O&&D<k&&I++,O}),b=x.o;return x.i=-1,((x.o=(S=>{const D=le(S),O=S.length/2|0;return D.length%2==0?(D[O-1]+D[O])/2:D[O]})(B))-b)*$(k-I,0)})(v,p[0])),s=!1),E=3,H=!0;break}case 4:c!==m&&(c=m,E=3);break;case 5:m[1]?(W(oe(v,m[0],!0)),j=2,E=1):oe(v,m[0]);break;case 6:o=m;break;case 7:j=1;break;case 8:M=G(m),E=1}E&&(u=[],g&&f&&(d+=f,f=0,h++),Y.forEach(([L,x])=>{E&L&&x(H)}))}}},ee=ue?T.useLayoutEffect:T.useEffect,Z=(e,t)=>t&&fe()?-e:e,ke=(e,t,r,n,s,i)=>{const u=Date.now;let c=0,o=!1,a=!1,h=!1,d=!1;const f=(()=>{let p;const R=()=>{p!=z&&clearTimeout(p)},v=()=>{R(),p=te(()=>{p=z,(()=>{if(o||a)return o=!1,void f();h=!1,e.D(2)})()},150)};return v.L=R,v})(),w=()=>{c=u(),h&&(d=!0),e.D(1,n()),f()},C=p=>{if(o||e.H()===0||p.ctrlKey)return;const R=u()-c;150>R&&50<R&&(r?p.deltaX:p.deltaY)&&(o=!0)},j=()=>{a=!0,h=d=!1},M=()=>{a=!1,de()&&(h=!0)};return t.addEventListener("scroll",w),t.addEventListener("wheel",C,{passive:!0}),t.addEventListener("touchstart",j,{passive:!0}),t.addEventListener("touchend",M,{passive:!0}),{$:()=>{t.removeEventListener("scroll",w),t.removeEventListener("wheel",C),t.removeEventListener("touchstart",j),t.removeEventListener("touchend",M),f.L()},A:()=>{const[p,R]=e.B();p&&(s(Z(p,r),R,d),d=!1,R&&e._()>e.h()&&e.D(1,n()))}}},Te=(e,t)=>{let r,n,s;const i=t?"scrollLeft":"scrollTop",u=t?"overflowX":"overflowY",c=async(o,a)=>{if(!r)return void ce(()=>c(o,a));s&&s();const h=()=>{let d;return[new Promise((f,w)=>{d=f,s=w,e.I()&&te(w,150)}),e.O(2,()=>{d&&d()})]};if(a&&xe()){for(;e.D(8,o()),e.k();){const[d,f]=h();try{await d}catch{return}finally{f()}}r.scrollTo({[t?"left":"top"]:Z(o(),t),behavior:"smooth"})}else for(;;){const[d,f]=h();try{r[i]=Z(o(),t),e.D(7),await d}catch{return}finally{f()}}};return{P(o){r=o,n=ke(e,o,t,()=>Z(o[i],t),(a,h,d)=>{if(d){const f=o.style,w=f[u];f[u]="hidden",te(()=>{f[u]=w})}h?(o[i]=e.M()+a,s&&s()):o[i]+=a})},$(){n&&n.$()},V(o){c(()=>o)},X(o){o+=e.M(),c(()=>o)},Y(o,{align:a,smooth:h,offset:d=0}={}){if(o=ie(o,0,e.T()-1),a==="nearest"){const f=e.R(o),w=e.M();if(f<w)a="start";else{if(!(f+e.C(o)>w+e._()))return;a="end"}}c(()=>d+e.W()+e.R(o)+(a==="end"?e.C(o)-e._():a==="center"?(e.C(o)-e._())/2:0),h)},A:()=>{n&&n.A()}}},_="current",he=(e,t)=>{if(ve(e))for(const r of e)he(r,t);else e==z||typeof e=="boolean"||t.push(e)},Me=(e,t)=>{const r=e.key;return r!=z?r:"_"+t},Se=e=>{const t=T.useRef();return t[_]||(t[_]=e())},se=e=>{const t=T.useRef(e);return ee(()=>{t[_]=e},[e]),t},Le=e=>{let t;return{P(r){(t||(t=new(we(ge(r))).ResizeObserver(e))).observe(r)},j(r){t.unobserve(r)},$(){t&&t.disconnect()}}},je=(e,t)=>{let r;const n=t?"width":"height",s=new WeakMap,i=Le(u=>{const c=[];for(const{target:o,contentRect:a}of u)if(o.offsetParent)if(o===r)e.D(4,a[n]);else{const h=s.get(o);h!=z&&c.push([h,a[n]])}c.length&&e.D(3,c)});return{q(u){i.P(r=u)},U:(u,c)=>(s.set(u,c),i.P(u),()=>{s.delete(u),i.j(u)}),$:i.$}},Ce=T.memo(({F:e,G:t,K:r,N:n,Z:s,ee:i,te:u,oe:c})=>{const o=T.useRef(z);ee(()=>t(o[_],r),[r]);const a=T.useMemo(()=>{const h={position:s&&c?void 0:"absolute",[u?"height":"width"]:"100%",[u?"top":"left"]:0,[u?fe()?"right":"left":"top"]:n,visibility:!s||c?"visible":"hidden"};return u&&(h.display="flex"),h},[n,s,c,u]);return q.jsx(i,typeof i=="string"?{ref:o,style:a,children:e}:{ref:o,style:a,index:r,children:e})}),De=e=>T.useReducer(e.p,void 0,e.p)[1],Ie=(e,t)=>T.useMemo(()=>{if(typeof e=="function")return[e,t||0];const r=(n=>{const s=[];return he(n,s),s})(e);return[n=>r[n],r.length]},[e,t]),_e=T.forwardRef(({children:e,count:t,overscan:r=4,keepMounted:n,itemSize:s,shift:i,horizontal:u,cache:c,startMargin:o=0,ssrCount:a,as:h="div",item:d="div",scrollRef:f,onScroll:w,onScrollEnd:C,onRangeChange:j},M)=>{const[p,R]=Ie(e,t),v=T.useRef(z),Y=T.useRef(!!a),V=se(w),G=se(C),[y,J,A,W]=Se(()=>{const b=!!u,S=Ee(R,s,a,c,!s);return[S,je(S,b),Te(S,b),b]});R!==y.T()&&y.D(5,[R,i]),o!==y.W()&&y.D(6,o);const l=De(y),[m,g]=y.m(),H=y.H(),E=y.J(),L=y.h(),x=[],[k,I]=Re(m,g,r,H,R),B=b=>{const S=p(b);return q.jsx(Ce,{G:J.U,K:b,N:y.R(b),Z:y.S(b),ee:d,F:S,te:W,oe:Y[_]},Me(S,b))};ee(()=>{Y[_]=!1;const b=y.O(1,N=>{N?me.flushSync(l):l()}),S=y.O(4,()=>{V[_]&&V[_](y.M())}),D=y.O(8,()=>{G[_]&&G[_]()}),O=N=>{J.q(N),A.P(N)};return f?ce(()=>O(f[_])):O(v[_].parentElement),()=>{b(),S(),D(),J.$(),A.$()}},[]),ee(()=>{A.A()},[E]),T.useEffect(()=>{j&&j(m,g)},[m,g]),T.useImperativeHandle(M,()=>({get cache(){return y.v()},get scrollOffset(){return y.M()},get scrollSize(){return be(y)},get viewportSize(){return y._()},getItemOffset:y.R,scrollToIndex:A.Y,scrollTo:A.V,scrollBy:A.X}),[]);for(let b=k,S=I;b<=S;b++)x.push(B(b));if(n){const b=[],S=[];le(n).forEach(D=>{D<k&&b.push(B(D)),D>I&&S.push(B(D))}),x.unshift(...b),x.push(...S)}return q.jsx(h,{ref:v,style:{overflowAnchor:"none",flex:"none",position:"relative",visibility:"hidden",width:W?L:"100%",height:W?"100%":L,pointerEvents:H!==0?"none":void 0},children:x})}),Ae=T.forwardRef(({children:e,count:t,overscan:r,keepMounted:n,itemSize:s,shift:i,horizontal:u,reverse:c,cache:o,ssrCount:a,item:h,onScroll:d,onScrollEnd:f,onRangeChange:w,style:C,...j},M)=>{const p=T.useRef(z),R=c&&!u;let v=q.jsx(_e,{ref:M,scrollRef:R?p:void 0,count:t,overscan:r,keepMounted:n,itemSize:s,shift:i,horizontal:u,cache:o,ssrCount:a,item:h,onScroll:d,onScrollEnd:f,onRangeChange:w,children:e});return R&&(v=q.jsx("div",{style:{visibility:"hidden",display:"flex",flexDirection:"column",justifyContent:"flex-end",minHeight:"100%"},children:v})),q.jsx("div",{ref:p,...j,style:{display:u?"inline-block":"block",[u?"overflowX":"overflowY"]:"auto",contain:"strict",width:"100%",height:"100%",...C},children:v})}),$e=T.memo(({count:e,Component:t,handle:r})=>{const n=T.useRef(null);return T.useImperativeHandle(r,()=>({scrollToIndex:s=>{var i;(i=n.current)==null||i.scrollToIndex(s)}})),q.jsx(Ae,{ref:n,children:Array.from({length:e}).map((s,i)=>q.jsx(t,{index:i},i))})});$e.__docgenInfo={description:"",methods:[{name:"scrollToIndex",docblock:null,modifiers:[],params:[{name:"i",optional:!1,type:null}],returns:null}],displayName:"VirtuaList",props:{count:{required:!0,tsType:{name:"number"},description:""},Component:{required:!0,tsType:{name:"SimpleItem"},description:""},handle:{required:!1,tsType:{name:"Ref",elements:[{name:"signature",type:"object",raw:"{ scrollToIndex: (index: number) => void }",signature:{properties:[{key:"scrollToIndex",value:{name:"signature",type:"function",raw:"(index: number) => void",signature:{arguments:[{type:{name:"number"},name:"index"}],return:{name:"void"}},required:!0}}]}}],raw:"Ref<ListHandle>"},description:""}}};export{$e as V};

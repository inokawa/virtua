import{j as B}from"./jsx-runtime-BjG_zV1W.js";import{r as S}from"./iframe-DTLkkNrr.js";import{r as ye}from"./index-Dt0RuFuf.js";const K=null,{min:H,max:J,abs:ne,floor:ge}=Math,ie=(e,t,r)=>H(r,J(t,e)),le=e=>[...e].sort((t,r)=>t-r),ce=typeof queueMicrotask=="function"?queueMicrotask:e=>{Promise.resolve().then(e)},ee=e=>{let t;return()=>(e&&(t=e(),e=void 0),t)},O=-1,U=(e,t,r)=>{const o=r?"unshift":"push";for(let i=0;i<t;i++)e[o](O);return e},$=(e,t)=>{const r=e.t[t];return r===O?e.o:r},xe=(e,t,r)=>{const o=e.t[t]===O;return e.t[t]=r,e.i=H(t,e.i),o},F=(e,t)=>{if(!e.l)return 0;if(e.i>=t)return e.u[t];e.i<0&&(e.u[0]=0,e.i=0);let r=e.i,o=e.u[r];for(;r<t;)o+=$(e,r),e.u[++r]=o;return e.i=t,o},q=(e,t,r=0,o=e.l-1)=>{for(;r<=o;){const i=ge((r+o)/2),l=F(e,i);if(l<=t){if(l+$(e,i)>t)return i;r=i+1}else o=i-1}return ie(r,0,e.l-1)},oe=(e,t,r)=>{const o=t-e.l;return e.i=r?-1:H(t-1,e.i),e.l=t,o>0?(U(e.u,o),U(e.t,o,r),e.o*o):(e.u.splice(o),(r?e.t.splice(0,-o):e.t.splice(o)).reduce((i,l)=>i-(l===O?e.o:l),0))},ue=typeof window<"u",ae=()=>document.documentElement,we=e=>e.ownerDocument,be=e=>e.defaultView,fe=ee(()=>!!ue&&getComputedStyle(ae()).direction==="rtl"),de=ee(()=>/iP(hone|od|ad)/.test(navigator.userAgent)),Ee=ee(()=>"scrollBehavior"in ae().style),Re=e=>J(e.h(),e.v()),ke=e=>!!e.v(),Te=(e,t=40,r=4,o=0,i,l=!1)=>{let u=!!o,y=1,n=0,f=0,p=0,v=0,h=0,w=0,I=0,M=0,R=u?[0,J(o-1,0)]:K,b=[0,0],k=0;const g=((s,a,E)=>({o:E?E[1]:a,t:E&&E[0]?U(E[0].slice(0,H(s,E[0].length)),J(0,s-E[0].length)):U([],s),l:s,i:-1,u:U([],s)}))(e,t,i),P=new Set,V=()=>p-f,m=()=>V()+h+v,D=s=>((a,E,C,x)=>{if(x=H(x,a.l-1),F(a,x)<=E){const T=q(a,E+C,x);return[q(a,E,x,T),T]}{const T=q(a,E,void 0,x);return[T,q(a,E+C,T)]}})(g,s,n,b[0]),z=()=>(s=>s.l?F(s,s.l-1)+$(s,s.l-1):0)(g),X=s=>F(g,s)-h,W=s=>$(g,s),Y=s=>{s&&(de()&&I!==0?h+=s:v+=s)};return{p:()=>y,m:()=>(s=>[s.t.slice(),s.o])(g),_:()=>{let s,a;return w?[s,a]=b:([s,a]=b=D(J(0,m())),R&&(s=H(s,R[0]),a=J(a,R[1]))),I!==1&&(s-=J(0,r)),I!==2&&(a+=J(0,r)),[J(s,0),H(a,g.l-1)]},S:()=>q(g,m()),$:()=>q(g,m()+n),I:s=>g.t[s]===O,k:()=>!!R&&g.t.slice(J(0,R[0]-1),H(g.l-1,R[1]+1)+1).includes(O),R:X,T:W,C:()=>g.l,M:()=>p,H:()=>I!==0,v:()=>n,W:()=>f,h:z,O:()=>(w=v,v=0,[w,M===2||V()+n>=z()]),B:(s,a)=>{const E=[s,a];return P.add(E),()=>{P.delete(E)}},J:(s,a)=>{let E,C,x=0;switch(s){case 1:{const T=w;w=0;const c=a-p,d=ne(c);T&&d<ne(T)+1||M!==0||(I=c<0?2:1),u&&(R=K,u=!1),p=a,x=4;const L=V();L>=-n&&L<=z()&&(x+=1,C=d>n);break}case 2:x=8,I!==0&&(E=!0,x+=1),I=0,M=0,R=K;break;case 3:{const T=a.filter(([c,d])=>g.t[c]!==d);if(!T.length)break;Y(T.reduce((c,[d,L])=>((M===2||(R?!u&&d<R[0]:X(d)+(I===0&&M===0?W(d):0)<V()))&&(c+=L-W(d)),c),0));for(const[c,d]of T){const L=W(c),_=xe(g,c,d);l&&(k+=_?d:d-L)}l&&n&&k>n&&(Y(((c,d)=>{let L=0;const _=[];c.t.forEach((re,ve)=>{re!==O&&(_.push(re),ve<d&&L++)}),c.i=-1;const A=le(_),te=A.length,Q=te/2|0,me=te%2==0?(A[Q-1]+A[Q])/2:A[Q],pe=c.o;return((c.o=me)-pe)*J(d-L,0)})(g,q(g,m()))),l=!1),x=3,C=!0;break}case 4:n!==a&&(n=a,x=3);break;case 5:a[1]?(Y(oe(g,a[0],!0)),M=2,x=1):(oe(g,a[0]),x=1);break;case 6:f=a;break;case 7:M=1;break;case 8:R=D(a),x=1}x&&(y=1+(2147483647&y),E&&h&&(v+=h,h=0),P.forEach(([T,c])=>{x&T&&c(C)}))}}},Z=setTimeout,G=(e,t)=>t&&fe()?-e:e,Se=(e,t,r,o,i,l)=>{const u=Date.now;let y=0,n=!1,f=!1,p=!1,v=!1;const h=(()=>{let b;const k=()=>{b!=K&&clearTimeout(b)},g=()=>{k(),b=Z(()=>{b=K,(()=>{if(n||f)return n=!1,void h();p=!1,e.J(2)})()},150)};return g.A=k,g})(),w=()=>{y=u(),p&&(v=!0),e.J(1,o()),h()},I=b=>{if(n||!e.H()||b.ctrlKey)return;const k=u()-y;150>k&&50<k&&(r?b.deltaX:b.deltaY)&&(n=!0)},M=()=>{f=!0,p=v=!1},R=()=>{f=!1,de()&&(p=!0)};return t.addEventListener("scroll",w),t.addEventListener("wheel",I,{passive:!0}),t.addEventListener("touchstart",M,{passive:!0}),t.addEventListener("touchend",R,{passive:!0}),{L:()=>{t.removeEventListener("scroll",w),t.removeEventListener("wheel",I),t.removeEventListener("touchstart",M),t.removeEventListener("touchend",R),h.A()},P:()=>{const[b,k]=e.O();b&&(i(G(b,r),k,v),v=!1,k&&e.v()>e.h()&&e.J(1,o()))}}},Le=(e,t)=>{let r,o,i;const l=t?"scrollLeft":"scrollTop",u=t?"overflowX":"overflowY",y=async(n,f)=>{if(!r)return void ce(()=>y(n,f));i&&i();const p=()=>{let v;return[new Promise((h,w)=>{v=h,i=w,ke(e)&&Z(w,150)}),e.B(2,()=>{v&&v()})]};if(f&&Ee()){for(;e.J(8,n()),e.k();){const[v,h]=p();try{await v}catch{return}finally{h()}}r.scrollTo({[t?"left":"top"]:G(n(),t),behavior:"smooth"})}else for(;;){const[v,h]=p();try{r[l]=G(n(),t),e.J(7),await v}catch{return}finally{h()}}};return{D(n){r=n,o=Se(e,n,t,()=>G(n[l],t),(f,p,v)=>{if(v){const h=n.style,w=h[u];h[u]="hidden",Z(()=>{h[u]=w})}p?(n[l]=e.M()+f,i&&i()):n[l]+=f})},V(){o&&o.L()},X(n){y(()=>n)},Y(n){n+=e.M(),y(()=>n)},j(n,{align:f,smooth:p,offset:v=0}={}){if(n=ie(n,0,e.C()-1),f==="nearest"){const h=e.R(n),w=e.M();if(h<w)f="start";else{if(!(h+e.T(n)>w+e.v()))return;f="end"}}y(()=>v+e.W()+e.R(n)+(f==="end"?e.T(n)-e.v():f==="center"?(e.T(n)-e.v())/2:0),p)},q:()=>{o&&o.P()}}},Ie=e=>{let t;return{U(r){(t||(t=new(be(we(r))).ResizeObserver(e))).observe(r)},F(r){t.unobserve(r)},L(){t&&t.disconnect()}}},Me=(e,t)=>{let r;const o=t?"width":"height",i=new WeakMap,l=Ie(u=>{const y=[];for(const{target:n,contentRect:f}of u)if(n.offsetParent)if(n===r)e.J(4,f[o]);else{const p=i.get(n);p!=K&&y.push([p,f[o]])}y.length&&e.J(3,y)});return{G(u){l.U(r=u)},K:(u,y)=>(i.set(u,y),l.U(u),()=>{i.delete(u),l.F(u)}),V:l.L}},N=ue?S.useLayoutEffect:S.useEffect,j="current",he=(e,t)=>{if(Array.isArray(e))for(const r of e)he(r,t);else e==null||typeof e=="boolean"||t.push(e)},je=(e,t)=>{const r=e.key;return r??"_"+t},Je=e=>{const t=S.useRef(null);return t[j]||(t[j]=e())},se=e=>{const t=S.useRef(e);return N(()=>{t[j]=e},[e]),t},ze=S.memo(({ee:e,te:t,oe:r,ne:o,re:i,ie:l,se:u,le:y})=>{const n=S.useRef(null);N(()=>t(n[j],r),[r]);const f=S.useMemo(()=>{const p={contain:"layout style",position:i&&y?void 0:"absolute",[u?"height":"width"]:"100%",[u?"top":"left"]:0,[u?fe()?"right":"left":"top"]:o,visibility:!i||y?"visible":"hidden"};return u&&(p.display="inline-flex"),p},[o,i,y,u]);return B.jsx(l,typeof l=="string"?{ref:n,style:f,children:e}:{ref:n,style:f,index:r,children:e})}),Ce=(e,t)=>S.useMemo(()=>{if(typeof e=="function")return[e,t||0];const r=(o=>{const i=[];return he(o,i),i})(e);return[o=>r[o],r.length]},[e,t]),Ae=S.forwardRef(({children:e,count:t,overscan:r,itemSize:o,shift:i,horizontal:l,keepMounted:u,cache:y,startMargin:n=0,ssrCount:f,as:p="div",item:v="div",scrollRef:h,onScroll:w,onScrollEnd:I},M)=>{const[R,b]=Ce(e,t),k=S.useRef(null),g=S.useRef(!!f),P=se(w),V=se(I),[m,D,z,X]=Je(()=>{const c=!!l,d=Te(b,o,r,f,y,!o);return[d,Me(d,c),Le(d,c),c]});b!==m.C()&&m.J(5,[b,i]),n!==m.W()&&m.J(6,n);const[W,Y]=S.useReducer(m.p,void 0,m.p),[s,a]=m._(),E=m.H(),C=m.h(),x=[],T=c=>{const d=R(c);return B.jsx(ze,{te:D.K,oe:c,ne:m.R(c),re:m.I(c),ie:v,ee:d,se:X,le:g[j]},je(d,c))};N(()=>{g[j]=!1;const c=m.B(1,A=>{A?ye.flushSync(Y):Y()}),d=m.B(4,()=>{P[j]&&P[j](m.M())}),L=m.B(8,()=>{V[j]&&V[j]()}),_=A=>{D.G(A),z.D(A)};return h?ce(()=>{h[j]&&_(h[j])}):_(k[j].parentElement),()=>{c(),d(),L(),D.V(),z.V()}},[]),N(()=>{z.q()},[W]),S.useImperativeHandle(M,()=>({get cache(){return m.m()},get scrollOffset(){return m.M()},get scrollSize(){return Re(m)},get viewportSize(){return m.v()},findStartIndex:m.S,findEndIndex:m.$,getItemOffset:m.R,getItemSize:m.T,scrollToIndex:z.j,scrollTo:z.X,scrollBy:z.Y}),[]);for(let c=s,d=a;c<=d;c++)x.push(T(c));if(u){const c=[],d=[];le(u).forEach(L=>{L<s&&c.push(T(L)),L>a&&d.push(T(L))}),x.unshift(...c),x.push(...d)}return B.jsx(p,{ref:k,style:{contain:"strict",overflowAnchor:"none",overflow:"clip",flex:"none",position:"relative",width:X?C:"100%",height:X?"100%":C,pointerEvents:E?"none":void 0},children:x})}),He=S.forwardRef(({children:e,count:t,overscan:r,itemSize:o,shift:i,horizontal:l,keepMounted:u,reverse:y,cache:n,ssrCount:f,item:p,onScroll:v,onScrollEnd:h,style:w,...I},M)=>{const R=S.useRef(null),b=y&&!l;let k=B.jsx(Ae,{ref:M,scrollRef:b?R:void 0,count:t,overscan:r,itemSize:o,shift:i,horizontal:l,keepMounted:u,cache:n,ssrCount:f,item:p,onScroll:v,onScrollEnd:h,children:e});return b&&(k=B.jsx("div",{style:{display:"flex",flexDirection:"column",justifyContent:"flex-end",minHeight:"100%"},children:k})),B.jsx("div",{ref:R,...I,style:{display:l?"inline-block":"block",[l?"overflowX":"overflowY"]:"auto",contain:"strict",width:"100%",height:"100%",...w},children:k})}),Be=S.memo(({count:e,Component:t,handle:r})=>{const o=S.useRef(null);return S.useImperativeHandle(r,()=>({scrollToIndex:i=>{var l;(l=o.current)==null||l.scrollToIndex(i)}})),B.jsx(He,{ref:o,children:Array.from({length:e}).map((i,l)=>B.jsx(t,{index:l},l))})});Be.__docgenInfo={description:"",methods:[{name:"scrollToIndex",docblock:null,modifiers:[],params:[{name:"i",optional:!1,type:null}],returns:null}],displayName:"VirtuaList",props:{count:{required:!0,tsType:{name:"number"},description:""},Component:{required:!0,tsType:{name:"SimpleItem"},description:""},handle:{required:!1,tsType:{name:"Ref",elements:[{name:"signature",type:"object",raw:"{ scrollToIndex: (index: number) => void }",signature:{properties:[{key:"scrollToIndex",value:{name:"signature",type:"function",raw:"(index: number) => void",signature:{arguments:[{type:{name:"number"},name:"index"}],return:{name:"void"}},required:!0}}]}}],raw:"Ref<ListHandle>"},description:""}}};export{Be as V};

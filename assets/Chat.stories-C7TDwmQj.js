import{j as t}from"./jsx-runtime-D_zvdyIk.js";import{r}from"./iframe-BoI5bJ6Z.js";import{f as v}from"./chunk-4X5ZEQ5K-DKZdp5Hc.js";import{V as g}from"./Virtualizer-BZXmzB2E.js";import"./useLatestRef-CzhV_rsI.js";import"./useChildren-GZDHuoaX.js";import"./index-M_VcXNYe.js";import"./index-exaFy-fc.js";const A={component:g},b={border:"solid 1px #ccc",background:"#fff",margin:10,padding:10,borderRadius:8,whiteSpace:"pre-wrap"},w=({me:l,children:s})=>t.jsx("div",{style:{...b,...l?{background:"lightyellow",marginLeft:160}:{marginRight:160}},children:s}),z={name:"Chat",render:()=>{const l=r.useRef(0),s=({value:e=v.lorem.paragraphs(1),me:n}={})=>({id:l.current++,value:e,me:n}),[i,u]=r.useState(()=>Array.from({length:100},()=>s())),[c,y]=r.useState(!0),o=r.useRef(null),a=r.useRef(!1),f=r.useRef(!0),[d,m]=r.useState("Hello world!");r.useLayoutEffect(()=>{a.current=!1}),r.useEffect(()=>{if(!o.current)return;const e=o.current,n=i.length-1;f.current&&e.scrollToIndex(n,{align:"end"})},[i]),r.useEffect(()=>{if(!c)return;let e=!1,n=null;const h=()=>{n=setTimeout(()=>{e||(u(j=>[...j,s()]),h())},5e3)};return h(),()=>{e=!0,n&&clearTimeout(n)}},[c]);const p=!d.length,x=()=>{p||(f.current=!0,u(e=>[...e,s({value:d,me:!0})]),m(""))};return t.jsxs("div",{style:{width:"100vw",height:"100vh",display:"flex",flexDirection:"column"},children:[t.jsxs("div",{style:{overflowY:"auto",flex:1,overflowAnchor:"none",display:"flex",flexDirection:"column"},children:[t.jsx("div",{style:{flexGrow:1}}),t.jsx(g,{ref:o,shift:a.current,onScroll:e=>{o.current&&(f.current=e-o.current.scrollSize+o.current.viewportSize>=-1.5,e<100&&(a.current=!0,u(n=>[...Array.from({length:100},()=>s()),...n])))},children:i.map(e=>t.jsx(w,{me:e.me,children:e.value},e.id))})]}),t.jsxs("form",{style:{display:"flex",flexDirection:"column",margin:10},onSubmit:e=>{e.preventDefault(),e.stopPropagation(),x()},children:[t.jsx("textarea",{style:{flex:1},rows:6,value:d,onChange:e=>{m(e.target.value)},onKeyDown:e=>{e.code==="Enter"&&(e.ctrlKey||e.metaKey)&&(x(),e.preventDefault())}}),t.jsxs("div",{style:{display:"flex",flexDirection:"row",gap:8,justifyContent:"flex-end"},children:[t.jsxs("label",{children:[t.jsx("input",{type:"checkbox",checked:c,onChange:()=>{y(e=>!e)}}),"auto update"]}),t.jsx("button",{type:"button",onClick:()=>{o.current?.scrollTo(0)},children:"jump to top"}),t.jsx("button",{type:"submit",disabled:p,children:"submit"})]})]})]})}},K=["Default"];export{z as Default,K as __namedExportsOrder,A as default};

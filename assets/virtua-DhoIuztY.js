import{j as A}from"./jsx-runtime-D_zvdyIk.js";import{r as E}from"./iframe-D_zc_qzK.js";import{r as ye}from"./index-id_A3JE_.js";const X=null,{min:_,max:z,abs:re,floor:ge}=Math,se=(e,t,r)=>_(r,z(t,e)),ie=e=>[...e].sort(((t,r)=>t-r)),le=typeof queueMicrotask=="function"?queueMicrotask:e=>{Promise.resolve().then(e)},$=()=>{let e;return[new Promise((t=>{e=t})),e]},N=e=>{let t;return()=>(e&&(t=e(),e=void 0),t)},V=(e,t,r)=>{const n=r?"unshift":"push";for(let s=0;s<t;s++)e[n](-1);return e},ue=(e,t)=>{const r=e.t[t];return r===-1?e.o:r},we=(e,t,r)=>{const n=e.t[t]===-1;return e.t[t]=r,e.i=_(t,e.i),n},W=(e,t)=>{if(!e.l)return 0;if(e.i>=t)return e.u[t];e.i<0&&(e.u[0]=0,e.i=0);let r=e.i,n=e.u[r];for(;r<t;)n+=ue(e,r),e.u[++r]=n;return e.i=t,n},q=(e,t,r=0,n=e.l-1)=>{for(;r<=n;){const s=ge((r+n)/2);if(W(e,s)<=t){if(W(e,s+1)>t)return s;r=s+1}else n=s-1}return se(r,0,e.l-1)},ne=(e,t,r)=>{const n=t-e.l;return e.i=r?-1:_(t-1,e.i),e.l=t,n>0?(V(e.u,n),V(e.t,n,r),e.o*n):(e.u.splice(n),(r?e.t.splice(0,-n):e.t.splice(n)).reduce(((s,c)=>s-(c===-1?e.o:c)),0))},ae=typeof window<"u",ce=()=>document.documentElement,xe=e=>e.ownerDocument,be=e=>e.defaultView,fe=N((()=>!!ae&&getComputedStyle(ce()).direction==="rtl")),de=N((()=>!!/iP(hone|od|ad)/.test(navigator.userAgent)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>0)),ke=N((()=>"scrollBehavior"in ce().style)),Se=e=>z(e.h(),e.p()),Ee=(e,t=40,r=0,n,s=!1)=>{let c=!!r,f=1,i=0,m=0,o=0,a=0,b=0,S=0,w=0,x=0,R=X,M=[0,c?z(r-1,0):-1],k=0;const d=((h,v,p)=>({o:p?p[1]:v,t:p&&p[0]?V(p[0].slice(0,_(h,p[0].length)),z(0,h-p[0].length)):V([],h),l:h,i:-1,u:V([],h+1)}))(e,t,n),C=new Set,P=()=>o-m,B=()=>P()+b+a,y=(h,v)=>((p,T,l,u)=>{if(u=_(u,p.l-1),W(p,u)<=T){const g=q(p,l,u);return[q(p,T,u,g),g]}{const g=q(p,T,void 0,u);return[g,q(p,l,g)]}})(d,h,v,M[0]),D=()=>W(d,d.l),j=h=>W(d,h)-b,H=h=>ue(d,h),Y=(h,v=-1)=>d.t[h]===v,O=h=>{h&&(de()&&w!==0||R&&x===1?b+=h:a+=h)};return{v:()=>{C.clear()},m:()=>f,_:()=>(h=>[h.t.slice(),h.o])(d),S:(h=200)=>{if(!i||c)return M;let v,p;if(S)[v,p]=M;else{let T=z(0,B()),l=T+i;s||(h=z(0,h),w!==1&&(T-=h),w!==2&&(l+=h)),[v,p]=M=y(z(0,T),z(0,l)),R&&(v=_(v,R[0]),p=z(p,R[1]))}return[z(v,0),_(p,d.l-1)]},$:()=>q(d,B()),I:()=>q(d,B()+i),k:Y,R:j,T:H,M:()=>d.l,C:()=>o,H:()=>w!==0,p:()=>i,W:()=>m,h:D,O:()=>(S=a,a=0,[S,x===2]),B:(h,v)=>{const p=[h,v];return C.add(p),()=>{C.delete(p)}},J:(h,v)=>{let p,T,l=0;switch(h){case 1:{if(v===o&&x===0)break;const u=S;S=0;const g=v-o,L=re(g);u&&L<re(u)+1||x!==0||(w=g<0?2:1),c&&(c=!1),o=v,l=4;const J=P();J>=-i&&J<=D()&&(l+=1,T=L>i);break}case 2:l=8,w!==0&&(p=!0,l+=1),w=0,x=0,R=X;break;case 3:{const u=v.filter((([g,L])=>!Y(g,L)));if(!u.length)break;O(u.reduce(((g,[L,J])=>((x===2||(R&&x===1?L<R[0]:j(L+(w===0&&x===0?1:0))<P()))&&(g+=J-H(L)),g)),0));for(const[g,L]of u){const J=H(g),F=we(d,g,L);s&&(k+=F?L:L-J)}s&&i&&k>i&&(O(((g,L)=>{let J=0;const F=[];g.t.forEach(((te,ve)=>{te!==-1&&(F.push(te),ve<L&&J++)})),g.i=-1;const G=ie(F),ee=G.length,Z=ee/2|0,me=ee%2==0?(G[Z-1]+G[Z])/2:G[Z],pe=g.o;return((g.o=me)-pe)*z(L-J,0)})(d,q(d,B()))),s=!1),l=3,T=!0;break}case 4:i!==v&&(i||(T=!0),i=v,l=3);break;case 5:v[1]?(O(ne(d,v[0],!0)),x=2,l=1):(ne(d,v[0]),l=1);break;case 6:m=v;break;case 7:x=1;break;case 8:R=y(v,v+i),l=1}l&&(f=1+(2147483647&f),p&&b&&(a+=b,b=0),C.forEach((([u,g])=>{l&u&&g(T)})))}}},Q=setTimeout,K=(e,t)=>t&&fe()?-e:e,Re=(e,t,r,n,s,c)=>{const f=Date.now;let i=0,m=!1,o=!1,a=!1,b=!1;const S=(()=>{let k;const d=()=>{k!=X&&clearTimeout(k)},C=()=>{d(),k=Q((()=>{k=X,(()=>{if(m||o)return m=!1,void S();a=!1,e.J(2)})()}),150)};return C.A=d,C})(),w=()=>{i=f(),a&&(b=!0),e.J(1,n()),S()},x=k=>{if(m||!e.H()||k.ctrlKey)return;const d=f()-i;150>d&&50<d&&(r?k.deltaX:k.deltaY)&&(m=!0)},R=()=>{o=!0,a=b=!1},M=()=>{o=!1,de()&&(a=!0)};return t.addEventListener("scroll",w),t.addEventListener("wheel",x,{passive:!0}),t.addEventListener("touchstart",R,{passive:!0}),t.addEventListener("touchend",M,{passive:!0}),{L:()=>{t.removeEventListener("scroll",w),t.removeEventListener("wheel",x),t.removeEventListener("touchstart",R),t.removeEventListener("touchend",M),S.A()},D:()=>{const[k,d]=e.O();k&&(s(K(k,r),d,b),b=!1,d&&e.p()>e.h()&&e.J(1,n()))}}},Te=(e,t,r)=>{let n;return[async(s,c)=>{if(!await t())return;n&&n();const f=()=>{const[i,m]=$();return n=()=>{m(!1)},e.p()&&Q(n,150),[i,e.B(2,(()=>{m(!0)}))]};if(c&&ke())e.J(8,s()),le((async()=>{for(;;){let i=!0;for(let[a,b]=e.S();a<=b;a++)if(e.k(a)){i=!1;break}if(i)break;const[m,o]=f();try{if(!await m)return}finally{o()}}e.J(7),r(s(),c)}));else for(;;){const[i,m]=f();try{if(e.J(7),r(s()),!await i)return}finally{m()}}},()=>{n&&n()}]},Le=(e,t)=>{let r,n,s=$();const c=t?"scrollLeft":"scrollTop",f=t?"overflowX":"overflowY",[i,m]=Te(e,(()=>s[0]),((o,a)=>{o=K(o,t),a?r.scrollTo({[t?"left":"top"]:o,behavior:"smooth"}):r[c]=o}));return{P(o){r=o,n=Re(e,o,t,(()=>K(o[c],t)),((a,b,S)=>{if(S){const w=o.style,x=w[f];w[f]="hidden",Q((()=>{w[f]=x}))}o[c]=e.C()+a,b&&m()})),s[1](!0)},v(){n&&n.L(),s[1](!1),s=$()},V(o){i((()=>o))},X(o){o+=e.C(),i((()=>o))},Y(o,{align:a,smooth:b,offset:S=0}={}){if(o=se(o,0,e.M()-1),a==="nearest"){const w=e.R(o),x=e.C();if(w<x)a="start";else{if(!(w+e.T(o)>x+e.p()))return;a="end"}}i((()=>S+e.W()+e.R(o)+(a==="end"?e.T(o)-e.p():a==="center"?(e.T(o)-e.p())/2:0)),b)},j:()=>{n&&n.D()}}},Ie=e=>{let t;return{q(r){(t||(t=new(be(xe(r))).ResizeObserver(e))).observe(r)},G(r){t.unobserve(r)},L(){t&&t.disconnect()}}},Me=(e,t)=>{let r;const n=t?"width":"height",s=new WeakMap,c=Ie((f=>{const i=[];for(const{target:m,contentRect:o}of f)if(m.offsetParent)if(m===r)e.J(4,o[n]);else{const a=s.get(m);a!=X&&i.push([a,o[n]])}i.length&&e.J(3,i)}));return{U(f){c.q(r=f)},F:(f,i)=>(s.set(f,i),c.q(f),()=>{s.delete(f),c.G(f)}),v:c.L}},U=ae?E.useLayoutEffect:E.useEffect,I="current",he=(e,t)=>{if(Array.isArray(e))for(const r of e)he(r,t);else e==null||typeof e=="boolean"||t.push(e)},ze=(e,t)=>{const r=e.key;return r??"_"+t},Ce=e=>{const t=E.useRef(null);return t[I]||(t[I]=e())},oe=e=>{const t=E.useRef(e);return U((()=>{t[I]=e}),[e]),t},je=E.memo((({Z:e,ee:t,te:r,ne:n,oe:s,re:c,ie:f,se:i})=>{const m=E.useRef(null);U((()=>t(m[I],r)),[r]);const o=E.useMemo((()=>{const a={contain:"layout style",position:s&&i?void 0:"absolute",[f?"height":"width"]:"100%",[f?"top":"left"]:0,[f?fe()?"right":"left":"top"]:n,visibility:!s||i?"visible":"hidden"};return f&&(a.display="inline-flex"),a}),[n,s,i,f]);return A.jsx(c,typeof c=="string"?{ref:m,style:o,children:e}:{ref:m,style:o,index:r,children:e})})),Je=(e,t)=>E.useMemo((()=>{if(typeof e=="function")return[n=>e(t[n],n),t.length];const r=(n=>{const s=[];return he(n,s),s})(e);return[n=>r[n],r.length]}),[e,t]),Ae=E.forwardRef((({children:e,data:t,bufferSize:r,itemSize:n,shift:s,horizontal:c,keepMounted:f,cache:i,startMargin:m=0,ssrCount:o,as:a="div",item:b="div",scrollRef:S,onScroll:w,onScrollEnd:x},R)=>{const[M,k]=Je(e,t),d=E.useRef(null),C=E.useRef(!!o),P=oe(w),B=oe(x),[y,D,j,H]=Ce((()=>{const l=!!c,u=Ee(k,n,o,i,!n);return[u,Me(u,l),Le(u,l),l]}));k!==y.M()&&y.J(5,[k,s]),m!==y.W()&&y.J(6,m);const[Y,O]=E.useReducer(y.m,void 0,y.m),h=y.H(),v=y.h(),p=[],T=l=>{const u=M(l);return A.jsx(je,{ee:D.F,te:l,ne:y.R(l),oe:y.k(l),re:b,Z:u,ie:H,se:C[I]},ze(u,l))};if(U((()=>{C[I]=!1,y.B(1,(u=>{u?ye.flushSync(O):O()})),y.B(4,(()=>{P[I]&&P[I](y.C())})),y.B(8,(()=>{B[I]&&B[I]()}));const l=u=>{D.U(u),j.P(u)};return S?le((()=>{S[I]&&l(S[I])})):l(d[I].parentElement),()=>{y.v(),D.v(),j.v()}}),[]),U((()=>{j.j()}),[Y]),E.useImperativeHandle(R,(()=>({get cache(){return y._()},get scrollOffset(){return y.C()},get scrollSize(){return Se(y)},get viewportSize(){return y.p()},findStartIndex:y.$,findEndIndex:y.I,getItemOffset:y.R,getItemSize:y.T,scrollToIndex:j.Y,scrollTo:j.V,scrollBy:j.X})),[]),f){const l=new Set(f);for(let[u,g]=y.S(r);u<=g;u++)l.add(u);ie([...l]).forEach((u=>{p.push(T(u))}))}else for(let[l,u]=y.S(r);l<=u;l++)p.push(T(l));return A.jsx(a,{ref:d,style:{contain:"size paint style",overflowAnchor:"none",flex:"none",position:"relative",width:H?v:"100%",height:H?"100%":v,pointerEvents:h?"none":void 0},children:p})})),Be=E.forwardRef((({children:e,data:t,bufferSize:r,itemSize:n,shift:s,horizontal:c,keepMounted:f,reverse:i,cache:m,ssrCount:o,item:a,onScroll:b,onScrollEnd:S,style:w,...x},R)=>{const M=E.useRef(null),k=i&&!c;let d=A.jsx(Ae,{ref:R,scrollRef:k?M:void 0,data:t,bufferSize:r,itemSize:n,shift:s,horizontal:c,keepMounted:f,cache:m,ssrCount:o,item:a,onScroll:b,onScrollEnd:S,children:e});return k&&(d=A.jsx("div",{style:{display:"flex",flexDirection:"column",justifyContent:"flex-end",minHeight:"100%",overflow:"clip"},children:d})),A.jsx("div",{ref:M,...x,style:{display:c?"inline-block":"block",[c?"overflowX":"overflowY"]:"auto",contain:"strict",width:"100%",height:"100%",...w},children:d})})),He=E.memo(({count:e,Component:t,handle:r})=>{const n=E.useRef(null);return E.useImperativeHandle(r,()=>({scrollToIndex:s=>{n.current?.scrollToIndex(s)}})),A.jsx(Be,{ref:n,children:Array.from({length:e}).map((s,c)=>A.jsx(t,{index:c},c))})});He.__docgenInfo={description:"",methods:[{name:"scrollToIndex",docblock:null,modifiers:[],params:[{name:"i",optional:!1,type:null}],returns:null}],displayName:"VirtuaList",props:{count:{required:!0,tsType:{name:"number"},description:""},Component:{required:!0,tsType:{name:"SimpleItem"},description:""},handle:{required:!1,tsType:{name:"Ref",elements:[{name:"signature",type:"object",raw:"{ scrollToIndex: (index: number) => void }",signature:{properties:[{key:"scrollToIndex",value:{name:"signature",type:"function",raw:"(index: number) => void",signature:{arguments:[{type:{name:"number"},name:"index"}],return:{name:"void"}},required:!0}}]}}],raw:"Ref<ListHandle>"},description:""}}};export{He as V};

import{j as A}from"./jsx-runtime-D_zvdyIk.js";import{r as E}from"./iframe-BRObDRYi.js";import{r as ge}from"./index-BYuJ39Ua.js";const J=null,{min:_,max:j,abs:ne,floor:xe}=Math,ie=(e,t,r)=>_(r,j(t,e)),le=e=>[...e].sort(((t,r)=>t-r)),ae=typeof queueMicrotask=="function"?queueMicrotask:e=>{Promise.resolve().then(e)},F=()=>{let e;return[new Promise((t=>{e=t})),e]},Q=e=>{let t;return()=>(e&&(t=e(),e=void 0),t)},Y=(e,t,r)=>{const n=r?"unshift":"push";for(let s=0;s<t;s++)e[n](-1);return e},ue=(e,t)=>{const r=e.t[t];return r===-1?e.o:r},we=(e,t,r)=>{const n=e.t[t]===-1;return e.t[t]=r,e.i=_(t,e.i),n},U=(e,t)=>{if(!e.l)return 0;if(e.i>=t)return e.u[t];e.i<0&&(e.u[0]=0,e.i=0);let r=e.i,n=e.u[r];for(;r<t;)n+=ue(e,r),e.u[++r]=n;return e.i=t,n},P=(e,t,r=0,n=e.l-1)=>{let s=r;for(;r<=n;){const i=xe((r+n)/2);U(e,i)<=t?(s=i,r=i+1):n=i-1}return ie(s,0,e.l-1)},oe=(e,t,r)=>{const n=t-e.l;return e.i=r?-1:_(t-1,e.i),e.l=t,n>0?(Y(e.u,n),Y(e.t,n,r),e.o*n):(e.u.splice(n),(r?e.t.splice(0,-n):e.t.splice(n)).reduce(((s,i)=>s-(i===-1?e.o:i)),0))},ce=typeof window<"u",fe=()=>document.documentElement,be=e=>e.ownerDocument,ke=e=>e.defaultView,de=Q((()=>!!ce&&getComputedStyle(fe()).direction==="rtl")),he=Q((()=>!!/iP(hone|od|ad)/.test(navigator.userAgent)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>0)),Se=Q((()=>"scrollBehavior"in fe().style)),Re=e=>j(e.h(),e.p()),Ee=(e,t=40,r=0,n,s=!1)=>{let i=!!r,f=1,l=0,h=0,o=0,u=0,w=0,S=0,g=0,x=0,I=J,B=[0,i?j(r-1,0):-1],b=0,R=!1;const k=((c,m,v)=>({o:m,t:v?Y(v.slice(0,_(c,v.length)),j(0,c-v.length)):Y([],c),l:c,i:-1,u:Y([],c+1)}))(e,n?n[1]:t,n&&n[0]),H=new Set,q=()=>o-h,p=()=>q()+w+u,D=(c,m)=>((v,d,a,T)=>{if(T=_(T,v.l-1),U(v,T)<=d){const y=P(v,a,T);return[P(v,d,T,y),y]}{const y=P(v,d,void 0,T);return[y,P(v,a,y)]}})(k,c,m,B[0]),z=()=>U(k,k.l),O=c=>U(k,c)-w,W=c=>ue(k,c),V=(c,m=-1)=>k.t[c]===m,X=c=>{c&&(he()&&g!==0||I&&x===1?w+=c:u+=c)};return{v:()=>{H.clear()},m:()=>f,_:()=>(c=>[c.t.slice(),c.o])(k),S:(c=200)=>{if(!R||i)return B;let m,v;if(S)[m,v]=B;else{let d=j(0,p()),a=d+l;s||(c=j(0,c),g!==1&&(d-=c),g!==2&&(a+=c)),[m,v]=B=D(j(0,d),j(0,a)),I&&(m=_(m,I[0]),v=j(v,I[1]))}return[j(m,0),_(v,k.l-1)]},$:c=>P(k,c-h),I:V,k:O,R:W,T:()=>k.l,C:()=>o,M:()=>g!==0,p:()=>l,H:()=>h,h:z,O:()=>(S=u,u=0,[S,x===2]),W:(c,m)=>{const v=[c,m];return H.add(v),()=>{H.delete(v)}},B:(c,m)=>{let v,d,a=0;switch(c){case 1:{if(m===o&&x===0)break;const T=S;S=0;const y=m-o,L=ne(y);T&&L<ne(T)+1||x!==0||(g=y<0?2:1),i&&(i=!1),o=m,a=4;const C=q();C>=-l&&C<=z()&&(a+=1,d=L>l);break}case 2:a=8,g!==0&&(v=!0,a+=1),g=0,x=0,I=J;break;case 3:{const T=m.filter((([y,L])=>!V(y,L)));if(!T.length)break;X(T.reduce(((y,[L,C])=>((x===2||(I&&x===1?L<I[0]:O(L+(g===0&&x===0?1:0))<q()))&&(y+=C-W(L)),y)),0));for(const[y,L]of T){const C=W(y),N=we(k,y,L);s&&(b+=N?L:L-C)}s&&l&&b>l&&(X(((y,L)=>{let C=0;const N=[];y.t.forEach(((re,ye)=>{re!==-1&&(N.push(re),ye<L&&C++)})),y.i=-1;const G=le(N),te=G.length,$=te/2|0,pe=te%2==0?(G[$-1]+G[$])/2:G[$],ve=y.o;return((y.o=pe)-ve)*j(L-C,0)})(k,P(k,p()))),s=!1),a=3,d=!0;break}case 4:l!==m&&(l||(R=d=!0),l=m,a=3);break;case 5:m[1]?(X(oe(k,m[0],!0)),x=2,a=1):(oe(k,m[0]),a=1);break;case 6:h=m;break;case 7:x=1;break;case 8:I=D(m,m+l),a=1}a&&(f=1+(2147483647&f),v&&w&&(u+=w,w=0),H.forEach((([T,y])=>{a&T&&y(d)})))}}},ee=setTimeout,K=(e,t)=>t&&de()?-e:e,Te=(e,t,r,n,s,i)=>{const f=Date.now;let l=0,h=!1,o=!1,u=!1,w=!1;const S=(()=>{let b;const R=()=>{b!=J&&clearTimeout(b)},k=()=>{R(),b=ee((()=>{b=J,(()=>{if(h||o)return h=!1,void S();u=!1,e.B(2)})()}),150)};return k.J=R,k})(),g=()=>{l=f(),u&&(w=!0),e.B(1,n()),S()},x=b=>{if(h||!e.M()||b.ctrlKey)return;const R=f()-l;150>R&&50<R&&(r?b.deltaX:b.deltaY)&&(h=!0)},I=()=>{o=!0,u=w=!1},B=()=>{o=!1,he()&&(u=!0)};return t.addEventListener("scroll",g),t.addEventListener("wheel",x,{passive:!0}),t.addEventListener("touchstart",I,{passive:!0}),t.addEventListener("touchend",B,{passive:!0}),{A:()=>{t.removeEventListener("scroll",g),t.removeEventListener("wheel",x),t.removeEventListener("touchstart",I),t.removeEventListener("touchend",B),S.J()},L:()=>{const[b,R]=e.O();b&&(s(b,R,w),w=!1,R&&e.p()>e.h()&&e.B(1,n()))}}},Ie=(e,t,r)=>{let n;return[async(s,i)=>{if(!await t())return;n&&n();const f=()=>{const[l,h]=F();return n=()=>{h(!1)},e.p()&&ee(n,150),[l,e.W(2,(()=>{h(!0)}))]};if(i&&Se())e.B(8,s()),ae((async()=>{for(;;){let l=!0;for(let[u,w]=e.S();u<=w;u++)if(e.I(u)){l=!1;break}if(l)break;const[h,o]=f();try{if(!await h)return}finally{o()}}e.B(7),r(s(),i)}));else for(;;){const[l,h]=f();try{if(e.B(7),r(s()),!await l)return}finally{h()}}},()=>{n&&n()}]},Le=(e,t)=>{let r,n,s=F();const i=t?"scrollLeft":"scrollTop",f=t?"overflowX":"overflowY",[l,h]=Ie(e,(()=>s[0]),((o,u)=>{o=K(o,t),u?r.scrollTo({[t?"left":"top"]:o,behavior:"smooth"}):r[i]=o}));return{D(o){r=o,n=Te(e,o,t,(()=>K(o[i],t)),((u,w,S)=>{if(S){const g=o.style,x=g[f];g[f]="hidden",ee((()=>{g[f]=x}))}o[i]=K(e.C()+u,t),w&&h()})),s[1](!0)},v(){n&&n.A(),s[1](!1),s=F()},P(o){l((()=>o))},V(o){o+=e.C(),l((()=>o))},X(o,{align:u,smooth:w,offset:S=0}={}){if(o=ie(o,0,e.T()-1),u==="nearest"){const g=e.k(o),x=e.C();if(g<x)u="start";else{if(!(g+e.R(o)>x+e.p()))return;u="end"}}l((()=>S+e.H()+e.k(o)+(u==="end"?e.R(o)-e.p():u==="center"?(e.R(o)-e.p())/2:0)),w)},Y:()=>{n&&n.L()}}},Me=e=>{let t;return{j(r){(t||(t=new(ke(be(r))).ResizeObserver(e))).observe(r)},q(r){t.unobserve(r)},A(){t&&t.disconnect()}}},Be=(e,t)=>{let r;const n=t?"width":"height",s=new WeakMap,i=Me((f=>{const l=[];for(const{target:h,contentRect:o}of f)if(h.offsetParent)if(h===r)e.B(4,o[n]);else{const u=s.get(h);u!=J&&l.push([u,o[n]])}l.length&&e.B(3,l)}));return{G(f){i.j(r=f)},U:(f,l)=>(s.set(f,l),i.j(f),()=>{s.delete(f),i.q(f)}),v:i.A}},Z=ce?E.useLayoutEffect:E.useEffect,M="current",me=(e,t)=>{if(Array.isArray(e))for(const r of e)me(r,t);else e==null||typeof e=="boolean"||t.push(e)},je=(e,t)=>{const r=e.key;return r??"_"+t},ze=e=>{const t=E.useRef(null);return t[M]||(t[M]=e())},se=e=>{const t=E.useRef(e);return Z((()=>{t[M]=e}),[e]),t},Ce=E.memo((({N:e,Z:t,ee:r,te:n,oe:s,ne:i,re:f,ie:l})=>{const h=E.useRef(null);Z((()=>t(h[M],r)),[r]);const o=E.useMemo((()=>{const u={contain:"layout style",position:s&&l?void 0:"absolute",[f?"height":"width"]:"100%",[f?"top":"left"]:0,[f?de()?"right":"left":"top"]:n,visibility:!s||l?void 0:"hidden"};return f&&(u.display="inline-flex"),u}),[n,s,l,f]);return A.jsx(i,typeof i=="string"?{ref:h,style:o,children:e}:{ref:h,style:o,index:r,children:e})})),Ae=(e,t)=>E.useMemo((()=>{if(typeof e=="function")return[n=>e(t[n],n),t.length];const r=(n=>{const s=[];return me(n,s),s})(e);return[n=>r[n],r.length]}),[e,t]),He=E.forwardRef((({children:e,data:t,bufferSize:r,itemSize:n,shift:s,horizontal:i,keepMounted:f,cache:l,startMargin:h=0,ssrCount:o,as:u="div",item:w="div",scrollRef:S,onScroll:g,onScrollEnd:x},I)=>{const[B,b]=Ae(e,t),R=E.useRef(null),k=E.useRef(!!o),H=se(g),q=se(x),[p,D,z,O]=ze((()=>{const d=!!i,a=Ee(b,n,o,l,!n);return[a,Be(a,d),Le(a,d),d]}));b!==p.T()&&p.B(5,[b,s]),h!==p.H()&&p.B(6,h);const[W,V]=E.useReducer(p.m,void 0,p.m),X=p.M(),c=p.h(),m=[],v=d=>{const a=B(d);return A.jsx(Ce,{Z:D.U,ee:d,te:p.k(d),oe:p.I(d),ne:w,N:a,re:O,ie:k[M]},je(a,d))};if(Z((()=>{k[M]=!1,p.W(1,(a=>{a?ge.flushSync(V):V()})),p.W(4,(()=>{H[M]&&H[M](p.C())})),p.W(8,(()=>{q[M]&&q[M]()}));const d=a=>{D.G(a),z.D(a)};return S?ae((()=>{S[M]&&d(S[M])})):d(R[M].parentElement),()=>{p.v(),D.v(),z.v()}}),[]),Z((()=>{z.Y()}),[W]),E.useImperativeHandle(I,(()=>({get cache(){return p._()},get scrollOffset(){return p.C()},get scrollSize(){return Re(p)},get viewportSize(){return p.p()},findItemIndex:p.$,getItemOffset:p.k,getItemSize:p.R,scrollToIndex:z.X,scrollTo:z.P,scrollBy:z.V})),[]),f){const d=new Set(f);for(let[a,T]=p.S(r);a<=T;a++)d.add(a);le([...d]).forEach((a=>{m.push(v(a))}))}else for(let[d,a]=p.S(r);d<=a;d++)m.push(v(d));return A.jsx(u,{ref:R,style:{contain:"size style",overflowAnchor:"none",flex:"none",position:"relative",width:O?c:"100%",height:O?"100%":c,pointerEvents:X?"none":void 0},children:m})})),_e=E.forwardRef((({children:e,data:t,bufferSize:r,itemSize:n,shift:s,horizontal:i,keepMounted:f,reverse:l,cache:h,ssrCount:o,item:u,onScroll:w,onScrollEnd:S,style:g,...x},I)=>{const B=E.useRef(null),b=l&&!i;let R=A.jsx(He,{ref:I,scrollRef:b?B:void 0,data:t,bufferSize:r,itemSize:n,shift:s,horizontal:i,keepMounted:f,cache:h,ssrCount:o,item:u,onScroll:w,onScrollEnd:S,children:e});return b&&(R=A.jsx("div",{style:{display:"flex",flexDirection:"column",justifyContent:"flex-end",minHeight:"100%",overflow:"clip"},children:R})),A.jsx("div",{ref:B,...x,style:{display:i?"inline-block":"block",[i?"overflowX":"overflowY"]:"auto",contain:"strict",width:"100%",height:"100%",...g},children:R})})),qe=E.memo(({count:e,Component:t,handle:r})=>{const n=E.useRef(null);return E.useImperativeHandle(r,()=>({scrollToIndex:s=>{n.current?.scrollToIndex(s)}})),A.jsx(_e,{ref:n,children:Array.from({length:e}).map((s,i)=>A.jsx(t,{index:i},i))})});qe.__docgenInfo={description:"",methods:[{name:"scrollToIndex",docblock:null,modifiers:[],params:[{name:"i",optional:!1,type:null}],returns:null}],displayName:"VirtuaList",props:{count:{required:!0,tsType:{name:"number"},description:""},Component:{required:!0,tsType:{name:"SimpleItem"},description:""},handle:{required:!1,tsType:{name:"Ref",elements:[{name:"signature",type:"object",raw:"{ scrollToIndex: (index: number) => void }",signature:{properties:[{key:"scrollToIndex",value:{name:"signature",type:"function",raw:"(index: number) => void",signature:{arguments:[{type:{name:"number"},name:"index"}],return:{name:"void"}},required:!0}}]}}],raw:"Ref<ListHandle>"},description:""}}};export{qe as V};

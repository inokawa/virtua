import{m as A,c as O,l as a,o as R,n as v,p as C,a as g,q as _,r as I,F as V,D as L,v as N}from"./iframe-Dhr-Rm2n.js";import{c as w,a as y,U as D,b as M,d as U,i as F,A as H,s as P,e as k,L as G,g as j,f as B}from"./utils-BX4zUp_t.js";const K=t=>{let d;const{itemSize:S,horizontal:f=!1,cache:E}=t;t=A({as:"div"},t);const e=w(t.data.length,S,void 0,E,!S),u=k(e,f),c=y(e,f),[l,T]=O(e.$getStateVersion());e.$subscribe(D,()=>{T(e.$getStateVersion())}),e.$subscribe(M,()=>{t.onScroll?.(e.$getScrollOffset())}),e.$subscribe(U,()=>{t.onScrollEnd?.()});const m=a(n=>{l();const r=e.$getRange(t.bufferSize);return n&&F(n,r)?n:r}),z=a(()=>l()&&e.$isScrolling()),$=a(()=>l()&&e.$getTotalSize());R(()=>{t.ref&&t.ref({get cache(){return e.$getCacheSnapshot()},get scrollOffset(){return e.$getScrollOffset()},get scrollSize(){return j(e)},get viewportSize(){return e.$getViewportSize()},findStartIndex:e.$findStartIndex,findEndIndex:e.$findEndIndex,getItemOffset:e.$getItemOffset,getItemSize:e.$getItemSize,scrollToIndex:c.$scrollToIndex,scrollTo:c.$scrollTo,scrollBy:c.$scrollBy});const n=t.scrollRef||d.parentElement;u.$observeRoot(n),c.$observe(n),N(()=>{t.ref&&t.ref(),e.$dispose(),u.$dispose(),c.$dispose()})}),v(_(()=>t.startMargin||0,n=>{n!==e.$getStartSpacerSize()&&e.$update(B,n)})),C(_(l,()=>{c.$fixScrollJump()}));const h=a(()=>{const n=t.data.length;I(()=>{n!==e.$getItemsLength()&&e.$update(H,[n,t.shift])});const r=[],i=[];if(t.keepMounted){const o=new Set(t.keepMounted);for(let[s,b]=m();s<=b;s++)o.add(s);P([...o]).forEach(s=>{r.push(t.data[s]),i.push(s)})}else for(let[o,s]=m();o<=s;o++)r.push(t.data[o]),i.push(o);return{_items:r,_indexes:i}}),x=(n,r)=>{const i=a(()=>(l(),e.$getItemOffset(r()))),o=a(()=>(l(),e.$isUnmeasuredItem(r()))),s=a(()=>I(()=>t.children(n,r)));return g(G,{get _as(){return t.item},get _index(){return r()},get _resizer(){return u.$observeItem},get _offset(){return i()},get _hide(){return o()},get _children(){return s()},_isHorizontal:f})};return g(L,{get component(){return t.as},ref(n){var r=d;typeof r=="function"?r(n):d=n},get style(){return{contain:"size paint style","overflow-anchor":"none",overflow:"clip",flex:"none",position:"relative",width:f?$()+"px":"100%",height:f?"100%":$()+"px","pointer-events":z()?"none":void 0}},get children(){return g(V,{get each(){return h()._items},children:(n,r)=>{const i=a(()=>h()._indexes[r()]);return x(n,i)}})}})};export{K as V};

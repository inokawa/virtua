import{$ as h,a as k,g as E,b as D,c as F,d as w,m as P,r as I,o as C,E as L}from"./web-DSIcfvkV.js";var N=Object.defineProperty,T=(e,r)=>{for(var n in r)N(e,n,{get:r[n],enumerable:!0})};const S=Symbol("store-raw"),_=Symbol("store-node"),f=Symbol("store-has"),m=Symbol("store-self");function q(e){let r=e[h];if(!r&&(Object.defineProperty(e,h,{value:r=new Proxy(e,x)}),!Array.isArray(e))){const n=Object.keys(e),t=Object.getOwnPropertyDescriptors(e);for(let i=0,s=n.length;i<s;i++){const o=n[i];t[o].get&&Object.defineProperty(e,o,{enumerable:t[o].enumerable,get:t[o].get.bind(r)})}}return r}function p(e){let r;return e!=null&&typeof e=="object"&&(e[h]||!(r=Object.getPrototypeOf(e))||r===Object.prototype||Array.isArray(e))}function g(e,r=new Set){let n,t,i,s;if(n=e!=null&&e[S])return n;if(!p(e)||r.has(e))return e;if(Array.isArray(e)){Object.isFrozen(e)?e=e.slice(0):r.add(e);for(let o=0,a=e.length;o<a;o++)i=e[o],(t=g(i,r))!==i&&(e[o]=t)}else{Object.isFrozen(e)?e=Object.assign({},e):r.add(e);const o=Object.keys(e),a=Object.getOwnPropertyDescriptors(e);for(let c=0,l=o.length;c<l;c++)s=o[c],!a[s].get&&(i=e[s],(t=g(i,r))!==i&&(e[s]=t))}return e}function b(e,r){let n=e[r];return n||Object.defineProperty(e,r,{value:n=Object.create(null)}),n}function v(e,r,n){if(e[r])return e[r];const[t,i]=F(n,{equals:!1,internal:!0});return t.$=i,e[r]=t}function U(e,r){const n=Reflect.getOwnPropertyDescriptor(e,r);return!n||n.get||!n.configurable||r===h||r===_||(delete n.value,delete n.writable,n.get=()=>e[h][r]),n}function j(e){E()&&v(b(e,_),m)()}function K(e){return j(e),Reflect.ownKeys(e)}const x={get(e,r,n){if(r===S)return e;if(r===h)return n;if(r===k)return j(e),n;const t=b(e,_),i=t[r];let s=i?i():e[r];if(r===_||r===f||r==="__proto__")return s;if(!i){const o=Object.getOwnPropertyDescriptor(e,r);E()&&(typeof s!="function"||e.hasOwnProperty(r))&&!(o&&o.get)&&(s=v(t,r,s)())}return p(s)?q(s):s},has(e,r){return r===S||r===h||r===k||r===_||r===f||r==="__proto__"?!0:(E()&&v(b(e,f),r)(),r in e)},set(){return!0},deleteProperty(){return!0},ownKeys:K,getOwnPropertyDescriptor:U};function A(e,r,n,t=!1){if(!t&&e[r]===n)return;const i=e[r],s=e.length;n===void 0?(delete e[r],e[f]&&e[f][r]&&i!==void 0&&e[f][r].$()):(e[r]=n,e[f]&&e[f][r]&&i===void 0&&e[f][r].$());let o=b(e,_),a;if((a=v(o,r,i))&&a.$(()=>n),Array.isArray(e)&&e.length!==s){for(let c=e.length;c<s;c++)(a=o[c])&&a.$();(a=v(o,"length",s))&&a.$(e.length)}(a=o[m])&&a.$()}function W(e,r){const n=Object.keys(r);for(let t=0;t<n.length;t+=1){const i=n[t];A(e,i,r[i])}}function Q(e,r){if(typeof r=="function"&&(r=r(e)),r=g(r),Array.isArray(r)){if(e===r)return;let n=0,t=r.length;for(;n<t;n++){const i=r[n];e[n]!==i&&A(e,n,i)}A(e,"length",t)}else W(e,r)}function y(e,r,n=[]){let t,i=e;if(r.length>1){t=r.shift();const o=typeof t,a=Array.isArray(e);if(Array.isArray(t)){for(let c=0;c<t.length;c++)y(e,[t[c]].concat(r),n);return}else if(a&&o==="function"){for(let c=0;c<e.length;c++)t(e[c],c)&&y(e,[c].concat(r),n);return}else if(a&&o==="object"){const{from:c=0,to:l=e.length-1,by:u=1}=t;for(let d=c;d<=l;d+=u)y(e,[d].concat(r),n);return}else if(r.length>1){y(e[t],r,[t].concat(n));return}i=e[t],n=[t].concat(n)}let s=r[0];typeof s=="function"&&(s=s(i,n),s===i)||t===void 0&&s==null||(s=g(s),t===void 0||p(i)&&p(s)&&!Array.isArray(s)?W(i,s):A(e,t,s))}function V(...[e,r]){const n=g(e||{}),t=Array.isArray(n),i=q(n);function s(...o){D(()=>{t&&o.length===1?Q(n,o[0]):y(n,o)})}return[i,s]}var z={};T(z,{decorators:()=>oe,parameters:()=>se,render:()=>ie,renderToCanvas:()=>te});var B=new Error("request for lock canceled"),M=function(e,r,n,t){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(u){try{l(t.next(u))}catch(d){o(d)}}function c(u){try{l(t.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((t=t.apply(e,r||[])).next())})},H=class{constructor(e,r=B){this._value=e,this._cancelError=r,this._queue=[],this._weightedWaiters=[]}acquire(e=1,r=0){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return new Promise((n,t)=>{const i={resolve:n,reject:t,weight:e,priority:r},s=R(this._queue,o=>r<=o.priority);s===-1&&e<=this._value?this._dispatchItem(i):this._queue.splice(s+1,0,i)})}runExclusive(e){return M(this,arguments,void 0,function*(r,n=1,t=0){const[i,s]=yield this.acquire(n,t);try{return yield r(i)}finally{s()}})}waitForUnlock(e=1,r=0){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return this._couldLockImmediately(e,r)?Promise.resolve():new Promise(n=>{this._weightedWaiters[e-1]||(this._weightedWaiters[e-1]=[]),X(this._weightedWaiters[e-1],{resolve:n,priority:r})})}isLocked(){return this._value<=0}getValue(){return this._value}setValue(e){this._value=e,this._dispatchQueue()}release(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);this._value+=e,this._dispatchQueue()}cancel(){this._queue.forEach(e=>e.reject(this._cancelError)),this._queue=[]}_dispatchQueue(){for(this._drainUnlockWaiters();this._queue.length>0&&this._queue[0].weight<=this._value;)this._dispatchItem(this._queue.shift()),this._drainUnlockWaiters()}_dispatchItem(e){const r=this._value;this._value-=e.weight,e.resolve([r,this._newReleaser(e.weight)])}_newReleaser(e){let r=!1;return()=>{r||(r=!0,this.release(e))}}_drainUnlockWaiters(){if(this._queue.length===0)for(let e=this._value;e>0;e--){const r=this._weightedWaiters[e-1];r&&(r.forEach(n=>n.resolve()),this._weightedWaiters[e-1]=[])}else{const e=this._queue[0].priority;for(let r=this._value;r>0;r--){const n=this._weightedWaiters[r-1];if(!n)continue;const t=n.findIndex(i=>i.priority<=e);(t===-1?n:n.splice(0,t)).forEach(i=>i.resolve())}}}_couldLockImmediately(e,r){return(this._queue.length===0||this._queue[0].priority<r)&&e<=this._value}};function X(e,r){const n=R(e,t=>r.priority<=t.priority);e.splice(n+1,0,r)}function R(e,r){for(let n=e.length-1;n>=0;n--)if(r(e[n]))return n;return-1}var[$,O]=V({}),Y=(e,r)=>{const n=r.canvasElement.id;return r.args=$[n].args,w(e,P(()=>r.args))},G=e=>{O({[e]:{args:{},rendered:!1,disposeFn:()=>{}}})},J=e=>{var r,n;(n=(r=$[e])==null?void 0:r.disposeFn)==null||n.call(r)},Z=e=>{J(e),G(e)},ee=e=>{var r;return!!((r=$[e])!=null&&r.rendered)},re=(e,r,n)=>{const{storyContext:t,storyFn:i,showMain:s,showException:o}=r;O(e,"rendered",!0);const a=()=>{const c=i;return C(()=>{s()}),w(L,{fallback:l=>(o(l),l),get children(){return w(c,t)}})};return I(()=>w(a,{}),n)},ne=new H(1);async function te(e,r){const{storyContext:n,forceRemount:t}=e,i=n.canvasElement.id;t&&Z(i),O(i,"args",n.args),ee(i)===!1&&await ne.runExclusive(async()=>{const s=re(i,e,r);O(i,o=>({...o,disposeFn:s}))})}var ie=(e,r)=>{const{id:n,component:t}=r;if(!t)throw new Error(`Unable to render story ${n} as the component annotation is missing from the default export`);return w(t,P(()=>r.args))},se={renderer:"solid"},oe=[Y];export{oe as decorators,se as parameters,ie as render,te as renderToCanvas};

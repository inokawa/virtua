import{$ as h,a as $,g as q,b as R,c as F,d as w,m as P,r as I,o as C,E as L}from"./web-DSIcfvkV.js";var N=Object.defineProperty;(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(r,t)=>(typeof require<"u"?require:r)[t]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var T=(e,r)=>{for(var t in r)N(e,t,{get:r[t],enumerable:!0})};const E=Symbol("store-raw"),y=Symbol("store-node"),f=Symbol("store-has"),k=Symbol("store-self");function m(e){let r=e[h];if(!r&&(Object.defineProperty(e,h,{value:r=new Proxy(e,K)}),!Array.isArray(e))){const t=Object.keys(e),n=Object.getOwnPropertyDescriptors(e);for(let i=0,o=t.length;i<o;i++){const s=t[i];n[s].get&&Object.defineProperty(e,s,{enumerable:n[s].enumerable,get:n[s].get.bind(r)})}}return r}function b(e){let r;return e!=null&&typeof e=="object"&&(e[h]||!(r=Object.getPrototypeOf(e))||r===Object.prototype||Array.isArray(e))}function g(e,r=new Set){let t,n,i,o;if(t=e!=null&&e[E])return t;if(!b(e)||r.has(e))return e;if(Array.isArray(e)){Object.isFrozen(e)?e=e.slice(0):r.add(e);for(let s=0,u=e.length;s<u;s++)i=e[s],(n=g(i,r))!==i&&(e[s]=n)}else{Object.isFrozen(e)?e=Object.assign({},e):r.add(e);const s=Object.keys(e),u=Object.getOwnPropertyDescriptors(e);for(let l=0,a=s.length;l<a;l++)o=s[l],!u[o].get&&(i=e[o],(n=g(i,r))!==i&&(e[o]=n))}return e}function v(e,r){let t=e[r];return t||Object.defineProperty(e,r,{value:t=Object.create(null)}),t}function p(e,r,t){if(e[r])return e[r];const[n,i]=F(t,{equals:!1,internal:!0});return n.$=i,e[r]=n}function U(e,r){const t=Reflect.getOwnPropertyDescriptor(e,r);return!t||t.get||!t.configurable||r===h||r===y||(delete t.value,delete t.writable,t.get=()=>e[h][r]),t}function j(e){q()&&p(v(e,y),k)()}function x(e){return j(e),Reflect.ownKeys(e)}const K={get(e,r,t){if(r===E)return e;if(r===h)return t;if(r===$)return j(e),t;const n=v(e,y),i=n[r];let o=i?i():e[r];if(r===y||r===f||r==="__proto__")return o;if(!i){const s=Object.getOwnPropertyDescriptor(e,r);q()&&(typeof o!="function"||e.hasOwnProperty(r))&&!(s&&s.get)&&(o=p(n,r,o)())}return b(o)?m(o):o},has(e,r){return r===E||r===h||r===$||r===y||r===f||r==="__proto__"?!0:(q()&&p(v(e,f),r)(),r in e)},set(){return!0},deleteProperty(){return!0},ownKeys:x,getOwnPropertyDescriptor:U};function A(e,r,t,n=!1){if(!n&&e[r]===t)return;const i=e[r],o=e.length;t===void 0?(delete e[r],e[f]&&e[f][r]&&i!==void 0&&e[f][r].$()):(e[r]=t,e[f]&&e[f][r]&&i===void 0&&e[f][r].$());let s=v(e,y),u;if((u=p(s,r,i))&&u.$(()=>t),Array.isArray(e)&&e.length!==o){for(let l=e.length;l<o;l++)(u=s[l])&&u.$();(u=p(s,"length",o))&&u.$(e.length)}(u=s[k])&&u.$()}function W(e,r){const t=Object.keys(r);for(let n=0;n<t.length;n+=1){const i=t[n];A(e,i,r[i])}}function Q(e,r){if(typeof r=="function"&&(r=r(e)),r=g(r),Array.isArray(r)){if(e===r)return;let t=0,n=r.length;for(;t<n;t++){const i=r[t];e[t]!==i&&A(e,t,i)}A(e,"length",n)}else W(e,r)}function _(e,r,t=[]){let n,i=e;if(r.length>1){n=r.shift();const s=typeof n,u=Array.isArray(e);if(Array.isArray(n)){for(let l=0;l<n.length;l++)_(e,[n[l]].concat(r),t);return}else if(u&&s==="function"){for(let l=0;l<e.length;l++)n(e[l],l)&&_(e,[l].concat(r),t);return}else if(u&&s==="object"){const{from:l=0,to:a=e.length-1,by:c=1}=n;for(let d=l;d<=a;d+=c)_(e,[d].concat(r),t);return}else if(r.length>1){_(e[n],r,[n].concat(t));return}i=e[n],t=[n].concat(t)}let o=r[0];typeof o=="function"&&(o=o(i,t),o===i)||n===void 0&&o==null||(o=g(o),n===void 0||b(i)&&b(o)&&!Array.isArray(o)?W(i,o):A(e,n,o))}function V(...[e,r]){const t=g(e||{}),n=Array.isArray(t),i=m(t);function o(...s){R(()=>{n&&s.length===1?Q(t,s[0]):_(t,s)})}return[i,o]}var z={};T(z,{decorators:()=>se,parameters:()=>oe,render:()=>ie,renderToCanvas:()=>ne});var M=new Error("request for lock canceled"),B=function(e,r,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function u(c){try{a(n.next(c))}catch(d){s(d)}}function l(c){try{a(n.throw(c))}catch(d){s(d)}}function a(c){c.done?o(c.value):i(c.value).then(u,l)}a((n=n.apply(e,r||[])).next())})},H=class{constructor(e,r=M){this._value=e,this._cancelError=r,this._queue=[],this._weightedWaiters=[]}acquire(e=1,r=0){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return new Promise((t,n)=>{let i={resolve:t,reject:n,weight:e,priority:r},o=D(this._queue,s=>r<=s.priority);o===-1&&e<=this._value?this._dispatchItem(i):this._queue.splice(o+1,0,i)})}runExclusive(e){return B(this,arguments,void 0,function*(r,t=1,n=0){let[i,o]=yield this.acquire(t,n);try{return yield r(i)}finally{o()}})}waitForUnlock(e=1,r=0){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return this._couldLockImmediately(e,r)?Promise.resolve():new Promise(t=>{this._weightedWaiters[e-1]||(this._weightedWaiters[e-1]=[]),X(this._weightedWaiters[e-1],{resolve:t,priority:r})})}isLocked(){return this._value<=0}getValue(){return this._value}setValue(e){this._value=e,this._dispatchQueue()}release(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);this._value+=e,this._dispatchQueue()}cancel(){this._queue.forEach(e=>e.reject(this._cancelError)),this._queue=[]}_dispatchQueue(){for(this._drainUnlockWaiters();this._queue.length>0&&this._queue[0].weight<=this._value;)this._dispatchItem(this._queue.shift()),this._drainUnlockWaiters()}_dispatchItem(e){let r=this._value;this._value-=e.weight,e.resolve([r,this._newReleaser(e.weight)])}_newReleaser(e){let r=!1;return()=>{r||(r=!0,this.release(e))}}_drainUnlockWaiters(){if(this._queue.length===0)for(let e=this._value;e>0;e--){let r=this._weightedWaiters[e-1];r&&(r.forEach(t=>t.resolve()),this._weightedWaiters[e-1]=[])}else{let e=this._queue[0].priority;for(let r=this._value;r>0;r--){let t=this._weightedWaiters[r-1];if(!t)continue;let n=t.findIndex(i=>i.priority<=e);(n===-1?t:t.splice(0,n)).forEach(i=>i.resolve())}}}_couldLockImmediately(e,r){return(this._queue.length===0||this._queue[0].priority<r)&&e<=this._value}};function X(e,r){let t=D(e,n=>r.priority<=n.priority);e.splice(t+1,0,r)}function D(e,r){for(let t=e.length-1;t>=0;t--)if(r(e[t]))return t;return-1}var[S,O]=V({}),Y=(e,r)=>{let t=r.canvasElement.id;return r.args=S[t].args,w(e,P(()=>r.args))},G=e=>{O({[e]:{args:{},rendered:!1,disposeFn:()=>{}}})},J=e=>{var r,t;(t=(r=S[e])==null?void 0:r.disposeFn)==null||t.call(r)},Z=e=>{J(e),G(e)},ee=e=>{var r;return!!((r=S[e])!=null&&r.rendered)},re=(e,r,t)=>{let{storyContext:n,storyFn:i,showMain:o,showException:s}=r;O(e,"rendered",!0);let u=()=>{let l=i;return C(()=>{o()}),w(L,{fallback:a=>(s(a),a),get children(){return w(l,n)}})};return I(()=>w(u,{}),t)},te=new H(1);async function ne(e,r){let{storyContext:t,forceRemount:n}=e,i=t.canvasElement.id;n&&Z(i),O(i,"args",t.args),ee(i)===!1&&await te.runExclusive(async()=>{let o=re(i,e,r);O(i,s=>({...s,disposeFn:o}))})}var ie=(e,r)=>{let{id:t,component:n}=r;if(!n)throw new Error(`Unable to render story ${t} as the component annotation is missing from the default export`);return w(n,P(()=>r.args))},oe={renderer:"solid"},se=[Y];export{se as decorators,oe as parameters,ie as render,ne as renderToCanvas};

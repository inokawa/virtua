import{m as v,c as C,l as a,o as V,n as L,p as N,a as g,q as _,r as E,F as w,D as y,v as D}from"./iframe-DztLoUJq.js";import{c as M,a as U,U as F,b as H,d as P,i as k,A as G,s as j,e as B,L as q,g as J,f as K}from"./utils-ByL9Ik-l.js";const X=t=>{let u;const{itemSize:S,horizontal:f=!1,cache:I}=t;t=v({as:"div"},t);const e=M(t.data.length,S,void 0,I,!S),d=B(e,f),c=U(e,f),[l,T]=C(e.$getStateVersion()),b=e.$subscribe(F,()=>{T(e.$getStateVersion())}),z=e.$subscribe(H,()=>{t.onScroll?.(e.$getScrollOffset())}),x=e.$subscribe(P,()=>{t.onScrollEnd?.()}),m=a(n=>{l();const r=e.$getRange(t.bufferSize);return n&&k(n,r)?n:r}),O=a(()=>l()&&e.$isScrolling()),$=a(()=>l()&&e.$getTotalSize());V(()=>{t.ref&&t.ref({get cache(){return e.$getCacheSnapshot()},get scrollOffset(){return e.$getScrollOffset()},get scrollSize(){return J(e)},get viewportSize(){return e.$getViewportSize()},findStartIndex:e.$findStartIndex,findEndIndex:e.$findEndIndex,getItemOffset:e.$getItemOffset,getItemSize:e.$getItemSize,scrollToIndex:c.$scrollToIndex,scrollTo:c.$scrollTo,scrollBy:c.$scrollBy});const n=t.scrollRef||u.parentElement;d.$observeRoot(n),c.$observe(n),D(()=>{t.ref&&t.ref(),b(),z(),x(),d.$dispose(),c.$dispose()})}),L(_(()=>t.startMargin||0,n=>{n!==e.$getStartSpacerSize()&&e.$update(K,n)})),N(_(l,()=>{c.$fixScrollJump()}));const h=a(()=>{const n=t.data.length;E(()=>{n!==e.$getItemsLength()&&e.$update(G,[n,t.shift])});const r=[],i=[];if(t.keepMounted){const o=new Set(t.keepMounted);for(let[s,R]=m();s<=R;s++)o.add(s);j([...o]).forEach(s=>{r.push(t.data[s]),i.push(s)})}else for(let[o,s]=m();o<=s;o++)r.push(t.data[o]),i.push(o);return{_items:r,_indexes:i}}),A=(n,r)=>{const i=a(()=>(l(),e.$getItemOffset(r()))),o=a(()=>(l(),e.$isUnmeasuredItem(r()))),s=a(()=>E(()=>t.children(n,r)));return g(q,{get _as(){return t.item},get _index(){return r()},get _resizer(){return d.$observeItem},get _offset(){return i()},get _hide(){return o()},get _children(){return s()},_isHorizontal:f})};return g(y,{get component(){return t.as},ref(n){var r=u;typeof r=="function"?r(n):u=n},get style(){return{contain:"size paint style","overflow-anchor":"none",overflow:"clip",flex:"none",position:"relative",width:f?$()+"px":"100%",height:f?"100%":$()+"px","pointer-events":O()?"none":void 0}},get children(){return g(w,{get each(){return h()._items},children:(n,r)=>{const i=a(()=>h()._indexes[r()]);return A(n,i)}})}})};export{X as V};
